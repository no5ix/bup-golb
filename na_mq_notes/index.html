<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


  <meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">

<script>
    (function(){
        if('mmp'){
            let localStoragePasswdKey = 'MQ notes' + '_last_passwd';
            let tryCnt = 0;
            function checkPassword(password) {
                password = password == null ? null : password.trim();
                if (password !== 'mmp') {
                    if (password != null) {
                        // å¦‚æœç”¨æˆ·ç‚¹å‡»äº†ç¡®è®¤è€Œä¸”å¯†ç é”™è¯¯çš„æ—¶å€™, å› ä¸ºå½“password == nullçš„æ—¶å€™è¯´æ˜ç”¨æˆ·ç‚¹äº†å–æ¶ˆ
                        alert('Error!');
                        if (++tryCnt < 3) {
                            password = prompt('Open Sesame');
                            checkPassword(password);
                            return;
                        }
                    }

                    // if (history.length > 1) {
                    //     alert('back!');
                    //     history.back();
                    // } else {
                        // alert('blankkkk!');
                    //     window.location.href = "about:blank";
                    // }
                    if (document.referrer) {
                        window.location.href = document.referrer;
                    } else {
                        window.location.href = "about:blank";; // fallback if no referrer
                    }

                } else {
                    localStorage.setItem(localStoragePasswdKey, password);
                }
            }

            var password_verify_on_local = false;
            const hostname = window.location.hostname;
            if (password_verify_on_local || (!(hostname === "localhost" || hostname === "127.0.0.1" || hostname === "::1" || hostname.startsWith("192")))) {
                const lspk = localStorage.getItem(localStoragePasswdKey) || "";
                if (lspk !== 'mmp') {
                    var password = prompt('Open Sesame');
                    checkPassword(password);
                }
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">





















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="noodle,Java,NA,Kafka,RabbitMQ,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2">






<meta name="description" content=". . .">
<meta name="keywords" content="noodle,Java,NA,Kafka,RabbitMQ">
<meta property="og:type" content="article">
<meta property="og:title" content="MQ notes">
<meta property="og:url" content="https://hulinhong.com/na_mq_notes/index.html">
<meta property="og:site_name" content="ğŸš™">
<meta property="og:description" content=". . .">
<meta property="og:locale" content="en">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:updated_time" content="2025-12-17T18:31:29.663Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MQ notes">
<meta name="twitter:description" content=". . .">
<meta name="twitter:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":12,"scrollpercent":true,"onmobile":true,"dimmer":true,"body_content_height":0,"display_duration":150},
    local_search: {"enable":true,"trigger":"auto","top_n_per_article":1},
    fancybox: false,
    mediumzoom: true,
    darkmode_js: false,
    tabs: true,
    motion: {"enable":true,"async":false,"duration":188,"transition":{"header":"fadeIn","menu":"fadeIn","logo":"fadeIn","post_block_else":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"fadeIn","footer":"fadeIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>








  <title>MQ notes | ğŸš™</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ğŸš™</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ğŸ’¨ ğŸ’¨ ğŸ’¨</p>
      
  </div>

  <div class="menu-item sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div class="menu-item site-search">
    
  
  <div class="site-search-div">
    <button class="search-icon" id="search-button">
      <i class="fa fa-search"></i>
    </button>
    <input type="text" id="local-search-input" class="st-search-input">
    <i id="local-search-close">Ã—</i>
  </div>


<script type="text/javascript" id="local.search.active">
    {/* var inputArea       = document.querySelector("#local-search-input");
    inputArea.onclick   = function(){ getSearchFile(); this.focus(); }
    inputArea.onkeydown = function(){ if(event.keyCode == 13) return false } */}
</script>



  </div>
  <div id="local-search-result-pc" class="local-search-result-cls"></div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      

       
    </ul>
  

  
    
  
</nav>



 </div>
    </header>

    <div id="local-search-result-mobile" class="local-search-result-cls"></div>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hulinhong.com/na_mq_notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mike">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸš™">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MQ notes</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-20T05:58:08+00:00">
                02-20-2019
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Noodle/" itemprop="url" rel="index">
                    <span itemprop="name">Noodle</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <div class="post-tags">
              
                <a href="/tags/noodle/" rel="tag"><i class="fa fa-tag"></i> noodle</a>
              
                <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
              
                <a href="/tags/NA/" rel="tag"><i class="fa fa-tag"></i> NA</a>
              
                <a href="/tags/Kafka/" rel="tag"><i class="fa fa-tag"></i> Kafka</a>
              
                <a href="/tags/RabbitMQ/" rel="tag"><i class="fa fa-tag"></i> RabbitMQ</a>
              
            </div>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    




    
    
    
    <div class="post-body" itemprop="articleBody">
      
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/na_contractor_real_q/" rel="next" title="Contractor interview real Q">
                <i class="fa fa-chevron-left"></i> 
                <p class="post-nav-pre-next-title">
                  Contractor interview real Q
                </p> 
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/na_java_backend_syllabus/" rel="prev" title="Java backend syllabus">
              <p class="post-nav-pre-next-title">
                  Java backend syllabus
              </p> 
              <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      

      
      

      
        <p><strong>. . .</strong><a id="more"></a></p>
<h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><ul>
<li><a href="https://www.bilibili.com/video/BV1h94y1Q7Xg/?vd_source=8a83b38420b65ac33aa101b7754630f6" target="_blank" rel="noopener">è§†é¢‘æ•™ç¨‹1, kafkaä¸€å°æ—¶å…¥é—¨ç²¾è®²è¯¾ç¨‹ï¼ˆé«˜æ¸…é‡åˆ¶æ— åºŸè¯ç‰ˆ</a></li>
<li><a href="https://www.bilibili.com/video/BV1Gp421m7UN/?vd_source=8a83b38420b65ac33aa101b7754630f6" target="_blank" rel="noopener">è§†é¢‘æ•™ç¨‹2, å°šç¡…è°·Kafkaæ•™ç¨‹ï¼Œ2024æ–°ç‰ˆkafkaè§†é¢‘ï¼Œé›¶åŸºç¡€å…¥é—¨åˆ°å®æˆ˜</a></li>
</ul>
<h1 id="syllabus"><a href="#syllabus" class="headerlink" title="syllabus"></a>syllabus</h1><table>
<thead>
<tr>
<th>Session</th>
<th>Topic</th>
<th>Detailed Topics</th>
</tr>
</thead>
<tbody>
<tr>
<td>20</td>
<td><code>KAFKA</code></td>
<td>1. Kafka - concepts, how it works and how message is sent to partition<br>2. Consumer Group, assignment strategy<br>3. Message in Order</td>
</tr>
<tr>
<td>21</td>
<td><code>KAFKA2</code></td>
<td>1. Kafka Duplicate Message<br>2. Kafka Message Loss<br>3. Poison Failure, DLQ<br>4. Kafka Security (SASL, ACLs, Encrypt etc)</td>
</tr>
</tbody>
</table>
<h1 id="why-MQ"><a href="#why-MQ" class="headerlink" title="why MQ"></a>why MQ</h1><p>ä¸»è¦æœ‰ä¸‰ä¸ªä½œç”¨ï¼š</p>
<ul>
<li><p><strong>è§£è€¦</strong>ã€‚å¦‚å›¾æ‰€ç¤ºã€‚å‡è®¾æœ‰ç³»ç»ŸBã€Cã€Déƒ½éœ€è¦ç³»ç»ŸAçš„æ•°æ®ï¼Œäºæ˜¯ç³»ç»ŸAè°ƒç”¨ä¸‰ä¸ªæ–¹æ³•å‘é€æ•°æ®åˆ°Bã€Cã€Dã€‚è¿™æ—¶ï¼Œç³»ç»ŸDä¸éœ€è¦äº†ï¼Œé‚£å°±éœ€è¦åœ¨ç³»ç»ŸAæŠŠç›¸å…³çš„ä»£ç åˆ æ‰ã€‚å‡è®¾è¿™æ—¶æœ‰ä¸ªæ–°çš„ç³»ç»ŸEéœ€è¦æ•°æ®ï¼Œè¿™æ—¶ç³»ç»ŸAåˆè¦å¢åŠ è°ƒç”¨ç³»ç»ŸEçš„ä»£ç ã€‚ä¸ºäº†é™ä½è¿™ç§å¼ºè€¦åˆï¼Œå°±å¯ä»¥ä½¿ç”¨MQï¼Œç³»ç»ŸAåªéœ€è¦æŠŠæ•°æ®å‘é€åˆ°MQï¼Œå…¶ä»–ç³»ç»Ÿå¦‚æœéœ€è¦æ•°æ®ï¼Œåˆ™ä»MQä¸­è·å–å³å¯ã€‚<br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image.png" alt="alt text"></p>
</li>
<li><p><strong>å¼‚æ­¥</strong>ã€‚å¦‚å›¾æ‰€ç¤ºã€‚ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚å‘é€è¿›æ¥ï¼Œç³»ç»ŸAä¼šè°ƒç”¨ç³»ç»ŸBã€Cã€Dä¸‰ä¸ªç³»ç»Ÿï¼ŒåŒæ­¥è¯·æ±‚çš„è¯ï¼Œå“åº”æ—¶é—´å°±æ˜¯ç³»ç»ŸAã€Bã€Cã€Dçš„æ€»å’Œï¼Œä¹Ÿå°±æ˜¯800msã€‚å¦‚æœä½¿ç”¨MQï¼Œç³»ç»ŸAå‘é€æ•°æ®åˆ°MQï¼Œç„¶åå°±å¯ä»¥è¿”å›å“åº”ç»™å®¢æˆ·ç«¯ï¼Œä¸éœ€è¦å†ç­‰å¾…ç³»ç»ŸBã€Cã€Dçš„å“åº”ï¼Œå¯ä»¥å¤§å¤§åœ°æé«˜æ€§èƒ½ã€‚å¯¹äºä¸€äº›éå¿…è¦çš„ä¸šåŠ¡ï¼Œæ¯”å¦‚å‘é€çŸ­ä¿¡ï¼Œå‘é€é‚®ä»¶ç­‰ç­‰ï¼Œå°±å¯ä»¥é‡‡ç”¨MQã€‚<br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-1.png" alt="alt text"></p>
</li>
<li><p><strong>å‰Šå³°</strong>ã€‚å¦‚å›¾æ‰€ç¤ºã€‚è¿™å…¶å®æ˜¯MQä¸€ä¸ªå¾ˆé‡è¦çš„åº”ç”¨ã€‚å‡è®¾ç³»ç»ŸAåœ¨æŸä¸€æ®µæ—¶é—´è¯·æ±‚æ•°æš´å¢ï¼Œæœ‰5000ä¸ªè¯·æ±‚å‘é€è¿‡æ¥ï¼Œç³»ç»ŸAè¿™æ—¶å°±ä¼šå‘é€5000æ¡SQLè¿›å…¥MySQLè¿›è¡Œæ‰§è¡Œï¼ŒMySQLå¯¹äºå¦‚æ­¤åºå¤§çš„è¯·æ±‚å½“ç„¶å¤„ç†ä¸è¿‡æ¥ï¼ŒMySQLå°±ä¼šå´©æºƒï¼Œå¯¼è‡´ç³»ç»Ÿç˜«ç—ªã€‚å¦‚æœä½¿ç”¨MQï¼Œç³»ç»ŸAä¸å†æ˜¯ç›´æ¥å‘é€SQLåˆ°æ•°æ®åº“ï¼Œè€Œæ˜¯æŠŠæ•°æ®å‘é€åˆ°MQï¼ŒMQçŸ­æ—¶é—´ç§¯å‹æ•°æ®æ˜¯å¯ä»¥æ¥å—çš„ï¼Œç„¶åç”±æ¶ˆè´¹è€…æ¯æ¬¡æ‹‰å–2000æ¡è¿›è¡Œå¤„ç†ï¼Œé˜²æ­¢åœ¨è¯·æ±‚å³°å€¼æ—¶æœŸå¤§é‡çš„è¯·æ±‚ç›´æ¥å‘é€åˆ°MySQLå¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚<br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-2.png" alt="alt text"></p>
</li>
</ul>
<h1 id="Kafka-vs-RabbitMQ"><a href="#Kafka-vs-RabbitMQ" class="headerlink" title="Kafka vs. RabbitMQ"></a>Kafka vs. RabbitMQ</h1><ul>
<li>Kafkaä¸­ï¼Œåªæœ‰<strong>pull</strong>: <ul>
<li>Consumerä½¿ç”¨pullæ¨¡å¼ä»brokerè®¢é˜…å¹¶æ¶ˆè´¹æ¶ˆæ¯ï¼Œè€Œä¸æ˜¯ç”±brokerä¸»åŠ¨æ¨é€ç»™consumerã€‚åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š<ul>
<li><strong>æ¶ˆè´¹é€Ÿç‡æ§åˆ¶</strong>ï¼špushæ¨¡å¼å¾ˆéš¾é€‚åº”æ¶ˆè´¹é€Ÿç‡ä¸åŒçš„æ¶ˆè´¹è€…ï¼Œå› ä¸ºæ¶ˆæ¯å‘é€é€Ÿç‡æ˜¯ç”±brokerå†³å®šçš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´Consumeræ¥ä¸åŠå¤„ç†æ¶ˆæ¯ï¼Œå‡ºç°æ‹’ç»æœåŠ¡ä»¥åŠç½‘ç»œæ‹¥å¡ç­‰é—®é¢˜ã€‚è€Œpullæ¨¡å¼ä¸‹ï¼ŒConsumerå¯ä»¥æ ¹æ®è‡ªèº«çš„æ¶ˆè´¹èƒ½åŠ›ä»¥é€‚å½“çš„é€Ÿç‡æ¶ˆè´¹æ¶ˆæ¯ï¼Œè‡ªä¸»æ§åˆ¶æ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿç‡ï¼Œè¿˜èƒ½é€‰æ‹©ä¸åŒçš„æäº¤æ–¹å¼ä»è€Œå®ç°ä¸åŒçš„ä¼ è¾“è¯­ä¹‰ã€‚</li>
<li><strong>ç®€åŒ–brokerè®¾è®¡</strong>ï¼špullæ¨¡å¼å¯ä»¥ç®€åŒ–brokerçš„è®¾è®¡ï¼ŒConsumerå¯è‡ªä¸»æ§åˆ¶æ¶ˆè´¹æ–¹å¼ï¼Œå¦‚å¯æ‰¹é‡æ¶ˆè´¹ä¹Ÿå¯é€æ¡æ¶ˆè´¹ã€‚</li>
</ul>
</li>
</ul>
</li>
<li>RabbitMQæ—¢æ”¯æŒbrokerä¸»åŠ¨æ¨é€æ¶ˆæ¯ç»™consumerçš„æ¨æ¨¡å¼ï¼ˆ<strong>push</strong>ï¼‰ï¼Œä¹Ÿæ”¯æŒconsumerä¸»åŠ¨ä»brokeræ‹‰å–æ¶ˆæ¯çš„æ‹‰æ¨¡å¼ï¼ˆ<strong>pull</strong>ï¼‰ï¼š<ul>
<li><strong>æ¨æ¨¡å¼</strong>(é»˜è®¤)ï¼šæ¶ˆè´¹è€…è°ƒç”¨<code>channel.basicConsume</code>æ–¹æ³•è®¢é˜…é˜Ÿåˆ—åï¼Œç”±RabbitMQä¸»åŠ¨å°†æ¶ˆæ¯æ¨é€ç»™è®¢é˜…é˜Ÿåˆ—çš„æ¶ˆè´¹è€…ã€‚æ¨æ¨¡å¼æ˜¯ä¸€ç§é«˜æ•ˆçš„æ¶ˆæ¯å¤„ç†æ–¹å¼ï¼Œå…·æœ‰è¾ƒå¥½çš„å®æ—¶æ€§ï¼Œæ¶ˆæ¯åˆ°è¾¾RabbitMQåä¼šç«‹å³è¢«æŠ•é€’ç»™åŒ¹é…çš„æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…èƒ½åŠæ—¶å¾—åˆ°æœ€æ–°çš„æ¶ˆæ¯ã€‚ä¸è¿‡ï¼Œè¯¥æ¨¡å¼ä¸‹æ¶ˆè´¹è€…å¿…é¡»è®¾ç½®ä¸€ä¸ªç¼“å†²åŒºæ¥ç¼“å­˜æ¶ˆæ¯ï¼Œå¦åˆ™ç¼“å†²åŒºå¯èƒ½ä¼šæº¢å‡ºã€‚</li>
<li><strong>æ‹‰æ¨¡å¼</strong>(æå°‘ä½¿ç”¨)ï¼šæ¶ˆè´¹è€…è°ƒç”¨<code>channel.basicGet</code>æ–¹æ³•ä¸»åŠ¨ä»æŒ‡å®šé˜Ÿåˆ—ä¸­æ‹‰å–æ¶ˆæ¯ã€‚è¿™ç§æ¨¡å¼åœ¨æ¶ˆè´¹è€…éœ€è¦æ—¶æ‰å»æ‹‰å–æ¶ˆæ¯ï¼Œä¼šå¢åŠ æ¶ˆæ¯å»¶è¿Ÿï¼Œé™ä½ç³»ç»Ÿååé‡ï¼Œå®æ—¶æ€§ä¹Ÿè¾ƒå·®ï¼Œæ¶ˆè´¹è€…è·å–æ–°æ¶ˆæ¯çš„æ—¶é—´å–å†³äºå…¶æ‹‰å–æ¶ˆæ¯çš„æ—¶é—´ã€‚</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>Aspect</th>
<th><strong>Apache Kafka</strong></th>
<th><strong>RabbitMQ</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Type</strong></td>
<td>Distributed <strong>log-based streaming platform</strong></td>
<td>Traditional <strong>message broker</strong> (queue-based)</td>
</tr>
<tr>
<td><strong>Architecture</strong></td>
<td>Pull-based, partitioned log with persistent storage</td>
<td>Push-based, uses queues and exchanges</td>
</tr>
<tr>
<td><strong>Message Model</strong></td>
<td>Publish-subscribe (log replay possible)</td>
<td>Queues with consumer ACKs (point-to-point or pub-sub)</td>
</tr>
<tr>
<td><strong>Throughput</strong></td>
<td>Extremely high (millions/sec), horizontally scalable</td>
<td>Moderate to high, lower than Kafka in most cases</td>
</tr>
<tr>
<td><strong>Latency</strong></td>
<td>Slightly higher, designed for throughput and durability</td>
<td>Lower latency, good for near-real-time delivery</td>
</tr>
<tr>
<td><strong>Durability</strong></td>
<td>Designed for <strong>long-term storage</strong> (e.g., days/months)</td>
<td>Messages typically removed once consumed</td>
</tr>
<tr>
<td><strong>Ordering</strong></td>
<td>Guaranteed within a <strong>partition</strong></td>
<td>Ordering not guaranteed without careful config</td>
</tr>
<tr>
<td><strong>Persistence</strong></td>
<td>Highly durable, append-only log</td>
<td>Persistent queues, but not optimized for large history</td>
</tr>
<tr>
<td><strong>Protocol Support</strong></td>
<td>Kafka (native TCP), Kafka Connect, REST Proxy</td>
<td>AMQP 0.9.1 (default), MQTT, STOMP, HTTP, etc.</td>
</tr>
<tr>
<td><strong>Consumer Model</strong></td>
<td>Consumer groups (each group reads independently)</td>
<td>Messages removed once delivered to a consumer</td>
</tr>
<tr>
<td><strong>Use Cases</strong></td>
<td>Event sourcing, real-time analytics, stream processing</td>
<td>Task queues, background jobs, short-lived events</td>
</tr>
<tr>
<td><strong>Operational Cost</strong></td>
<td>More complex (e.g., Zookeeper, tuning partitions)</td>
<td>Easier to set up and manage for simple use cases</td>
</tr>
</tbody>
</table>
<p>When to Use Kafka:</p>
<ul>
<li>High-throughput event pipelines</li>
<li>Real-time analytics</li>
<li>Event sourcing / CDC (Change Data Capture)</li>
<li>Log aggregation across distributed systems</li>
</ul>
<p>When to Use RabbitMQ:</p>
<ul>
<li>Lower latency</li>
<li>Task queues (e.g., background job processing)</li>
<li>Complex routing with low volume (e.g., topic or header exchanges)</li>
<li>When AMQP protocol is a requirement</li>
</ul>
<p>Verdict:</p>
<ul>
<li>Use <strong>Kafka</strong> for <strong>scalable, durable, high-throughput streaming</strong>.</li>
<li>Use <strong>RabbitMQ</strong> for <strong>lower latency, reliable messaging with rich routing logic and simpler delivery guarantees</strong>.</li>
</ul>
<hr>
<h1 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h1><p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-13.png" alt="alt text"><br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-14.png" alt="alt text"></p>
<p>å‚è€ƒ: <a href="https://www.hellointerview.com/learn/system-design/deep-dives/kafka" target="_blank" rel="noopener">https://www.hellointerview.com/learn/system-design/deep-dives/kafka</a></p>
<p>Kafka çš„æ¶ˆè´¹æ¨¡å‹è¦åˆ†æ¸…æ¥šä¸¤ä¸ªå±‚é¢ï¼š</p>
<p>ğŸ”‘ Topic â†’ Consumer Group</p>
<ul>
<li>ä¸€ä¸ª <strong>topic</strong> å¯ä»¥è¢« <strong>å¤šä¸ª consumer group</strong> åŒæ—¶æ¶ˆè´¹ã€‚</li>
<li>æ¯ä¸ª consumer group ç›¸å½“äºä¸€ä¸ªâ€œè®¢é˜…â€ï¼Œå½¼æ­¤äº’ä¸å½±å“ã€‚<ul>
<li>ä¸¾ä¾‹ï¼š<ul>
<li>è®¢å•æœåŠ¡å†™å…¥ <code>order_events</code> topicã€‚</li>
<li>é£æ§ç³»ç»Ÿçš„ groupA æ¶ˆè´¹å®ƒï¼Œåšé£æ§ã€‚</li>
<li>æ•°æ®ä»“åº“çš„ groupB ä¹Ÿæ¶ˆè´¹å®ƒï¼Œåšåˆ†æã€‚</li>
<li>ä¸¤è¾¹éƒ½èƒ½æ‹¿åˆ° <strong>å®Œæ•´æ•°æ®</strong>ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ğŸ”‘ Consumer Group å†…éƒ¨åˆ†å·¥</p>
<ul>
<li>ä¸€ä¸ª consumer group å†…å¯ä»¥æœ‰å¤šä¸ª consumer å®ä¾‹ã€‚</li>
<li>Kafka ä¼šæŠŠ topic çš„ <strong>partition</strong> åˆ†é…ç»™è¿™äº› consumerã€‚</li>
<li>ä½† <strong>åŒä¸€ä¸ª partition å†…çš„æ•°æ®åªä¼šåˆ†é…ç»™ group å†…çš„ä¸€ä¸ª consumer</strong>ï¼ˆä¿è¯é¡ºåºæ€§ï¼‰ã€‚</li>
<li>é‡æ–°å¹³è¡¡ ï¼šå½“ä½œä¸ºæ¶ˆè´¹è€…ç»„çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œå¦‚æœä¸€ä¸ªæ¶ˆè´¹è€…å‡ºç°æ•…éšœï¼ŒKafka å°†åœ¨å‰©ä½™çš„æ¶ˆè´¹è€…ä¹‹é—´é‡æ–°åˆ†é…åˆ†åŒºï¼Œä»¥ä¾¿æ‰€æœ‰åˆ†åŒºä»åœ¨å¤„ç†ä¸­ã€‚</li>
</ul>
<hr>
<p>ğŸ”‘ æ€»ç»“ï¼š</p>
<ul>
<li>ä¸€ä¸ª <strong>topic å¯ä»¥è¢«å¤šä¸ª consumer group æ¶ˆè´¹</strong>ï¼ˆå¹¿æ’­æ¨¡å¼ï¼‰ã€‚</li>
<li>åœ¨ <strong>åŒä¸€ä¸ª consumer group å†…</strong>ï¼Œä¸€ä¸ª partition <strong>åªä¼šè¢«ä¸€ä¸ª consumer æ¶ˆè´¹</strong>ï¼ˆåˆ†åŒºçº§åˆ«çš„å¹¶è¡Œ + é¡ºåºä¿è¯ï¼‰ã€‚</li>
</ul>
<hr>
<h2 id="ä¸€ä¸ªtopicæœ‰å¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionåˆæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œleaderå‰¯æœ¬å’Œfollowerå‰¯æœ¬å—"><a href="#ä¸€ä¸ªtopicæœ‰å¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionåˆæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œleaderå‰¯æœ¬å’Œfollowerå‰¯æœ¬å—" class="headerlink" title="ä¸€ä¸ªtopicæœ‰å¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionåˆæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œleaderå‰¯æœ¬å’Œfollowerå‰¯æœ¬å—?"></a>ä¸€ä¸ªtopicæœ‰å¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionåˆæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œleaderå‰¯æœ¬å’Œfollowerå‰¯æœ¬å—?</h2><p>æ˜¯çš„ï¼Œåœ¨ Kafka è¿™æ ·çš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿé‡Œï¼Œä¸€ä¸ªä¸»é¢˜ï¼ˆTopicï¼‰å¯åŒ…å«å¤šä¸ªåˆ†åŒºï¼ˆPartitionï¼‰ï¼Œè€Œæ¯ä¸ªåˆ†åŒºåˆèƒ½æœ‰å¤šä¸ªå‰¯æœ¬ï¼ˆReplicaï¼‰ï¼Œå…¶ä¸­å°±åˆ†ä¸ºé¢†å¯¼è€…å‰¯æœ¬ï¼ˆLeader Replicaï¼‰å’Œè¿½éšè€…å‰¯æœ¬ï¼ˆFollower Replicaï¼‰ï¼Œä¸‹é¢è¯¦ç»†ä»‹ç»ï¼š</p>
<h3 id="ä¸»é¢˜ï¼ˆTopicï¼‰"><a href="#ä¸»é¢˜ï¼ˆTopicï¼‰" class="headerlink" title="ä¸»é¢˜ï¼ˆTopicï¼‰"></a>ä¸»é¢˜ï¼ˆTopicï¼‰</h3><p>ä¸»é¢˜æ˜¯ Kafka ä¸­æ•°æ®ç»„ç»‡çš„é€»è¾‘æ¦‚å¿µï¼Œå®ƒå¯è¢«çœ‹ä½œæ˜¯æ¶ˆæ¯çš„ç±»åˆ«æˆ–è€…æ•°æ®æµçš„åç§°ã€‚ç”Ÿäº§è€…æŠŠæ¶ˆæ¯å‘é€åˆ°ä¸»é¢˜ï¼Œæ¶ˆè´¹è€…åˆ™ä»ä¸»é¢˜æ¥æ”¶æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç”µå•†ç³»ç»Ÿé‡Œï¼Œå¯èƒ½ä¼šæœ‰â€œorder_topicâ€â€œpayment_topicâ€ç­‰ä¸åŒä¸»é¢˜ï¼Œåˆ†åˆ«ç”¨äºå¤„ç†è®¢å•å’Œæ”¯ä»˜ç›¸å…³çš„æ¶ˆæ¯ã€‚</p>
<h3 id="åˆ†åŒºï¼ˆPartitionï¼‰"><a href="#åˆ†åŒºï¼ˆPartitionï¼‰" class="headerlink" title="åˆ†åŒºï¼ˆPartitionï¼‰"></a>åˆ†åŒºï¼ˆPartitionï¼‰</h3><ul>
<li><strong>å®šä¹‰</strong>ï¼šä¸»é¢˜ä¼šè¢«åˆ’åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªåˆ†åŒºï¼Œåˆ†åŒºæ˜¯ç‰©ç†å­˜å‚¨çš„åŸºæœ¬å•å…ƒã€‚æ¯ä¸ªåˆ†åŒºåœ¨ç‰©ç†ä¸Šå¯¹åº”ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œæ¶ˆæ¯ä¼šæŒ‰é¡ºåºè¿½åŠ åˆ°è¿™ä¸ªæ—¥å¿—æ–‡ä»¶ä¸­ã€‚</li>
<li><strong>ä½œç”¨</strong>ï¼šåˆ†åŒºèƒ½æå‡ Kafka çš„å¹¶å‘å¤„ç†èƒ½åŠ›ã€‚ä¸åŒçš„åˆ†åŒºå¯åˆ†å¸ƒåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…èƒ½å¤Ÿå¹¶è¡Œåœ°å¯¹ä¸åŒåˆ†åŒºè¿›è¡Œè¯»å†™æ“ä½œï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„ååé‡ã€‚</li>
</ul>
<h3 id="å‰¯æœ¬ï¼ˆReplicaï¼‰"><a href="#å‰¯æœ¬ï¼ˆReplicaï¼‰" class="headerlink" title="å‰¯æœ¬ï¼ˆReplicaï¼‰"></a>å‰¯æœ¬ï¼ˆReplicaï¼‰</h3><ul>
<li><strong>å®šä¹‰</strong>ï¼šä¸ºç¡®ä¿æ•°æ®çš„å¯é æ€§å’Œé«˜å¯ç”¨æ€§ï¼Œæ¯ä¸ªåˆ†åŒºå¯ä»¥æœ‰å¤šä¸ªå‰¯æœ¬ã€‚è¿™äº›å‰¯æœ¬ä¼šè¢«åˆ†å¸ƒåˆ°ä¸åŒçš„ Broker èŠ‚ç‚¹ä¸Šã€‚</li>
<li><strong>ç±»å‹</strong><ul>
<li><strong>é¢†å¯¼è€…å‰¯æœ¬ï¼ˆLeader Replicaï¼‰</strong>ï¼šæ¯ä¸ªåˆ†åŒºéƒ½ä¼šæœ‰ä¸€ä¸ªé¢†å¯¼è€…å‰¯æœ¬ï¼Œæ‰€æœ‰çš„è¯»å†™æ“ä½œéƒ½ç›´æ¥ä¸é¢†å¯¼è€…å‰¯æœ¬è¿›è¡Œäº¤äº’ã€‚ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œæ¶ˆæ¯ä¼šè¢«å†™å…¥é¢†å¯¼è€…å‰¯æœ¬ï¼›æ¶ˆè´¹è€…è¯»å–æ¶ˆæ¯æ—¶ï¼Œä¹Ÿæ˜¯ä»é¢†å¯¼è€…å‰¯æœ¬è¯»å–ã€‚é¢†å¯¼è€…å‰¯æœ¬è´Ÿè´£ç»´æŠ¤åˆ†åŒºå†…æ¶ˆæ¯çš„é¡ºåºå’Œä¸€è‡´æ€§ã€‚</li>
<li><strong>è¿½éšè€…å‰¯æœ¬ï¼ˆFollower Replicaï¼‰</strong>ï¼šè¿½éšè€…å‰¯æœ¬ä¼šä»é¢†å¯¼è€…å‰¯æœ¬å¼‚æ­¥åœ°å¤åˆ¶æ¶ˆæ¯ï¼Œä»¥ä¿æŒä¸é¢†å¯¼è€…å‰¯æœ¬çš„æ•°æ®ä¸€è‡´ã€‚å½“é¢†å¯¼è€…å‰¯æœ¬æ‰€åœ¨çš„ Broker èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶ï¼ŒKafka ä¼šä»è¿½éšè€…å‰¯æœ¬ä¸­é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„é¢†å¯¼è€…å‰¯æœ¬ï¼Œä»è€Œä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ã€‚</li>
</ul>
</li>
</ul>
<h3 id="ç¤ºä¾‹è¯´æ˜"><a href="#ç¤ºä¾‹è¯´æ˜" class="headerlink" title="ç¤ºä¾‹è¯´æ˜"></a>ç¤ºä¾‹è¯´æ˜</h3><p>å‡è®¾å­˜åœ¨ä¸€ä¸ªåä¸ºâ€œuser_activity_topicâ€çš„ä¸»é¢˜ï¼Œå®ƒæœ‰ 3 ä¸ªåˆ†åŒºï¼ˆPartition 0ã€Partition 1ã€Partition 2ï¼‰ï¼Œæ¯ä¸ªåˆ†åŒºæœ‰ 2 ä¸ªå‰¯æœ¬ã€‚é‚£ä¹ˆæ•´ä½“æ¶æ„å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>åˆ†åŒº</th>
<th>é¢†å¯¼è€…å‰¯æœ¬æ‰€åœ¨ Broker</th>
<th>è¿½éšè€…å‰¯æœ¬æ‰€åœ¨ Broker</th>
</tr>
</thead>
<tbody>
<tr>
<td>Partition 0</td>
<td>Broker 1</td>
<td>Broker 2</td>
</tr>
<tr>
<td>Partition 1</td>
<td>Broker 2</td>
<td>Broker 3</td>
</tr>
<tr>
<td>Partition 2</td>
<td>Broker 3</td>
<td>Broker 1</td>
</tr>
</tbody>
</table>
<p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œç”Ÿäº§è€…å‘â€œuser_activity_topicâ€å‘é€æ¶ˆæ¯æ—¶ï¼Œæ¶ˆæ¯ä¼šæ ¹æ®åˆ†åŒºç­–ç•¥è¢«åˆ†é…åˆ°ä¸åŒçš„åˆ†åŒºï¼Œå¹¶ä¸”åªä¼šå†™å…¥è¯¥åˆ†åŒºçš„é¢†å¯¼è€…å‰¯æœ¬ã€‚è¿½éšè€…å‰¯æœ¬ä¼šä¸æ–­åœ°ä»é¢†å¯¼è€…å‰¯æœ¬å¤åˆ¶æ¶ˆæ¯ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚å½“æŸä¸ª Broker èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶ï¼ŒKafka ä¼šè‡ªåŠ¨è¿›è¡Œé¢†å¯¼è€…é€‰ä¸¾ï¼Œç¡®ä¿ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚ </p>
<h2 id="KafkaåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºæ˜¯å…±äº«åŒä¸€ä¸ªoffsetçš„æ˜¯å§"><a href="#KafkaåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºæ˜¯å…±äº«åŒä¸€ä¸ªoffsetçš„æ˜¯å§" class="headerlink" title="KafkaåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºæ˜¯å…±äº«åŒä¸€ä¸ªoffsetçš„æ˜¯å§"></a>KafkaåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºæ˜¯å…±äº«åŒä¸€ä¸ªoffsetçš„æ˜¯å§</h2><p>æ˜¯çš„ï¼Œåœ¨ Kafka é‡Œï¼ŒåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºå…±äº«åŒä¸€ä¸ª offsetã€‚ä¸‹é¢ä»åŸç†ã€ç›®çš„å’Œå½±å“ç­‰æ–¹é¢è¯¦ç»†è§£é‡Šï¼š</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><ul>
<li><strong>åˆ†åŒºåˆ†é…æœºåˆ¶</strong>ï¼šKafka ä¸ºäº†ä¿è¯æ¶ˆæ¯åœ¨åˆ†åŒºå†…çš„é¡ºåºæ¶ˆè´¹å’Œé¿å…é‡å¤æ¶ˆè´¹ï¼Œé‡‡ç”¨äº†ä¸€ä¸ªåˆ†åŒºåªèƒ½è¢«ä¸€ä¸ªæ¶ˆè´¹ç»„å†…çš„ä¸€ä¸ªæ¶ˆè´¹è€…æ¶ˆè´¹çš„ç­–ç•¥ã€‚è¿™æ„å‘³ç€åœ¨åŒä¸€ä¸ªæ¶ˆè´¹ç»„ä¸­ï¼Œé’ˆå¯¹ç‰¹å®šçš„ä¸€ä¸ªåˆ†åŒºï¼Œåªä¼šæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…è´Ÿè´£å¤„ç†è¯¥åˆ†åŒºçš„æ¶ˆæ¯ã€‚æ—¢ç„¶åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†è¿™ä¸ªåˆ†åŒºï¼Œé‚£ä¹ˆè¯¥åˆ†åŒºå¯¹åº”çš„æ¶ˆè´¹åç§»é‡ï¼ˆoffsetï¼‰åœ¨è¿™ä¸ªæ¶ˆè´¹ç»„å†…å°±æ˜¯å”¯ä¸€çš„ï¼Œä¹Ÿå°±æ˜¯å…±äº«åŒä¸€ä¸ª offsetã€‚</li>
<li><strong>offset æäº¤</strong>ï¼šæ¶ˆè´¹è€…åœ¨æ¶ˆè´¹å®Œæ¶ˆæ¯åï¼Œéœ€è¦å‘ Kafka æäº¤ offsetï¼Œä»¥æ­¤å‘ŠçŸ¥ Kafka è¯¥æ¶ˆè´¹ç»„å·²ç»æ¶ˆè´¹åˆ°äº†åˆ†åŒºçš„å“ªä¸ªä½ç½®ã€‚åœ¨ä¸€ä¸ªæ¶ˆè´¹ç»„é‡Œï¼Œæ— è®ºå“ªä¸ªæ¶ˆè´¹è€…å®é™…æ¶ˆè´¹äº†åˆ†åŒºçš„æ¶ˆæ¯ï¼Œæœ€ç»ˆæäº¤çš„éƒ½æ˜¯è¯¥åˆ†åŒºç»Ÿä¸€çš„ offsetã€‚ä¾‹å¦‚ï¼Œæ¶ˆè´¹è€… A æ¶ˆè´¹äº†åˆ†åŒº P0 çš„éƒ¨åˆ†æ¶ˆæ¯åæäº¤ offsetï¼Œè¿™ä¸ª offset å°±ä»£è¡¨äº†æ•´ä¸ªæ¶ˆè´¹ç»„åœ¨åˆ†åŒº P0 çš„æ¶ˆè´¹è¿›åº¦ã€‚</li>
</ul>
<h3 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h3><ul>
<li><strong>ä¿è¯æ¶ˆæ¯é¡ºåºæ€§</strong>ï¼šç¡®ä¿åŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹åˆ†åŒºå†…çš„æ¶ˆæ¯æŒ‰é¡ºåºå¤„ç†ã€‚å¦‚æœæ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„ offsetï¼Œå°±å¯èƒ½å‡ºç°å¤šä¸ªæ¶ˆè´¹è€…ä¹±åºæ¶ˆè´¹åˆ†åŒºæ¶ˆæ¯çš„æƒ…å†µï¼Œç ´åäº†æ¶ˆæ¯åœ¨åˆ†åŒºå†…çš„é¡ºåºæ€§ã€‚</li>
<li><strong>é¿å…é‡å¤æ¶ˆè´¹</strong>ï¼šç»Ÿä¸€çš„ offset èƒ½è®©æ¶ˆè´¹ç»„æ¸…æ¥šçŸ¥é“å“ªäº›æ¶ˆæ¯å·²ç»è¢«æ¶ˆè´¹è¿‡ã€‚å½“æ¶ˆè´¹è€…å‡ºç°æ•…éšœé‡å¯æˆ–è€…è¿›è¡Œåˆ†åŒºé‡å¹³è¡¡åï¼Œèƒ½ä»æ­£ç¡®çš„ offset ä½ç½®ç»§ç»­æ¶ˆè´¹ï¼Œé¿å…é‡å¤å¤„ç†å·²ç»æ¶ˆè´¹è¿‡çš„æ¶ˆæ¯ã€‚</li>
</ul>
<h3 id="å½±å“"><a href="#å½±å“" class="headerlink" title="å½±å“"></a>å½±å“</h3><ul>
<li><strong>æ•…éšœæ¢å¤</strong>ï¼šè‹¥æ¶ˆè´¹ç»„å†…è´Ÿè´£æŸåˆ†åŒºçš„æ¶ˆè´¹è€…å‡ºç°æ•…éšœï¼ŒKafka ä¼šå°†è¯¥åˆ†åŒºåˆ†é…ç»™å…¶ä»–æ¶ˆè´¹è€…ï¼Œæ–°çš„æ¶ˆè´¹è€…ä¼šä»å…±äº«çš„ offset ä½ç½®ç»§ç»­æ¶ˆè´¹ï¼Œä¿è¯æ¶ˆè´¹çš„è¿ç»­æ€§ã€‚</li>
<li><strong>åˆ†åŒºé‡å¹³è¡¡</strong>ï¼šå½“æ¶ˆè´¹ç»„å‘ç”Ÿåˆ†åŒºé‡å¹³è¡¡æ—¶ï¼Œæ‰€æœ‰æ¶ˆè´¹è€…ä¼šé‡æ–°åˆ†é…åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºå¯¹åº”çš„å…±äº« offset èƒ½å¸®åŠ©æ–°æ¥æ‰‹çš„æ¶ˆè´¹è€…å‡†ç¡®æ‰¾åˆ°æ¶ˆè´¹èµ·ç‚¹ã€‚ </li>
</ul>
<h2 id="in-kafka-how-to-handle-schema-evolution"><a href="#in-kafka-how-to-handle-schema-evolution" class="headerlink" title="in kafka, how to handle schema evolution"></a>in kafka, how to handle schema evolution</h2><h3 id="ä»€ä¹ˆæ˜¯schema"><a href="#ä»€ä¹ˆæ˜¯schema" class="headerlink" title="ä»€ä¹ˆæ˜¯schema"></a>ä»€ä¹ˆæ˜¯schema</h3><p>Schema æ¼”è¿›ï¼ˆSchema Evolutionï¼‰ æ˜¯æŒ‡åœ¨ä¸ç ´åå·²æœ‰æ•°æ®å’Œæ¶ˆè´¹è€…çš„å‰æä¸‹ï¼Œå¯¹æ•°æ®ç»“æ„è¿›è¡Œä¿®æ”¹å’Œå‡çº§çš„è¿‡ç¨‹ã€‚</p>
<p>ä¸ºä»€ä¹ˆéœ€è¦ Schema æ¼”è¿›ï¼Ÿ</p>
<p>Kafka ä¸­çš„æ•°æ®é€šå¸¸ä½¿ç”¨ Avroã€Protobuf æˆ– JSON è¿›è¡Œåºåˆ—åŒ–ã€‚éšç€ä¸šåŠ¡å‘å±•ï¼Œæ•°æ®ç»“æ„ä¸å¯é¿å…åœ°è¦è°ƒæ•´ï¼Œæ¯”å¦‚ï¼š</p>
<ul>
<li>â€¢    æ·»åŠ æ–°å­—æ®µ</li>
<li>â€¢    åˆ é™¤æ—§å­—æ®µ</li>
<li>â€¢    ä¿®æ”¹å­—æ®µç±»å‹æˆ–é»˜è®¤å€¼</li>
</ul>
<p>Schema æ¼”è¿›çš„ç›®æ ‡ï¼šè®©æ–°è€ç‰ˆæœ¬çš„ producer å’Œ consumer èƒ½å¤Ÿå…¼å®¹åœ°ç”Ÿäº§å’Œæ¶ˆè´¹æ•°æ®ï¼Œé¿å…å› ç»“æ„å˜æ›´å¯¼è‡´ç³»ç»Ÿå´©æºƒæˆ–æ•°æ®å‡ºé”™ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>åˆå§‹ schemaï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;record&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;User&quot;,</span><br><span class="line">  &quot;fields&quot;: [</span><br><span class="line">    &#123; &quot;name&quot;: &quot;username&quot;, &quot;type&quot;: &quot;string&quot; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>åç»­æ¼”è¿›ç‰ˆæœ¬ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;record&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;User&quot;,</span><br><span class="line">  &quot;fields&quot;: [</span><br><span class="line">    &#123; &quot;name&quot;: &quot;username&quot;, &quot;type&quot;: &quot;string&quot; &#125;,</span><br><span class="line">    &#123; &quot;name&quot;: &quot;email&quot;, &quot;type&quot;: &quot;string&quot;, &quot;default&quot;: &quot;&quot; &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœè®¾ç½®äº† å‘åå…¼å®¹ï¼ˆbackward compatibilityï¼‰ï¼Œæ—§æ¶ˆè´¹è€…ä»ç„¶å¯ä»¥è¯»å–æ–°æ•°æ®ï¼Œå› ä¸ºæ–°å­—æ®µæœ‰é»˜è®¤å€¼ã€‚</p>
<p>æ€»ç»“ï¼š</p>
<p>Schema æ¼”è¿›å°±æ˜¯åœ¨ç‰ˆæœ¬å‡çº§æ—¶ï¼Œä¿è¯æ•°æ®ç»“æ„å˜æ›´çš„åŒæ—¶ä¸å½±å“å·²æœ‰ç³»ç»Ÿè¿è¡Œã€‚å®ƒä¾èµ–äºæ˜ç¡®çš„å…¼å®¹æ€§ç­–ç•¥ï¼Œå¸¸ä¸ Schema Registry ä¸€èµ·ä½¿ç”¨ï¼Œæ˜¯æ„å»ºç¨³å®šã€å¯ç»´æŠ¤æ•°æ®å¹³å°çš„å…³é”®æ‰‹æ®µã€‚</p>
<h3 id="å¦‚ä½•å¤„ç†"><a href="#å¦‚ä½•å¤„ç†" class="headerlink" title="å¦‚ä½•å¤„ç†"></a>å¦‚ä½•å¤„ç†</h3><p>åœ¨ Kafka ä¸­å¤„ç† Schema æ¼”è¿›ï¼ˆSchema Evolutionï¼‰ï¼Œé€šå¸¸é‡‡ç”¨ Avro + Schema Registry çš„æ–¹å¼ã€‚å…³é”®åœ¨äºä½¿ç”¨ Confluent çš„ Schema Registry æ¥ç®¡ç† schema ç‰ˆæœ¬ï¼Œå¹¶ç¡®ä¿ producer å’Œ consumer å¯¹ schema æ¼”è¿›çš„å…¼å®¹æ€§ã€‚</p>
<p>å¤„ç†æ–¹å¼å¦‚ä¸‹ï¼š</p>
<ol>
<li>ä½¿ç”¨ Schema Registry<ul>
<li>â€¢    Producer å°† schema æ³¨å†Œåˆ° Schema Registryã€‚</li>
<li>â€¢    æ¶ˆè´¹è€…ä» Schema Registry è·å–ç›¸åº” schema è¿›è¡Œååºåˆ—åŒ–ã€‚</li>
</ul>
</li>
<li>è®¾ç½®å…¼å®¹æ€§ç­–ç•¥ï¼ˆCompatibility Modesï¼‰, Schema Registry æ”¯æŒå‡ ç§å…¼å®¹ç­–ç•¥ï¼š<ul>
<li>â€¢    BACKWARDï¼šæ–° schema èƒ½è¯»å–æ—§æ•°æ®ã€‚</li>
<li>â€¢    FORWARDï¼šæ—§ schema èƒ½è¯»å–æ–°æ•°æ®ã€‚</li>
<li>â€¢    FULLï¼šåŒå‘å…¼å®¹ã€‚</li>
<li>â€¢    NONEï¼šä¸æ£€æŸ¥å…¼å®¹æ€§ã€‚</li>
</ul>
</li>
</ol>
<p>æ¨èä½¿ç”¨ BACKWARD æˆ– FULL ä»¥ä¿è¯æ¶ˆè´¹ç«¯å¹³ç¨³å‡çº§ã€‚</p>
<p>éµå¾ª Avro çš„æ¼”è¿›è§„åˆ™</p>
<p>æ”¯æŒçš„å…¼å®¹æ€§å˜æ›´åŒ…æ‹¬ï¼š</p>
<ul>
<li>â€¢    æ·»åŠ å­—æ®µï¼ˆå¸¦é»˜è®¤å€¼ï¼‰</li>
<li>â€¢    åˆ é™¤å­—æ®µï¼ˆä¸å†ä½¿ç”¨ï¼‰</li>
<li>â€¢    å­—æ®µç±»å‹å…¼å®¹å˜æ›´ï¼ˆå¦‚ int â†’ longï¼‰</li>
</ul>
<p>ä¸æ”¯æŒçš„å˜æ›´åŒ…æ‹¬ï¼š</p>
<ul>
<li>â€¢    åˆ é™¤æ— é»˜è®¤å€¼å­—æ®µ</li>
<li>â€¢    å­—æ®µç±»å‹ä¸å…¼å®¹æ›´æ”¹ï¼ˆå¦‚ string â†’ intï¼‰</li>
</ul>
<p>å®é™…ç¤ºä¾‹ï¼šæ·»åŠ å­—æ®µ</p>
<p>æ—§ Schemaï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;record&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;User&quot;,</span><br><span class="line">  &quot;fields&quot;: [</span><br><span class="line">    &#123;&quot;name&quot;: &quot;name&quot;, &quot;type&quot;: &quot;string&quot;&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>æ–° Schemaï¼ˆæ·»åŠ å­—æ®µï¼‰ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;type&quot;: &quot;record&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;User&quot;,</span><br><span class="line">  &quot;fields&quot;: [</span><br><span class="line">    &#123;&quot;name&quot;: &quot;name&quot;, &quot;type&quot;: &quot;string&quot;&#125;,</span><br><span class="line">    &#123;&quot;name&quot;: &quot;age&quot;, &quot;type&quot;: &quot;int&quot;, &quot;default&quot;: 0&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å»ºè®®ï¼š</p>
<ul>
<li>â€¢    åœ¨ CI/CD ä¸­åŠ ä¸Š schema æ¼”è¿›æ£€æµ‹ã€‚</li>
<li>â€¢    æ§åˆ¶ schema å‘å¸ƒæµç¨‹ï¼Œé¿å…éå…¼å®¹å˜æ›´ã€‚</li>
<li>â€¢    æ‰€æœ‰æœåŠ¡ç»Ÿä¸€ä½¿ç”¨ Schema Registry ä¸­çš„ schemaï¼Œä¸æ‰‹åŠ¨å†™ schemaã€‚</li>
</ul>
<p>å¦‚éœ€é«˜å¯é æ€§ç³»ç»Ÿï¼Œschema è®¾è®¡æ—¶åŠ¡å¿…è€ƒè™‘æœªæ¥æ‰©å±•æ€§å’Œæ¼”è¿›ç­–ç•¥ã€‚</p>
<h3 id="avroæ˜¯å•¥å’Œprotobufå¯¹æ¯”"><a href="#avroæ˜¯å•¥å’Œprotobufå¯¹æ¯”" class="headerlink" title="avroæ˜¯å•¥å’Œprotobufå¯¹æ¯”"></a>avroæ˜¯å•¥å’Œprotobufå¯¹æ¯”</h3><p>Avro æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>Avro æ˜¯ Apache å‡ºå“çš„ä¸€ç§æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œå¸¸ç”¨äºå¤§æ•°æ®å’Œ Kafka åœºæ™¯ä¸­ã€‚å®ƒå®šä¹‰æ•°æ®çš„ ç»“æ„ï¼ˆSchemaï¼‰ï¼Œå¹¶å°†ç»“æ„å’Œæ•°æ®ä¸€èµ·åºåˆ—åŒ–ï¼Œä¾¿äºä¸åŒç³»ç»Ÿä¹‹é—´é€šä¿¡ã€‚</p>
<p>Avro çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>â€¢    ç´§å‡‘é«˜æ•ˆï¼šä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç ï¼Œå ç”¨ç©ºé—´å°ã€‚</li>
<li>â€¢    æ”¯æŒ schema æ¼”è¿›ï¼šå†…ç½®æ”¯æŒå…¼å®¹æ€§æ£€æŸ¥ã€‚</li>
<li>â€¢    è‡ªæè¿°æ€§ï¼šæ¯æ¡æ¶ˆæ¯æºå¸¦ schema IDï¼Œå¯è‡ªåŠ¨è§£æã€‚</li>
<li>â€¢    ä¸ Kafka ç´§å¯†é›†æˆï¼šå¹¿æ³›ç”¨äº Kafka æ¶ˆæ¯åºåˆ—åŒ–ã€‚</li>
</ul>
<p>Avro vs. Protobuf å¯¹æ¯”</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Avro</th>
<th>Protobuf</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¼€å‘æ–¹</td>
<td>Apache</td>
<td>Google</td>
</tr>
<tr>
<td>Schema å®šä¹‰æ–¹å¼</td>
<td>JSON Schema</td>
<td>.protoæ–‡ä»¶ï¼ˆä¸“ç”¨è¯­æ³•ï¼‰</td>
</tr>
<tr>
<td>åºåˆ—åŒ–æ ¼å¼</td>
<td>äºŒè¿›åˆ¶</td>
<td>äºŒè¿›åˆ¶</td>
</tr>
<tr>
<td>Schemaæ˜¯å¦æºå¸¦åœ¨æ•°æ®ä¸­</td>
<td>å¯é€‰ï¼ˆé€šå¸¸åªæºå¸¦schema IDï¼‰</td>
<td>å¦ï¼ˆéœ€å¤–éƒ¨ç®¡ç†æˆ–ä»£ç ç”Ÿæˆï¼‰</td>
</tr>
<tr>
<td>Schemaæ¼”è¿›æ”¯æŒ</td>
<td>éå¸¸å¥½ï¼Œæ”¯æŒå¤šç§å…¼å®¹ç­–ç•¥</td>
<td>æœ‰ä¸€å®šæ”¯æŒï¼Œä½†ä¾èµ–ç”Ÿæˆä»£ç å’Œå…¼å®¹æ€§æ‰‹åŠ¨ç®¡ç†</td>
</tr>
<tr>
<td>ä¸Kafkaå…¼å®¹æ€§</td>
<td>æœ€ä½³ï¼Œå®˜æ–¹æ¨èä¸Schema Registryæ­é…</td>
<td>å¯ä»¥ä½¿ç”¨ï¼Œä½†ä¸å¦‚AvroåŸç”Ÿæ”¯æŒ</td>
</tr>
<tr>
<td>æ€§èƒ½</td>
<td>é«˜</td>
<td>æ›´é«˜ï¼ˆç•¥ä¼˜äºAvroï¼‰</td>
</tr>
<tr>
<td>å¯è¯»æ€§</td>
<td>JSONå®šä¹‰å¯è¯»æ€§å¥½</td>
<td>.protoæ–‡ä»¶è¾ƒè§„èŒƒä½†ä¸å¦‚JSONæ˜“è¯»</td>
</tr>
<tr>
<td>åŠ¨æ€Schemaæ”¯æŒ</td>
<td>å¼ºï¼Œæ”¯æŒæ— éœ€ç”Ÿæˆä»£ç çš„åŠ¨æ€è§£æ</td>
<td>å¼±ï¼Œæ¨èä½¿ç”¨é¢„ç¼–è¯‘çš„ç±»</td>
</tr>
</tbody>
</table>
<p>ç»“è®ºï¼š</p>
<ul>
<li>â€¢    ç”¨ Avroï¼šå¦‚æœä½ åœ¨ Kafkaã€Hadoopã€Flink ç­‰å¤§æ•°æ®ç”Ÿæ€ä¸­ï¼Œéœ€è¦ å¼º Schema æ¼”è¿›ã€ä¸ Schema Registry é›†æˆï¼Œä¼˜å…ˆé€‰ Avroã€‚</li>
<li>â€¢    ç”¨ Protobufï¼šå¦‚æœä½ è¿½æ±‚æè‡´æ€§èƒ½ã€è·¨è¯­è¨€ gRPC é€šä¿¡ã€æˆ–è€…ä½ åœ¨ Google æŠ€æœ¯æ ˆå†…ï¼ŒProtobuf æ›´é€‚åˆã€‚</li>
</ul>
<p>å®é™…å·¥ç¨‹ä¸­ï¼ŒAvro æ›´é€‚åˆ Kafka æ•°æ®æµåœºæ™¯ï¼ŒProtobuf æ›´é€‚åˆå¾®æœåŠ¡é€šä¿¡åœºæ™¯ã€‚</p>
<h3 id="schema-registryæ˜¯å•¥ï¼Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹è¿›ç¨‹å—"><a href="#schema-registryæ˜¯å•¥ï¼Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹è¿›ç¨‹å—" class="headerlink" title="schema registryæ˜¯å•¥ï¼Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹è¿›ç¨‹å—"></a>schema registryæ˜¯å•¥ï¼Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹è¿›ç¨‹å—</h3><p>æ˜¯çš„ï¼ŒSchema Registry æ˜¯ä¸€ä¸ªç‹¬ç«‹éƒ¨ç½²çš„æœåŠ¡è¿›ç¨‹ï¼Œé€šå¸¸ç”± Confluent æä¾›ï¼ˆä¹Ÿæœ‰å…¶ä»–å…¼å®¹å®ç°ï¼‰ï¼Œä¸“é—¨ç”¨äº é›†ä¸­ç®¡ç† Kafka æ¶ˆæ¯çš„ Schemaï¼Œæ”¯æŒç‰ˆæœ¬æ§åˆ¶ã€å…¼å®¹æ€§éªŒè¯ç­‰åŠŸèƒ½ã€‚</p>
<p>Schema Registry çš„ä½œç”¨ï¼š</p>
<ol>
<li>ç®¡ç† Schema ç‰ˆæœ¬ï¼šè®°å½•æ¯ä¸ª topic çš„ schema å˜æ›´å†å²ã€‚</li>
<li>éªŒè¯å…¼å®¹æ€§ï¼šé˜²æ­¢ä¸å…¼å®¹ schema ä¸Šçº¿ï¼Œä¿éšœæ¶ˆè´¹è€…å®‰å…¨ã€‚</li>
<li>æä¾› Schema ID æ˜ å°„ï¼šæ¯æ¡ Kafka æ¶ˆæ¯åªéœ€æºå¸¦ä¸€ä¸ª schema IDï¼Œååºåˆ—åŒ–æ—¶å» registry æŸ¥ schemaã€‚</li>
<li>æ”¯æŒ Avro / Protobuf / JSON Schemaï¼šä¸æ˜¯ Avro ä¸“å±ï¼Œä½† Avro æœ€å¸¸ç”¨ã€‚</li>
</ol>
<p>éƒ¨ç½²æ–¹å¼ï¼š</p>
<ul>
<li>â€¢    æ˜¯ä¸€ä¸ª ç‹¬ç«‹è¿›ç¨‹ï¼ˆJava æœåŠ¡ï¼‰ï¼Œé€šå¸¸ä»¥ REST æ¥å£å½¢å¼è¿è¡Œã€‚</li>
<li>â€¢    é»˜è®¤ç«¯å£æ˜¯ 8081ã€‚</li>
<li>â€¢    å¯ä¸ Kafka ç‹¬ç«‹éƒ¨ç½²ï¼Œä¹Ÿå¯é›†ç¾¤åŒ–éƒ¨ç½²ã€‚</li>
<li>â€¢    æ”¯æŒ é«˜å¯ç”¨ï¼ˆHAï¼‰ï¼Œå¯ä»¥é…åˆå¤šä¸ª Kafka Broker ä½¿ç”¨ã€‚</li>
</ul>
<p>Kafka + Avro + Schema Registry çš„æ¶ˆæ¯æµç¨‹å›¾ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[Producer]</span><br><span class="line">   |</span><br><span class="line">   | â€” Serialize data with Avro + schema ID</span><br><span class="line">   |</span><br><span class="line">[V] </span><br><span class="line">[Kafka Broker]</span><br><span class="line">   |</span><br><span class="line">   | â€” Consumer receives binary + schema ID</span><br><span class="line">   |</span><br><span class="line">[V]</span><br><span class="line">[Consumer]</span><br><span class="line">   |</span><br><span class="line">   | â€” Queries Schema Registry via schema ID</span><br><span class="line">   | â€” Deserializes data using schema</span><br><span class="line">   V</span><br><span class="line">  Final Object</span><br></pre></td></tr></table></figure></p>
<p>æ€»ç»“ï¼š</p>
<p>Schema Registry æ˜¯ Kafka æ¶æ„ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€ä¸ªä¸­é—´ç»„ä»¶ï¼Œç”¨äºå®‰å…¨ã€è§„èŒƒã€å¯æ¼”è¿›åœ°ç®¡ç† schemaã€‚å¦‚æœä½ åœ¨ç”¨ Kafka ä¼ ç»“æ„åŒ–æ•°æ®ï¼ˆç‰¹åˆ«æ˜¯ Avroï¼‰ï¼ŒSchema Registry æ˜¯å¼ºçƒˆæ¨èé…å¥—éƒ¨ç½²çš„æœåŠ¡ã€‚</p>
<h3 id="What-is-kafka-dead-letter-queue-and-how-do-you-handle-it"><a href="#What-is-kafka-dead-letter-queue-and-how-do-you-handle-it" class="headerlink" title="What is kafka dead letter queue and how do you handle it"></a>What is kafka dead letter queue and how do you handle it</h3><p>A Kafka dead - letter queue (DLQ) is a special topic in a Kafka cluster that is used to store messages that cannot be successfully processed for some reason. Hereâ€™s an overview of what it is and how to handle it:</p>
<ul>
<li><strong>Purpose</strong>: The main purpose of a DLQ is to prevent messages from being lost when they encounter processing failures. Instead of discarding the messages, they are sent to the DLQ for further analysis and possible re - processing.</li>
<li><strong>How Messages End Up in the DLQ</strong>: Messages can end up in the DLQ due to various reasons, such as application - level errors (e.g., incorrect message format, missing required fields), network issues, or problems with the processing logic. When a consumer fails to process a message after a certain number of retries, the message is typically redirected to the DLQ.</li>
<li><strong>Monitoring and Analysis</strong>:<ul>
<li><strong>Monitor DLQ Size</strong>: Regularly check the size of the DLQ to identify any unusual spikes. A growing DLQ may indicate a problem with the message processing pipeline.</li>
<li><strong>Inspect Messages</strong>: Examine the messages in the DLQ to determine the cause of the processing failures. This can involve looking at the message payload, headers, and any error messages associated with the failed processing attempts.</li>
</ul>
</li>
<li><strong>Error Resolution</strong>:<ul>
<li><strong>Fix Application Bugs</strong>: If the errors are due to bugs in the consumer application, fix the code and redeploy the application.</li>
<li><strong>Data Correction</strong>: If the messages in the DLQ contain incorrect data, correct the data either manually or through an automated process.</li>
</ul>
</li>
<li><strong>Message Re - processing</strong>:<ul>
<li><strong>Manual Re - processing</strong>: For critical or complex messages, you may choose to re - process them manually. This allows for careful inspection and ensures that the processing is done correctly.</li>
<li><strong>Automated Re - processing</strong>: Set up a mechanism to automatically re - process messages from the DLQ. This can be a separate consumer that reads from the DLQ and attempts to process the messages again, perhaps with some additional error - handling logic.</li>
</ul>
</li>
<li><strong>Configuration and Tuning</strong>:<ul>
<li><strong>Retry Policies</strong>: Review and adjust the retry policies for your consumers. Determine the appropriate number of retries and the delay between retries based on the nature of your application and the expected failure scenarios.</li>
<li><strong>DLQ Topic Configuration</strong>: Configure the DLQ topic with appropriate settings, such as retention policies and replication factors. Ensure that the DLQ has enough storage to handle the potentially large number of messages.</li>
</ul>
</li>
</ul>
<p>Handling a Kafka dead - letter queue effectively requires a combination of monitoring, error resolution, message re - processing, and proper configuration to ensure the reliability and integrity of the message processing system.</p>
<h2 id="kafka-Exactly-one-semantics"><a href="#kafka-Exactly-one-semantics" class="headerlink" title="kafka Exactly one semantics"></a>kafka Exactly one semantics</h2><p>Kafka æä¾›ä¸‰ç§æ¶ˆæ¯ä¼ é€’è¯­ä¹‰ï¼Œåˆ†åˆ«æ˜¯æœ€å¤šä¸€æ¬¡ï¼ˆAt most onceï¼‰ã€è‡³å°‘ä¸€æ¬¡ï¼ˆAt least onceï¼‰å’Œç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly onceï¼‰ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p>
<h3 id="æœ€å¤šä¸€æ¬¡ï¼ˆAt-most-onceï¼‰"><a href="#æœ€å¤šä¸€æ¬¡ï¼ˆAt-most-onceï¼‰" class="headerlink" title="æœ€å¤šä¸€æ¬¡ï¼ˆAt most onceï¼‰"></a>æœ€å¤šä¸€æ¬¡ï¼ˆAt most onceï¼‰</h3><ul>
<li><strong>ç”Ÿäº§è€…</strong>ï¼šæ¶ˆæ¯å‘é€åï¼Œä¸ç®¡æ˜¯å¦æˆåŠŸå†™å…¥ Kafka å°±ç»§ç»­å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚å¦‚æœå‘é€å¤±è´¥ï¼Œä¸ä¼šé‡è¯•ã€‚æ¯”å¦‚ç½‘ç»œæŠ–åŠ¨å¯¼è‡´æ¶ˆæ¯æ²¡å‘å‡ºå»ï¼Œç”Ÿäº§è€…ä¹Ÿä¸ä¼šé‡æ–°å‘é€ã€‚</li>
<li><strong>æ¶ˆè´¹è€…</strong>ï¼šæ¶ˆè´¹æ¶ˆæ¯å‰å…ˆæäº¤åç§»é‡ï¼Œå†å¤„ç†æ¶ˆæ¯ã€‚è‹¥å¤„ç†è¿‡ç¨‹ä¸­æ¶ˆè´¹è€…å´©æºƒï¼Œå·²æäº¤åç§»é‡çš„æ¶ˆæ¯ä¸ä¼šå†æ¬¡å¤„ç†ï¼Œå¯èƒ½é€ æˆæ¶ˆæ¯ä¸¢å¤±ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ•°æ®ä¸¢å¤±å®¹å¿åº¦è¾ƒé«˜ï¼Œå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ï¼Œå¦‚å®æ—¶æ—¥å¿—æ”¶é›†ï¼Œå°‘é‡æ—¥å¿—ä¸¢å¤±ä¸å½±å“æ•´ä½“åˆ†æã€‚</li>
</ul>
<h3 id="è‡³å°‘ä¸€æ¬¡ï¼ˆAt-least-onceï¼‰"><a href="#è‡³å°‘ä¸€æ¬¡ï¼ˆAt-least-onceï¼‰" class="headerlink" title="è‡³å°‘ä¸€æ¬¡ï¼ˆAt least onceï¼‰"></a>è‡³å°‘ä¸€æ¬¡ï¼ˆAt least onceï¼‰</h3><ul>
<li><strong>ç”Ÿäº§è€…</strong>ï¼šæ¶ˆæ¯å‘é€å¤±è´¥ä¼šé‡è¯•ï¼Œä¿è¯æ¶ˆæ¯è‡³å°‘è¢«å†™å…¥ Kafka ä¸€æ¬¡ã€‚ä½†å¦‚æœå†™å…¥æˆåŠŸï¼Œè€Œç¡®è®¤å“åº”ä¸¢å¤±ï¼Œç”Ÿäº§è€…é‡è¯•ä¼šå¯¼è‡´æ¶ˆæ¯é‡å¤å†™å…¥ã€‚</li>
<li><strong>æ¶ˆè´¹è€…</strong>ï¼šå…ˆå¤„ç†æ¶ˆæ¯ï¼Œå¤„ç†å®Œæˆåå†æäº¤åç§»é‡ã€‚è‹¥å¤„ç†å®Œæ¶ˆæ¯è¿˜æœªæäº¤åç§»é‡æ—¶æ¶ˆè´¹è€…å´©æºƒï¼Œé‡å¯åä¼šé‡æ–°å¤„ç†ä¹‹å‰çš„æ¶ˆæ¯ï¼Œå¯¼è‡´æ¶ˆæ¯é‡å¤æ¶ˆè´¹ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ•°æ®ä¸¢å¤±é›¶å®¹å¿ï¼Œä½†èƒ½æ¥å—æ•°æ®é‡å¤çš„åœºæ™¯ï¼Œå¦‚æ•°æ®ç»Ÿè®¡åˆ†æï¼Œé‡å¤æ•°æ®å¯ä»¥é€šè¿‡å»é‡å¤„ç†ã€‚</li>
</ul>
<h3 id="ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly-onceï¼‰"><a href="#ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly-onceï¼‰" class="headerlink" title="ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly onceï¼‰"></a>ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly onceï¼‰</h3><ul>
<li><strong>ç”Ÿäº§è€…</strong>ï¼šæœ‰å¹‚ç­‰ç”Ÿäº§è€…å’Œäº‹åŠ¡æ€§ç”Ÿäº§è€…ä¸¤ç§æœºåˆ¶ã€‚å¹‚ç­‰ç”Ÿäº§è€…å€ŸåŠ© PID å’Œåºåˆ—å·é¿å…åŒä¸€åˆ†åŒºå†…é‡å¤å†™å…¥ï¼›äº‹åŠ¡æ€§ç”Ÿäº§è€…ä¿è¯è·¨åˆ†åŒºæ¶ˆæ¯å‘é€çš„åŸå­æ€§ï¼Œå¤±è´¥å¯å›æ»šã€‚</li>
<li><strong>æ¶ˆè´¹è€…</strong>ï¼šç»“åˆç”Ÿäº§è€…äº‹åŠ¡æ“ä½œä¸æ‰‹åŠ¨æäº¤åç§»é‡ï¼Œåœ¨äº‹åŠ¡ä¸­å¤„ç†æ¶ˆæ¯å¹¶åœ¨å®Œæˆåæäº¤ï¼Œæ•…éšœæ—¶äº‹åŠ¡å›æ»šï¼Œç¡®ä¿æ¶ˆæ¯ä¸é‡å¤ä¸ä¸¢å¤±ã€‚</li>
<li><strong>åº”ç”¨åœºæ™¯</strong>ï¼šé€‚ç”¨äºå¯¹æ•°æ®å‡†ç¡®æ€§è¦æ±‚æé«˜çš„åœºæ™¯ï¼Œå¦‚é‡‘èäº¤æ˜“ç³»ç»Ÿï¼Œæ¯ç¬”äº¤æ˜“å¿…é¡»ç²¾ç¡®å¤„ç†ä¸€æ¬¡ã€‚</li>
</ul>
<h3 id="Concept"><a href="#Concept" class="headerlink" title="Concept"></a>Concept</h3><p>Exactly-once semantics means that each message is written to a Kafka topic and consumed and processed exactly once,<br>ensuring data consistency.</p>
<h3 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h3><ul>
<li><strong>Producer</strong>: Retries may lead to duplicate message writes due to the failure of receiving acknowledgments.</li>
<li><strong>Consumer</strong>: Incorrect timing of offset commits may result in duplicate message processing or message loss.</li>
</ul>
<h3 id="Solutions"><a href="#Solutions" class="headerlink" title="Solutions"></a>Solutions</h3><ul>
<li><strong>Producer</strong><ul>
<li><strong>Idempotent Producer</strong>: Introduced since Kafka 0.11.0, it avoids duplicate writes by means of the Producer ID (<br>PID) and sequence numbers.</li>
<li><strong>Transactional Producer</strong>: Ensures the atomicity of message sending across multiple partitions, and in case of<br>failure, the transaction can be rolled back.</li>
</ul>
</li>
<li><strong>Consumer</strong>: Combine the producerâ€™s transaction operations with manual offset commits. Process messages within a<br>transaction and commit the offset after the processing is completed. When a failure occurs, the transaction is rolled<br>back to ensure there are no message-related issues.</li>
</ul>
<h1 id="RabbitMQ"><a href="#RabbitMQ" class="headerlink" title="RabbitMQ"></a>RabbitMQ</h1><p>RabbitMQæ˜¯ä¸€æ¬¾ä½¿ç”¨Erlangè¯­è¨€å¼€å‘çš„ï¼Œå®ç°AMQP(é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)çš„å¼€æºæ¶ˆæ¯ä¸­é—´ä»¶ã€‚é¦–å…ˆè¦çŸ¥é“ä¸€äº›RabbitMQçš„ç‰¹ç‚¹ï¼Œå®˜ç½‘å¯æŸ¥ï¼š</p>
<ul>
<li>å¯é æ€§ã€‚æ”¯æŒæŒä¹…åŒ–ï¼Œä¼ è¾“ç¡®è®¤ï¼Œå‘å¸ƒç¡®è®¤ç­‰ä¿è¯äº†MQçš„å¯é æ€§ã€‚</li>
<li>çµæ´»çš„åˆ†å‘æ¶ˆæ¯ç­–ç•¥ã€‚è¿™åº”è¯¥æ˜¯RabbitMQçš„ä¸€å¤§ç‰¹ç‚¹ã€‚åœ¨æ¶ˆæ¯è¿›å…¥MQå‰ç”±Exchange(äº¤æ¢æœº)è¿›è¡Œè·¯ç”±æ¶ˆæ¯ã€‚åˆ†å‘æ¶ˆæ¯ç­–ç•¥æœ‰ï¼šç®€å•æ¨¡å¼ã€å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ã€å‘å¸ƒè®¢é˜…æ¨¡å¼ã€è·¯ç”±æ¨¡å¼ã€é€šé…ç¬¦æ¨¡å¼ã€‚</li>
<li>æ”¯æŒé›†ç¾¤ã€‚å¤šå°RabbitMQæœåŠ¡å™¨å¯ä»¥ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘Brokerã€‚</li>
<li>å¤šç§åè®®ã€‚RabbitMQæ”¯æŒå¤šç§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ¯”å¦‚ STOMPã€MQTT ç­‰ç­‰ã€‚</li>
<li>æ”¯æŒå¤šç§è¯­è¨€å®¢æˆ·ç«¯ã€‚RabbitMQå‡ ä¹æ”¯æŒæ‰€æœ‰å¸¸ç”¨ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ Javaã€.NETã€Ruby ç­‰ç­‰ã€‚</li>
<li>å¯è§†åŒ–ç®¡ç†ç•Œé¢ã€‚RabbitMQæä¾›äº†ä¸€ä¸ªæ˜“ç”¨çš„ç”¨æˆ·ç•Œé¢ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ç›‘æ§å’Œç®¡ç†æ¶ˆæ¯ Brokerã€‚</li>
<li>æ’ä»¶æœºåˆ¶ã€‚RabbitMQæä¾›äº†è®¸å¤šæ’ä»¶ï¼Œå¯ä»¥é€šè¿‡æ’ä»¶è¿›è¡Œæ‰©å±•ï¼Œä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„æ’ä»¶ã€‚</li>
</ul>
<h2 id="how-to-use-it-in-springboot"><a href="#how-to-use-it-in-springboot" class="headerlink" title="how to use it in springboot"></a>how to use it in springboot</h2><p><a href="https://zhuanlan.zhihu.com/p/163790007" target="_blank" rel="noopener">åŸæ–‡åœ°å€</a></p>
<p>æœåŠ¡ç«¯æ­å»ºå¥½äº†ä¹‹åè‚¯å®šè¦ç”¨å®¢æˆ·ç«¯å»æ“ä½œï¼Œæ¥ä¸‹æ¥å°±ç”¨ Java åšä¸€ä¸ªç®€å•çš„ HelloWord æ¼”ç¤ºã€‚</p>
<p>å› ä¸ºæˆ‘ç”¨çš„æ˜¯ SpringBootï¼Œæ‰€ä»¥åœ¨<strong>ç”Ÿäº§è€…è¿™è¾¹</strong>åŠ å…¥å¯¹åº”çš„ starter ä¾èµ–å³å¯ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬éœ€è¦åˆ›å»ºä¸€ä¸ªå…¬å…±é¡¹ç›® commonï¼Œå…±äº«ä¸€äº›é…ç½®ï¼Œæ¯”å¦‚é˜Ÿåˆ—ä¸»é¢˜ï¼Œäº¤æ¢æœºåç§°ï¼Œè·¯ç”±åŒ¹é…é”®åç§°ç­‰ç­‰ã€‚</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-3.png" alt="alt text"></p>
<p>é¦–å…ˆåœ¨ application.yml æ–‡ä»¶åŠ ä¸Š RabbitMQ çš„é…ç½®ä¿¡æ¯ï¼š</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line"><span class="attr">    rabbitmq:</span></span><br><span class="line"><span class="attr">        host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="attr">        port:</span> <span class="number">5672</span></span><br><span class="line"><span class="attr">        username:</span> <span class="string">guest</span></span><br><span class="line"><span class="attr">        password:</span> <span class="string">guest</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ç”Ÿäº§è€…è¿™è¾¹ï¼ŒåŠ ä¸Š common åŒ…çš„ maven ä¾èµ–ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª Direct äº¤æ¢æœºä»¥åŠé˜Ÿåˆ—çš„é…ç½®ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DirectRabbitConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Queue <span class="title">rabbitmqDemoDirectQueue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 1ã€name:    é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2ã€durable: æ˜¯å¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">         * 3ã€exclusive: æ˜¯å¦ç‹¬äº«ã€æ’å¤–çš„ã€‚å¦‚æœè®¾ç½®ä¸ºtrueï¼Œå®šä¹‰ä¸ºæ’ä»–é˜Ÿåˆ—ã€‚åˆ™åªæœ‰åˆ›å»ºè€…å¯ä»¥ä½¿ç”¨æ­¤é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯privateç§æœ‰çš„ã€‚</span></span><br><span class="line"><span class="comment">         * 4ã€autoDelete: æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚ä¹Ÿå°±æ˜¯ä¸´æ—¶é˜Ÿåˆ—ã€‚å½“æœ€åä¸€ä¸ªæ¶ˆè´¹è€…æ–­å¼€è¿æ¥åï¼Œä¼šè‡ªåŠ¨åˆ é™¤ã€‚</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Queue(RabbitMQConfig.RABBITMQ_DEMO_TOPIC, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DirectExchange <span class="title">rabbitmqDemoDirectExchange</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//Directäº¤æ¢æœº</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DirectExchange(RabbitMQConfig.RABBITMQ_DEMO_DIRECT_EXCHANGE, <span class="keyword">true</span>, <span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Binding <span class="title">bindDirect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//é“¾å¼å†™æ³•ï¼Œç»‘å®šäº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼Œå¹¶è®¾ç½®åŒ¹é…é”®</span></span><br><span class="line">        <span class="keyword">return</span> BindingBuilder</span><br><span class="line">                <span class="comment">//ç»‘å®šé˜Ÿåˆ—</span></span><br><span class="line">                .bind(rabbitmqDemoDirectQueue())</span><br><span class="line">                <span class="comment">//åˆ°äº¤æ¢æœº</span></span><br><span class="line">                .to(rabbitmqDemoDirectExchange())</span><br><span class="line">                <span class="comment">//å¹¶è®¾ç½®åŒ¹é…é”®</span></span><br><span class="line">                .with(RabbitMQConfig.RABBITMQ_DEMO_DIRECT_ROUTING);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åå†åˆ›å»ºä¸€ä¸ªå‘é€æ¶ˆæ¯çš„ Service ç±»ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitMQServiceImpl</span> <span class="keyword">implements</span> <span class="title">RabbitMQService</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ—¥æœŸæ ¼å¼åŒ–</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sendMsg</span><span class="params">(String msg)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String msgId = UUID.randomUUID().toString().replace(<span class="string">"-"</span>, <span class="string">""</span>).substring(<span class="number">0</span>, <span class="number">32</span>);</span><br><span class="line">            String sendTime = sdf.format(<span class="keyword">new</span> Date());</span><br><span class="line">            Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            map.put(<span class="string">"msgId"</span>, msgId);</span><br><span class="line">            map.put(<span class="string">"sendTime"</span>, sendTime);</span><br><span class="line">            map.put(<span class="string">"msg"</span>, msg);</span><br><span class="line">            rabbitTemplate.convertAndSend(RabbitMQConfig.RABBITMQ_DEMO_DIRECT_EXCHANGE, RabbitMQConfig.RABBITMQ_DEMO_DIRECT_ROUTING, map);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"ok"</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"error"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ ¹æ®ä¸šåŠ¡æ”¾åœ¨éœ€è¦ç”¨çš„åœ°æ–¹ï¼Œæ¯”å¦‚å®šæ—¶ä»»åŠ¡ï¼Œæˆ–è€…æ¥å£ã€‚æˆ‘è¿™é‡Œå°±ç®€å•ä¸€ç‚¹ä½¿ç”¨ Controller å±‚è¿›è¡Œå‘é€ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/mall/rabbitmq"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitMQController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RabbitMQService rabbitMQService;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@author</span> javaæŠ€æœ¯çˆ±å¥½è€…</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/sendMsg"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sendMsg</span><span class="params">(@RequestParam(name = <span class="string">"msg"</span>)</span> String msg) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rabbitMQService.sendMsg(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”Ÿäº§è€…å†™å®Œä¹‹åï¼Œå°±å†™æ¶ˆè´¹è€…ç«¯çš„ä»£ç ï¼Œæ¶ˆè´¹è€…å¾ˆç®€å•ã€‚maven ä¾èµ–ï¼Œyml æ–‡ä»¶é…ç½®å’Œç”Ÿäº§è€…ä¸€æ ·ã€‚åªéœ€è¦åˆ›å»ºä¸€ä¸ªç±»ï¼Œ@RabbitListener æ³¨è§£å†™ä¸Šç›‘å¬é˜Ÿåˆ—çš„åç§°ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š<br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-4.png" alt="alt text"></p>
<p>æœ€åå†å¯åŠ¨æ¶ˆè´¹è€…ï¼Œè¿›è¡Œæ¶ˆè´¹ï¼š</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-5.png" alt="alt text"><br>è¿™æ—¶å€™å°±ä¼šæŒç»­ç›‘å¬é˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œåªè¦ç”Ÿäº§è€…å‘é€ä¸€æ¡æ¶ˆæ¯åˆ° MQï¼Œæ¶ˆè´¹è€…å°±æ¶ˆè´¹ä¸€æ¡ã€‚æˆ‘è¿™é‡Œå°è¯•å‘é€ 4 æ¡ï¼š</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-6.png" alt="alt text"><br>ç”±äºé˜Ÿåˆ—ä¸å­˜åœ¨ï¼Œå¯åŠ¨æ¶ˆè´¹è€…æŠ¥é”™çš„è¿™ä¸ªé—®é¢˜ã€‚æœ€å¥½çš„æ–¹æ³•æ˜¯ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½å°è¯•åˆ›å»ºé˜Ÿåˆ—ï¼Œæ€ä¹ˆå†™å‘¢ï¼Œæœ‰å¾ˆå¤šæ–¹å¼ï¼Œæˆ‘è¿™é‡Œç”¨ä¸€ä¸ªç›¸å¯¹ç®€å•ä¸€ç‚¹çš„ï¼š</p>
<p>ç”Ÿäº§è€…çš„é…ç½®ç±»åŠ ç‚¹ä¸œè¥¿ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å®ç°BeanPostProcessorç±»ï¼Œä½¿ç”¨Beançš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DirectRabbitConfig</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¿™æ˜¯åˆ›å»ºäº¤æ¢æœºå’Œé˜Ÿåˆ—ç”¨çš„rabbitAdminå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RabbitAdmin rabbitAdmin;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–rabbitAdminå¯¹è±¡</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RabbitAdmin <span class="title">rabbitAdmin</span><span class="params">(ConnectionFactory connectionFactory)</span> </span>&#123;</span><br><span class="line">        RabbitAdmin rabbitAdmin = <span class="keyword">new</span> RabbitAdmin(connectionFactory);</span><br><span class="line">        <span class="comment">// åªæœ‰è®¾ç½®ä¸º trueï¼Œspring æ‰ä¼šåŠ è½½ RabbitAdmin è¿™ä¸ªç±»</span></span><br><span class="line">        rabbitAdmin.setAutoStartup(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> rabbitAdmin;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å®ä¾‹åŒ–beanåï¼Œä¹Ÿå°±æ˜¯Beançš„åç½®å¤„ç†å™¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">        rabbitAdmin.declareExchange(rabbitmqDemoDirectExchange());</span><br><span class="line">        <span class="comment">//åˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line">        rabbitAdmin.declareQueue(rabbitmqDemoDirectQueue());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å¯åŠ¨ç”Ÿäº§è€…å°±ä¼šè‡ªåŠ¨åˆ›å»ºäº¤æ¢æœºå’Œé˜Ÿåˆ—ï¼Œä¸ç”¨ç­‰åˆ°å‘é€æ¶ˆæ¯æ‰åˆ›å»ºã€‚</p>
<p>æ¶ˆè´¹è€…éœ€è¦åŠ ä¸€ç‚¹ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">//ä½¿ç”¨queuesToDeclareå±æ€§ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šåˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@RabbitListener</span>(queuesToDeclare = <span class="meta">@Queue</span>(RabbitMQConfig.RABBITMQ_DEMO_TOPIC))</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RabbitDemoConsumer</span> </span>&#123;</span><br><span class="line">    <span class="comment">//...çœç•¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œæ— è®ºç”Ÿäº§è€…è¿˜æ˜¯æ¶ˆè´¹è€…å…ˆå¯åŠ¨éƒ½ä¸ä¼šå‡ºç°é—®é¢˜äº†~</p>
<blockquote>
<p>ä»£ç åœ°å€ï¼š<a href="https://github.com/yehongzhi/mall" target="_blank" rel="noopener">https://github.com/yehongzhi/mall</a>  </p>
</blockquote>
<h2 id="components-of-RabbitMQ"><a href="#components-of-RabbitMQ" class="headerlink" title="components of RabbitMQ"></a>components of RabbitMQ</h2><p>ä»ä¸Šé¢çš„ HelloWord ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¤§æ¦‚ä¹Ÿèƒ½ä½“éªŒåˆ°ä¸€äº›ï¼Œå°±æ˜¯ RabbitMQ çš„ç»„æˆï¼Œå®ƒæ˜¯æœ‰è¿™å‡ éƒ¨åˆ†ï¼š</p>
<ul>
<li>Brokerï¼šæ¶ˆæ¯é˜Ÿåˆ—æœåŠ¡è¿›ç¨‹ã€‚æ­¤è¿›ç¨‹åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šExchange å’Œ Queueã€‚<ul>
<li>Exchangeï¼šæ¶ˆæ¯é˜Ÿåˆ—äº¤æ¢æœºã€‚<strong>æŒ‰ä¸€å®šçš„è§„åˆ™å°†æ¶ˆæ¯è·¯ç”±è½¬å‘åˆ°æŸä¸ªé˜Ÿåˆ—</strong>ã€‚</li>
<li>Queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯çš„é˜Ÿåˆ—ã€‚</li>
</ul>
</li>
<li>Producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…ã€‚ç”Ÿäº§æ–¹å®¢æˆ·ç«¯å°†æ¶ˆæ¯åŒäº¤æ¢æœºè·¯ç”±å‘é€åˆ°é˜Ÿåˆ—ä¸­ã€‚</li>
<li>Consumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ã€‚æ¶ˆè´¹é˜Ÿåˆ—ä¸­å­˜å‚¨çš„æ¶ˆæ¯ã€‚</li>
</ul>
<p>è¿™äº›ç»„æˆéƒ¨åˆ†æ˜¯å¦‚ä½•ååŒå·¥ä½œçš„å‘¢ï¼Œå¤§æ¦‚çš„æµç¨‹å¦‚ä¸‹ï¼Œè¯·çœ‹ä¸‹å›¾ï¼š</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-7.png" alt="alt text"></p>
<ol>
<li>æ¶ˆæ¯ç”Ÿäº§è€…è¿æ¥åˆ° RabbitMQ Brokerï¼Œåˆ›å»º connectionï¼Œå¼€å¯ channelã€‚</li>
<li>ç”Ÿäº§è€…å£°æ˜äº¤æ¢æœºç±»å‹ã€åç§°ã€æ˜¯å¦æŒä¹…åŒ–ç­‰ã€‚</li>
<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼Œå¹¶æŒ‡å®šæ¶ˆæ¯æ˜¯å¦æŒä¹…åŒ–ç­‰å±æ€§å’Œ routing keyã€‚</li>
<li>exchange æ”¶åˆ°æ¶ˆæ¯ä¹‹åï¼Œ<strong>æ ¹æ® routing key è·¯ç”±åˆ°è·Ÿå½“å‰äº¤æ¢æœºç»‘å®šçš„ç›¸åŒ¹é…çš„é˜Ÿåˆ—</strong>é‡Œé¢ã€‚</li>
<li>æ¶ˆè´¹è€…ç›‘å¬æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹åå¼€å§‹ä¸šåŠ¡å¤„ç†ã€‚</li>
</ol>
<h2 id="different-types-of-Exchange"><a href="#different-types-of-Exchange" class="headerlink" title="different types of Exchange"></a>different types of Exchange</h2><p>ä»ä¸Šé¢çš„å·¥ä½œæµç¨‹å¯ä»¥çœ‹å‡ºï¼Œå®é™…ä¸Šæœ‰ä¸ªå…³é”®çš„ç»„ä»¶ Exchangeï¼Œå› ä¸º<strong>æ¶ˆæ¯å‘é€åˆ° RabbitMQ åé¦–å…ˆè¦ç»è¿‡ Exchange è·¯ç”±æ‰èƒ½æ‰¾åˆ°å¯¹åº”çš„ Queue</strong>ã€‚</p>
<p>å®é™…ä¸Š Exchange ç±»å‹æœ‰å››ç§ï¼Œæ ¹æ®ä¸åŒçš„ç±»å‹å·¥ä½œçš„æ–¹å¼ä¹Ÿæœ‰æ‰€ä¸åŒã€‚åœ¨ HelloWord ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨äº†æ¯”è¾ƒç®€å•çš„ <strong>Direct Exchange</strong>ï¼Œç¿»è¯‘å°±æ˜¯ç›´è¿äº¤æ¢æœºã€‚å…¶ä½™ä¸‰ç§åˆ†åˆ«æ˜¯ï¼š<strong>Fanout exchangeã€Topic exchangeã€Headers exchange</strong>ã€‚</p>
<h3 id="Direct-Exchange"><a href="#Direct-Exchange" class="headerlink" title="Direct Exchange"></a>Direct Exchange</h3><p>è§æ–‡çŸ¥æ„ï¼Œç›´è¿äº¤æ¢æœºæ„æ€æ˜¯æ­¤äº¤æ¢æœºéœ€è¦ç»‘å®šä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¦æ±‚<strong>è¯¥æ¶ˆæ¯ä¸ä¸€ä¸ªç‰¹å®šçš„è·¯ç”±é”®å®Œå…¨åŒ¹é…</strong>ã€‚ç®€å•ç‚¹è¯´å°±æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œç‚¹å¯¹ç‚¹çš„å‘é€ã€‚<br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-8.png" alt="alt text"></p>
<p>å®Œæ•´çš„ä»£ç å°±æ˜¯ä¸Šé¢çš„ HelloWord çš„ä¾‹å­ï¼Œä¸å†é‡å¤ä»£ç ã€‚</p>
<h3 id="Fanout-exchange"><a href="#Fanout-exchange" class="headerlink" title="Fanout exchange"></a>Fanout exchange</h3><p>è¿™ç§ç±»å‹çš„äº¤æ¢æœºéœ€è¦å°†é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœºä¸Šã€‚<strong>ä¸€ä¸ªå‘é€åˆ°äº¤æ¢æœºçš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥äº¤æ¢æœºç»‘å®šçš„æ‰€æœ‰é˜Ÿåˆ—ä¸Š</strong>ã€‚å¾ˆåƒå­ç½‘å¹¿æ’­ï¼Œæ¯å°å­ç½‘å†…çš„ä¸»æœºéƒ½è·å¾—äº†ä¸€ä»½å¤åˆ¶çš„æ¶ˆæ¯ã€‚ç®€å•ç‚¹è¯´å°±æ˜¯å‘å¸ƒè®¢é˜…ã€‚<br><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-9.png" alt="alt text"></p>
<h3 id="Topic-Exchange"><a href="#Topic-Exchange" class="headerlink" title="Topic Exchange"></a>Topic Exchange</h3><p>ç›´æ¥ç¿»è¯‘çš„è¯å«åšä¸»é¢˜äº¤æ¢æœºï¼Œå¦‚æœä»ç”¨æ³•ä¸Šé¢ç¿»è¯‘å¯èƒ½å«é€šé…ç¬¦äº¤æ¢æœºä¼šæ›´åŠ è´´åˆ‡ã€‚è¿™ç§äº¤æ¢æœºæ˜¯ä½¿ç”¨é€šé…ç¬¦å»åŒ¹é…ï¼Œè·¯ç”±åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚é€šé…ç¬¦æœ‰ä¸¤ç§ï¼š<code>&quot;*&quot;</code> ã€ <code>&quot;#&quot;</code>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯é€šé…ç¬¦å‰é¢å¿…é¡»è¦åŠ ä¸Š <code>&quot;.&quot;</code> ç¬¦å·ã€‚</p>
<ul>
<li><code>*</code> ç¬¦å·ï¼šæœ‰ä¸”åªåŒ¹é…ä¸€ä¸ªè¯ã€‚æ¯”å¦‚ <code>a.*</code>å¯ä»¥åŒ¹é…åˆ° â€œa.bâ€ã€â€a.câ€ï¼Œä½†æ˜¯åŒ¹é…ä¸äº† â€œa.b.câ€ã€‚</li>
<li><code>#</code> ç¬¦å·ï¼šåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯ã€‚æ¯”å¦‚ â€œrabbit.#â€ æ—¢å¯ä»¥åŒ¹é…åˆ° â€œrabbit.a.bâ€ã€â€rabbit.aâ€ï¼Œä¹Ÿå¯ä»¥åŒ¹é…åˆ° â€œrabbit.a.b.câ€ã€‚</li>
</ul>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-10.png" alt="alt text"></p>
<h3 id="Headers-Exchange"><a href="#Headers-Exchange" class="headerlink" title="Headers Exchange"></a>Headers Exchange</h3><p>è¿™ç§äº¤æ¢æœºç”¨çš„ç›¸å¯¹æ²¡è¿™ä¹ˆå¤šã€‚<strong>å®ƒè·Ÿä¸Šé¢ä¸‰ç§æœ‰ç‚¹åŒºåˆ«ï¼Œå®ƒçš„è·¯ç”±ä¸æ˜¯ç”¨ routingKey è¿›è¡Œè·¯ç”±åŒ¹é…ï¼Œè€Œæ˜¯åœ¨åŒ¹é…è¯·æ±‚å¤´ä¸­æ‰€å¸¦çš„é”®å€¼è¿›è¡Œè·¯ç”±</strong>ã€‚å¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-11.png" alt="alt text"></p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="../img/na_mq_notes/image-12.png" alt="alt text"></p>
<p>åˆ›å»ºé˜Ÿåˆ—éœ€è¦è®¾ç½®ç»‘å®šçš„å¤´éƒ¨ä¿¡æ¯ï¼Œæœ‰ä¸¤ç§æ¨¡å¼ï¼š<strong>å…¨éƒ¨åŒ¹é…å’Œéƒ¨åˆ†åŒ¹é…</strong>ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œäº¤æ¢æœºä¼šæ ¹æ®ç”Ÿäº§è€…å‘é€è¿‡æ¥çš„å¤´éƒ¨ä¿¡æ¯æºå¸¦çš„é”®å€¼å»åŒ¹é…é˜Ÿåˆ—ç»‘å®šçš„é”®å€¼ï¼Œè·¯ç”±åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚</p>

      


      

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/noodle/" rel="tag"><i class="fa fa-tag"></i> noodle</a>
            
              <a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a>
            
              <a href="/tags/NA/" rel="tag"><i class="fa fa-tag"></i> NA</a>
            
              <a href="/tags/Kafka/" rel="tag"><i class="fa fa-tag"></i> Kafka</a>
            
              <a href="/tags/RabbitMQ/" rel="tag"><i class="fa fa-tag"></i> RabbitMQ</a>
            
          </div>
        

        
        
        

        
          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/na_contractor_real_q/" rel="next" title="Contractor interview real Q">
                  <i class="fa fa-chevron-left"></i> 
                  <p class="post-nav-pre-next-title">
                    Contractor interview real Q
                  </p> 
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/na_java_backend_syllabus/" rel="prev" title="Java backend syllabus">
                <p class="post-nav-pre-next-title">
                    Java backend syllabus
                </p> 
                <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        

        
        
      </footer>
      
    </div>
    
    
    

    

    

    

  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  

  <aside id="sidebar" class="sidebar">

    
      
        <div id="sidebar-dimmer"></div>
      
    

    <div class="sidebar-inner">
    
      <div class="sidebar-toggle-inside motion-element">
        <div class="sidebar-toggle-line-wrap">
          <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
          <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
          <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
        </div>
      </div>

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a href="/" class="site-author-image" rel="start" style="border:none">
            <img class="site-author-image" itemprop="image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="/uploads/avatar.png" alt="Mike">
          </a>
          <p class="site-author-name" itemprop="name">Mike</p>
           
              <p class="site-description motion-element" itemprop="description">ğŸš™ ğŸš— ğŸ’¨ ğŸ’¨ If you want to create a blog like this, just follow my open-source project, "hexo-theme-neo", click the GitHub button below and check it out ^_^ . It is recommended to use Chrome, Safari, or Edge to read this blog since this blog was developed on Edge (Chromium kernel version) and tested on Safari.</p>
          
        </div>

        <nav class="site-state motion-element">

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">298</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">111</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

          <div class="site-state-item site-state-about">
            <a href="/about/">
              <span class="site-state-item-about fa fa-fw fa-user"></span>
              <span class="site-state-item-name">about</span>
            </a>
          </div>
          
        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/no5ix" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://open.spotify.com/user/313duq77ekebrfyak3xijqewzss4?si=e7653b829a9747bf" target="_blank" title="Spotify">
                  
                    <i class="fa fa-fw fa-spotify"></i>
                  
                    
                      Spotify
                    
                </a>
              </span>
            
          
          
          <!-- ç½‘æ˜“äº‘éŸ³ä¹ -->
            <!-- <div class="netease-cloud-music"> -->
              <!-- <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=280 height=110 src="//music.163.com/outchain/player?type=0&id=992743594&auto=0&height=90"></iframe> -->
            <!-- </div> -->
          <!-- ç½‘æ˜“äº‘éŸ³ä¹ -->

        </div>

        
        

        
        

        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#å‚è€ƒé“¾æ¥"><span class="nav-text">å‚è€ƒé“¾æ¥</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#syllabus"><span class="nav-text">syllabus</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#why-MQ"><span class="nav-text">why MQ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Kafka-vs-RabbitMQ"><span class="nav-text">Kafka vs. RabbitMQ</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Kafka"><span class="nav-text">Kafka</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸€ä¸ªtopicæœ‰å¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionåˆæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œleaderå‰¯æœ¬å’Œfollowerå‰¯æœ¬å—"><span class="nav-text">ä¸€ä¸ªtopicæœ‰å¤šä¸ªpartitionï¼Œæ¯ä¸ªpartitionåˆæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œleaderå‰¯æœ¬å’Œfollowerå‰¯æœ¬å—?</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¸»é¢˜ï¼ˆTopicï¼‰"><span class="nav-text">ä¸»é¢˜ï¼ˆTopicï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ†åŒºï¼ˆPartitionï¼‰"><span class="nav-text">åˆ†åŒºï¼ˆPartitionï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å‰¯æœ¬ï¼ˆReplicaï¼‰"><span class="nav-text">å‰¯æœ¬ï¼ˆReplicaï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¤ºä¾‹è¯´æ˜"><span class="nav-text">ç¤ºä¾‹è¯´æ˜</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KafkaåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºæ˜¯å…±äº«åŒä¸€ä¸ªoffsetçš„æ˜¯å§"><span class="nav-text">KafkaåŒä¸€ä¸ªæ¶ˆè´¹ç»„å¯¹äºä¸€ä¸ªåˆ†åŒºæ˜¯å…±äº«åŒä¸€ä¸ªoffsetçš„æ˜¯å§</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åŸç†"><span class="nav-text">åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç›®çš„"><span class="nav-text">ç›®çš„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å½±å“"><span class="nav-text">å½±å“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#in-kafka-how-to-handle-schema-evolution"><span class="nav-text">in kafka, how to handle schema evolution</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»€ä¹ˆæ˜¯schema"><span class="nav-text">ä»€ä¹ˆæ˜¯schema</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¦‚ä½•å¤„ç†"><span class="nav-text">å¦‚ä½•å¤„ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#avroæ˜¯å•¥å’Œprotobufå¯¹æ¯”"><span class="nav-text">avroæ˜¯å•¥å’Œprotobufå¯¹æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#schema-registryæ˜¯å•¥ï¼Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹è¿›ç¨‹å—"><span class="nav-text">schema registryæ˜¯å•¥ï¼Ÿä¸€ä¸ªç¬¬ä¸‰æ–¹è¿›ç¨‹å—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-kafka-dead-letter-queue-and-how-do-you-handle-it"><span class="nav-text">What is kafka dead letter queue and how do you handle it</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#kafka-Exactly-one-semantics"><span class="nav-text">kafka Exactly one semantics</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ€å¤šä¸€æ¬¡ï¼ˆAt-most-onceï¼‰"><span class="nav-text">æœ€å¤šä¸€æ¬¡ï¼ˆAt most onceï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è‡³å°‘ä¸€æ¬¡ï¼ˆAt-least-onceï¼‰"><span class="nav-text">è‡³å°‘ä¸€æ¬¡ï¼ˆAt least onceï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly-onceï¼‰"><span class="nav-text">ç²¾ç¡®ä¸€æ¬¡ï¼ˆExactly onceï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Concept"><span class="nav-text">Concept</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Challenges"><span class="nav-text">Challenges</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solutions"><span class="nav-text">Solutions</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#RabbitMQ"><span class="nav-text">RabbitMQ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#how-to-use-it-in-springboot"><span class="nav-text">how to use it in springboot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#components-of-RabbitMQ"><span class="nav-text">components of RabbitMQ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#different-types-of-Exchange"><span class="nav-text">different types of Exchange</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Direct-Exchange"><span class="nav-text">Direct Exchange</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fanout-exchange"><span class="nav-text">Fanout exchange</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Topic-Exchange"><span class="nav-text">Topic Exchange</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Headers-Exchange"><span class="nav-text">Headers Exchange</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mike</span>
</div>



        

        
      </div>
    </footer>

    <!--
    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      
        <span id="scrollpercent"><span>0</span>%</span>
      
    </div>
    -->

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>










  















  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/mediumzoom/medium-zoom.js?v=1.1.0"></script>





  




  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>


  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

    <script src="/js/src/local-search.js"></script>





  

  

  

  

  

  


  <script type="text/javascript" src="/lib/wobble_window/wobblewindow.js"> </script>
<script type="text/javascript" src="/js/src/custom.js"></script>
</body>
</html>






<script type="text/javascript" src="/js/src/headroom.js"></script>

<!-- ä»£ç å—å¤åˆ¶åŠŸèƒ½ -->
<script type="text/javascript" src="/js/src/code-highlight-modification.js"></script>

<!-- Flashcards Script -->
<script type="text/javascript" src="/js/src/flashcards.js"></script>
