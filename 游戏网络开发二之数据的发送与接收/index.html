<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


  <meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">

<script>
    (function(){
        if(''){
            let localStoragePasswdKey = 'æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶' + '_last_passwd';
            let tryCnt = 0;
            function checkPassword(password) {
                password = password == null ? null : password.trim();
                if (password !== '') {
                    if (password != null) {
                        // å¦‚æœç”¨æˆ·ç‚¹å‡»äº†ç¡®è®¤è€Œä¸”å¯†ç é”™è¯¯çš„æ—¶å€™, å› ä¸ºå½“password == nullçš„æ—¶å€™è¯´æ˜ç”¨æˆ·ç‚¹äº†å–æ¶ˆ
                        alert('Error!');
                        if (++tryCnt < 3) {
                            password = prompt('Open Sesame');
                            checkPassword(password);
                            return;
                        }
                    }

                    // if (history.length > 1) {
                    //     alert('back!');
                    //     history.back();
                    // } else {
                        // alert('blankkkk!');
                    //     window.location.href = "about:blank";
                    // }
                    if (document.referrer) {
                        window.location.href = document.referrer;
                    } else {
                        window.location.href = "about:blank";; // fallback if no referrer
                    }

                } else {
                    localStorage.setItem(localStoragePasswdKey, password);
                }
            }

            var password_verify_on_local = false;
            const hostname = window.location.hostname;
            if (password_verify_on_local || (!(hostname === "localhost" || hostname === "127.0.0.1" || hostname === "::1" || hostname.startsWith("192")))) {
                const lspk = localStorage.getItem(localStoragePasswdKey) || "";
                if (lspk !== '') {
                    var password = prompt('Open Sesame');
                    checkPassword(password);
                }
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">





















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="TCP,GafferOnGames,UDP,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2">






<meta name="description" content="åŸæ–‡åŸæ–‡å‡ºå¤„ Introduction Hi, I&amp;rsquo;m Glenn Fiedler and welcome to Networking for Game Programmers.In the previous article we discussed options for sending data between computers and decided to use UDP in">
<meta name="keywords" content="TCP,GafferOnGames,UDP">
<meta property="og:type" content="article">
<meta property="og:title" content="æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶">
<meta property="og:url" content="https://hulinhong.com/æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶/index.html">
<meta property="og:site_name" content="ğŸš™">
<meta property="og:description" content="åŸæ–‡åŸæ–‡å‡ºå¤„ Introduction Hi, I&amp;rsquo;m Glenn Fiedler and welcome to Networking for Game Programmers.In the previous article we discussed options for sending data between computers and decided to use UDP in">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2025-12-17T18:31:29.690Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶">
<meta name="twitter:description" content="åŸæ–‡åŸæ–‡å‡ºå¤„ Introduction Hi, I&amp;rsquo;m Glenn Fiedler and welcome to Networking for Game Programmers.In the previous article we discussed options for sending data between computers and decided to use UDP in">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":12,"scrollpercent":true,"onmobile":true,"dimmer":true,"body_content_height":0,"display_duration":150},
    local_search: {"enable":true,"trigger":"auto","top_n_per_article":1},
    fancybox: false,
    mediumzoom: true,
    darkmode_js: false,
    tabs: true,
    motion: {"enable":true,"async":false,"duration":188,"transition":{"header":"fadeIn","menu":"fadeIn","logo":"fadeIn","post_block_else":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"fadeIn","footer":"fadeIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>








  <title>æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶ | ğŸš™</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ğŸš™</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ğŸ’¨ ğŸ’¨ ğŸ’¨</p>
      
  </div>

  <div class="menu-item sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div class="menu-item site-search">
    
  
  <div class="site-search-div">
    <button class="search-icon" id="search-button">
      <i class="fa fa-search"></i>
    </button>
    <input type="text" id="local-search-input" class="st-search-input">
    <i id="local-search-close">Ã—</i>
  </div>


<script type="text/javascript" id="local.search.active">
    {/* var inputArea       = document.querySelector("#local-search-input");
    inputArea.onclick   = function(){ getSearchFile(); this.focus(); }
    inputArea.onkeydown = function(){ if(event.keyCode == 13) return false } */}
</script>



  </div>
  <div id="local-search-result-pc" class="local-search-result-cls"></div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      

       
    </ul>
  

  
    
  
</nav>



 </div>
    </header>

    <div id="local-search-result-mobile" class="local-search-result-cls"></div>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hulinhong.com/æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mike">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸš™">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">æ¸¸æˆç½‘ç»œå¼€å‘äºŒä¹‹æ•°æ®çš„å‘é€ä¸æ¥æ”¶</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-11-15T22:20:34+00:00">
                11-15-2016
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GS/" itemprop="url" rel="index">
                    <span itemprop="name">GS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <div class="post-tags">
              
                <a href="/tags/TCP/" rel="tag"><i class="fa fa-tag"></i> TCP</a>
              
                <a href="/tags/GafferOnGames/" rel="tag"><i class="fa fa-tag"></i> GafferOnGames</a>
              
                <a href="/tags/UDP/" rel="tag"><i class="fa fa-tag"></i> UDP</a>
              
            </div>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    




    
    
    
    <div class="post-body" itemprop="articleBody">
      
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/æ¸¸æˆç½‘ç»œå¼€å‘ä¸€ä¹‹TCPvsUDP/" rel="next" title="æ¸¸æˆç½‘ç»œå¼€å‘ä¸€ä¹‹TCPvsUDP">
                <i class="fa fa-chevron-left"></i> 
                <p class="post-nav-pre-next-title">
                  æ¸¸æˆç½‘ç»œå¼€å‘ä¸€ä¹‹TCPvsUDP
                </p> 
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/virtual_connection_over_udp/" rel="prev" title="æ¸¸æˆç½‘ç»œå¼€å‘ä¸‰ä¹‹åŸºäºUDPçš„è™šæ‹Ÿè¿æ¥">
              <p class="post-nav-pre-next-title">
                  æ¸¸æˆç½‘ç»œå¼€å‘ä¸‰ä¹‹åŸºäºUDPçš„è™šæ‹Ÿè¿æ¥
              </p> 
              <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      

      
      

      
        <h1 id="åŸæ–‡"><a href="#åŸæ–‡" class="headerlink" title="åŸæ–‡"></a>åŸæ–‡</h1><p><a href="https://gafferongames.com/post/sending_and_receiving_packets/" target="_blank" rel="noopener">åŸæ–‡å‡ºå¤„</a></p>
<p></p><h2 id="introduction">Introduction</h2><p></p>
<p>Hi, I&rsquo;m <a href="https://gafferongames.com/about" target="_blank" rel="noopener">Glenn Fiedler</a> and welcome to <a href="https://gafferongames.com/categories/game-networking/" target="_blank" rel="noopener"><strong>Networking for Game Programmers</strong></a>.</p><br><p>In the <a href="https://gafferongames.com/post/udp_vs_tcp/" target="_blank" rel="noopener">previous article</a> we discussed options for sending data between computers and decided to use UDP instead of TCP for time critical data.</p><br><p>In this article I am going to show you how to send and receive UDP packets.</p><br><h2 id="bsd-sockets">BSD sockets</h2><br><p>For most modern platforms you have some sort of basic socket layer available based on BSD sockets.</p><br><p>BSD sockets are manipulated using simple functions like &ldquo;socket&rdquo;, &ldquo;bind&rdquo;, &ldquo;sendto&rdquo; and &ldquo;recvfrom&rdquo;. You can of course work directly with these functions if you wish, but it becomes difficult to keep your code platform independent because each platform is slightly different.</p><br><p>So although I will first show you BSD socket example code to demonstrate basic socket usage, we won&rsquo;t be using BSD sockets directly for long. Once we&rsquo;ve covered all basic socket functionality we&rsquo;ll abstract everything away into a set of classes, making it easy to you to write platform independent socket code.</p><br><h2 id="platform-specifics">Platform specifics</h2><br><p>First let&rsquo;s setup a define so we can detect what our current platform is and handle the slight differences in sockets from one platform to another:</p><br><pre><code>    // platform detection<br><br>    #define PLATFORM_WINDOWS  1<br>    #define PLATFORM_MAC      2<br>    #define PLATFORM_UNIX     3<br><br>    #if defined(_WIN32)<br>    #define PLATFORM PLATFORM_WINDOWS<br>    #elif defined(<strong>APPLE</strong>)<br>    #define PLATFORM PLATFORM_MAC<br>    #else<br>    #define PLATFORM PLATFORM_UNIX<br>    #endif<br></code></pre><br><p>Now let&rsquo;s include the appropriate headers for sockets. Since the header files are platform specific, we&rsquo;ll use the platform #define to include different sets of files depending on the platform:</p><br><pre><code>    #if PLATFORM == PLATFORM_WINDOWS<br><br>        #include &lt;winsock2.h&gt;<br><br>    #elif PLATFORM == PLATFORM_MAC ||<br>          PLATFORM == PLATFORM_UNIX<br><br>        #include &lt;sys/socket.h&gt;<br>        #include &lt;netinet/in.h&gt;<br>        #include &lt;fcntl.h&gt;<br><br>    #endif<br></code></pre><br><p>Sockets are built in to the standard system libraries on unix-based platforms so we don&rsquo;t have to link to any additonal libraries. However, on Windows we need to link to the winsock library to get socket functionality.</p><br><p>Here is a simple trick to do this without having to change your project or makefile:</p><br><pre><code>    #if PLATFORM == PLATFORM_WINDOWS<br>    #pragma comment( lib, &quot;wsock32.lib&quot; )<br>    #endif<br></code></pre><br><p>I like this trick because I&rsquo;m super lazy. You can always link from your project or makefile if you wish.</p><br><h2 id="initializing-the-socket-layer">Initializing the socket layer</h2><br><p>Most unix-like platforms (including macosx) don&rsquo;t require any specific steps to initialize the sockets layer, however Windows requires that you jump through some hoops to get your socket code working.</p><br><p>You must call &ldquo;WSAStartup&rdquo; to initialize the sockets layer before you call any socket functions, and &ldquo;WSACleanup&rdquo; to shutdown when you are done.</p><br><p>Let&rsquo;s add two new functions:</p><br><pre><code>    bool InitializeSockets()<br>    {<br>        #if PLATFORM == PLATFORM_WINDOWS<br>        WSADATA WsaData;<br>        return WSAStartup( MAKEWORD(2,2),<br>                           &amp;WsaData )<br>            == NO_ERROR;<br>        #else<br>        return true;<br>        #endif<br>    }<br><br>    void ShutdownSockets()<br>    {<br>        #if PLATFORM == PLATFORM_WINDOWS<br>        WSACleanup();<br>        #endif<br>    }<br></code></pre><br><p>Now we have a platform independent way to initialize the socket layer.</p><br><h2 id="creating-a-socket">Creating a socket</h2><br><p>It&rsquo;s time to create a UDP socket, here&rsquo;s how to do it:</p><br><pre><code>    int handle = socket( AF_INET,<br>                         SOCK_DGRAM,<br>                         IPPROTO_UDP );<br><br>    if ( handle &lt;= 0 )<br>    {<br>        printf( &quot;failed to create socket\n&quot; );<br>        return false;<br>    }<br></code></pre><br><p>Next we bind the UDP socket to a port number (eg. 30000). Each socket must be bound to a unique port, because when a packet arrives the port number determines which socket to deliver to. Don&rsquo;t use ports lower than 1024 because they are reserved for the system. Also try to avoid using ports above 50000 because they used when dynamically assigning ports.</p><br><p>Special case: if you don&rsquo;t care what port your socket gets bound to just pass in &ldquo;0&rdquo; as your port, and the system will select a free port for you.</p><br><pre><code>    sockaddr_in address;<br>    address.sin_family = AF_INET;<br>    address.sin_addr.s_addr = INADDR_ANY;<br>    address.sin_port =<br>        htons( (unsigned short) port );<br><br>    if ( bind( handle,<br>               (const sockaddr<em>) &amp;address,<br>               sizeof(sockaddr_in) ) &lt; 0 )<br>    {<br>        printf( &quot;failed to bind socket\n&quot; );<br>        return false;<br>    }<br></em></code></pre><br><p>Now the socket is ready to send and receive packets.</p><br><p>But what is this mysterious call to &ldquo;htons&rdquo; in the code above? This is just a helper function that converts a 16 bit integer value from host byte order (little or big-endian) to network byte order (big-endian). This is required whenever you directly set integer members in socket structures.</p><br><p>You&rsquo;ll see &ldquo;htons&rdquo; (host to network short) and its 32 bit integer sized cousin &ldquo;htonl&rdquo; (host to network long) used several times throughout this article, so keep an eye out, and you&rsquo;ll know what is going on.</p><br><h2 id="setting-the-socket-as-non-blocking">Setting the socket as non-blocking</h2><br><p>By default sockets are set in what is called &ldquo;blocking mode&rdquo;.</p><br><p>This means that if you try to read a packet using &ldquo;recvfrom&rdquo;, the function will not return until a packet is available to read. This is not at all suitable for our purposes. Video games are realtime programs that simulate at 30 or 60 frames per second, they can&rsquo;t just sit there waiting for a packet to arrive!</p><br><p>The solution is to flip your sockets into &ldquo;non-blocking mode&rdquo; after you create them. Once this is done, the &ldquo;recvfrom&rdquo; function returns immediately when no packets are available to read, with a return value indicating that you should try to read packets again later.</p><br><p>Here&rsquo;s how put a socket in non-blocking mode:</p><br><pre><code>    #if PLATFORM == PLATFORM_MAC ||<br>        PLATFORM == PLATFORM_UNIX<br><br>        int nonBlocking = 1;<br>        if ( fcntl( handle,<br>                    F_SETFL,<br>                    O_NONBLOCK,<br>                    nonBlocking ) == -1 )<br>        {<br>            printf( &quot;failed to set non-blocking\n&quot; );<br>            return false;<br>        }<br><br>    #elif PLATFORM == PLATFORM_WINDOWS<br><br>        DWORD nonBlocking = 1;<br>        if ( ioctlsocket( handle,<br>                          FIONBIO,<br>                          &amp;nonBlocking ) != 0 )<br>        {<br>            printf( &quot;failed to set non-blocking\n&quot; );<br>            return false;<br>        }<br><br>    #endif<br></code></pre><br><p>Windows does not provide the &ldquo;fcntl&rdquo; function, so we use the &ldquo;ioctlsocket&rdquo; function instead.</p><br><h2 id="sending-packets">Sending packets</h2><br><p>UDP is a connectionless protocol, so each time you send a packet you must specify the destination address. This means you can use one UDP socket to send packets to any number of different IP addresses, there&rsquo;s no single computer at the other end of your UDP socket that you are connected to.</p><br><p>Here&rsquo;s how to send a packet to a specific address:</p><br><pre><code>    int sent_bytes =<br>        sendto( handle,<br>                (const char)packet_data,<br>                packet_size,<br>                0,<br>                (sockaddr<em>)&amp;address,<br>                sizeof(sockaddr_in) );<br><br>    if ( sent_bytes != packet_size )<br>    {<br>        printf( &quot;failed to send packet\n&quot; );<br>        return false;<br>    }<br></em></code></pre><br><p>Important! The return value from &ldquo;sendto&rdquo; only indicates if the packet was successfully sent from the local computer. It does <em>not</em> tell you whether or not the packet was received by the destination computer. UDP has no way of knowing whether or not the the packet arrived at its destination!</p><br><p>In the code above we pass a &ldquo;sockaddr_in&rdquo; structure as the destination address. How do we setup one of these structures?</p><br><p>Let&rsquo;s say we want to send to the address 207.45.186.98:30000</p><br><p>Starting with our address in this form:</p><br><pre><code>    unsigned int a = 207;<br>    unsigned int b = 45;<br>    unsigned int c = 186;<br>    unsigned int d = 98;<br>    unsigned short port = 30000;<br></code></pre><br><p>We have a bit of work to do to get it in the form required by &ldquo;sendto&rdquo;:</p><br><pre><code>    unsigned int address = ( a &lt;&lt; 24 ) |<br>                           ( b &lt;&lt; 16 ) |<br>                           ( c &lt;&lt; 8  ) |<br>                             d;<br><br>    sockaddr_in addr;<br>    addr.sin_family = AF_INET;<br>    addr.sin_addr.s_addr = htonl( address );<br>    addr.sin_port = htons( port );<br></code></pre><br><p>As you can see, we first combine the a,b,c,d values in range [0,255] into a single unsigned integer, with each byte of the integer now corresponding to the input values. We then initialize a &ldquo;sockaddr_in&rdquo; structure with the integer address and port, making sure to convert our integer address and port values from host byte order to network byte order using &ldquo;htonl&rdquo; and &ldquo;htons&rdquo;.</p><br><p>Special case: if you want to send a packet to yourself, there&rsquo;s no need to query the IP address of your own machine, just pass in the loopback address 127.0.0.1 and the packet will be sent to your local machine.</p><br><h2 id="receiving-packets">Receiving packets</h2><br><p>Once you have a UDP socket bound to a port, any UDP packets sent to your sockets IP address and port are placed in a queue. To receive packets just loop and call &ldquo;recvfrom&rdquo; until it fails with EWOULDBLOCK indicating there are no more packets to receive.</p><br><p>Since UDP is connectionless, packets may arrive from any number of different computers. Each time you receive a packet &ldquo;recvfrom&rdquo; gives you the IP address and port of the sender, so you know where the packet came from.</p><br><p>Here&rsquo;s how to loop and receive all incoming packets:</p><br><pre><code>    while ( true )<br>    {<br>        unsigned char packet_data[256];<br><br>        unsigned int max_packet_size =<br>            sizeof( packet_data );<br><br>        #if PLATFORM == PLATFORM_WINDOWS<br>        typedef int socklen_t;<br>        #endif<br><br>        sockaddr_in from;<br>        socklen_t fromLength = sizeof( from );<br><br>        int bytes = recvfrom( socket,<br>                              (char)packet_data,<br>                              max_packet_size,<br>                              0,<br>                              (sockaddr<em>)&amp;from,<br>                              &amp;fromLength );<br><br>        if ( bytes &lt;= 0 )<br>            break;<br><br>        unsigned int from_address =<br>            ntohl( from.sin_addr.s_addr );<br><br>        unsigned int from_port =<br>            ntohs( from.sin_port );<br><br>        // process received packet<br>    }<br></em></code></pre><br><p>Any packets in the queue larger than your receive buffer will be silently discarded. So if you have a 256 byte buffer to receive packets like the code above, and somebody sends you a 300 byte packet, the 300 byte packet will be dropped. You <em>will not</em> receive just the first 256 bytes of the 300 byte packet.</p><br><p>Since you are writing your own game network protocol, this is no problem at all in practice, just make sure your receive buffer is big enough to receive the largest packet your code could possibly send.</p><br><h2 id="destroying-a-socket">Destroying a socket</h2><br><p>On most unix-like platforms, sockets are file handles so you use the standard file &ldquo;close&rdquo; function to clean up sockets once you are finished with them. However, Windows likes to be a little bit different, so we have to use &ldquo;closesocket&rdquo; instead:</p><br><pre>#if PLATFORM == PLATFORM_MAC ||<br>    PLATFORM == PLATFORM_UNIX<br>close( socket );<br>#elif PLATFORM == PLATFORM_WINDOWS<br>closesocket( socket );<br>#endif</pre><br><p>Hooray windows.</p><br><h2 id="socket-class">Socket class</h2><br><p>So we&rsquo;ve covered all the basic operations: creating a socket, binding it to a port, setting it to non-blocking, sending and receiving packets, and destroying the socket.</p><br><p>But you&rsquo;ll notice most of these operations are slightly platform dependent, and it&rsquo;s pretty annoying to have to remember to #ifdef and do platform specifics each time you want to perform socket operations.</p><br><p>We&rsquo;re going to solve this by wrapping all our socket functionality up into a &ldquo;Socket&rdquo; class. While we&rsquo;re at it, we&rsquo;ll add an &ldquo;Address&rdquo; class to make it easier to specify internet addresses. This avoids having to manually encode or decode a &ldquo;sockaddr_in&rdquo; structure each time we send or receive packets.</p><br><p>So let&rsquo;s add a socket class:</p><br><pre><code>    class Socket<br>    {<br>    public:<br><br>        Socket();<br><br>        ~Socket();<br><br>        bool Open( unsigned short port );<br><br>        void Close();<br><br>        bool IsOpen() const;<br><br>        bool Send( const Address &amp; destination,<br>                   const void  data,<br>                   int size );<br><br>        int Receive( Address &amp; sender,<br>                     void * data,<br>                     int size );<br><br>    private:<br><br>        int handle;<br>    };<br></code></pre><br><p>and an address class:</p><br><pre><code>    class Address<br>    {<br>    public:<br><br>        Address();<br><br>        Address( unsigned char a,<br>                 unsigned char b,<br>                 unsigned char c,<br>                 unsigned char d,<br>                 unsigned short port );<br><br>        Address( unsigned int address,<br>                 unsigned short port );<br><br>        unsigned int GetAddress() const;<br><br>        unsigned char GetA() const;<br>        unsigned char GetB() const;<br>        unsigned char GetC() const;<br>        unsigned char GetD() const;<br><br>        unsigned short GetPort() const;<br><br>    private:<br><br>        unsigned int address;<br>        unsigned short port;<br>    };<br></code></pre><br><p>Here&rsquo;s how to to send and receive packets with these classes:</p><br><pre><code>    // create socket<br><br>    const int port = 30000;<br><br>    Socket socket;<br><br>    if ( !socket.Open( port ) )<br>    {<br>        printf( &quot;failed to create socket!\n&quot; );<br>        return false;<br>    }<br><br>    // send a packet<br><br>    const char data[] = &quot;hello world!&quot;;<br><br>    socket.Send( Address(127,0,0,1,port), data, sizeof( data ) );<br><br>    // receive packets<br><br>    while ( true )<br>    {<br>        Address sender;<br>        unsigned char buffer[256];<br>        int bytes_read =<br>            socket.Receive( sender,<br>                            buffer,<br>                            sizeof( buffer ) );<br>        if ( !bytes_read )<br>            break;<br><br>        // process packet<br>    }<br></code></pre><br><p>As you can see it&rsquo;s much simpler than using BSD sockets directly.</p><br><p>As an added bonus the code is the same on all platforms because everything platform specific is handled inside the socket and address classes.</p><br><h2 id="conclusion">Conclusion</h2><br><p>You now have a platform independent way to send and receive packets. <em>Enjoy</em> :)</p>

<h1 id="è¯‘æ–‡"><a href="#è¯‘æ–‡" class="headerlink" title="è¯‘æ–‡"></a>è¯‘æ–‡</h1><p><a href="http://gad.qq.com/program/translateview/7165089" target="_blank" rel="noopener">è¯‘æ–‡å‡ºå¤„</a></p>
<div style="display:none"><br><br><!--     æŠŠä¸‹æ–‡ä¸­çš„ $hhd$ æ”¹ä¸º <h å°±å¯ä»¥æ¢å¤åŸçŠ¶, å½“æ—¶æŠŠ <h æ”¹ä¸º $hhd$ æ˜¯ä¸ºäº†é˜²æ­¢ç”Ÿæˆtoc      --><br><br>å› è¯‘æ–‡å¾ˆå¤šåœ°æ–¹å‡æœ‰ç–æ¼, æœ¬æ–‡å·²ç»å¯¹éƒ¨åˆ†ç–æ¼åšäº†ä¿®æ­£.<br><br><div class="WordSection1"><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç¿»è¯‘ï¼šæ¨å˜‰é‘«ï¼ˆçŸ«æƒ…åˆ°æ­»çš„ä»“é¼ å›ï¼Œ</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼‰å®¡æ ¡ï¼šèµµèèï¼ˆè½©è¯­è½©ç¼˜ï¼‰</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åºè¨€</span><span style="font-size:9.0pt;line-height:240%"> </span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯</span><span>Glenn Fiedler</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼Œæ¬¢è¿é˜…è¯»ã€Š</span><span><a rel="noopener" href="http://gafferongames.com/networking-for-game-programmers/" title="é’ˆå¯¹æ¸¸æˆç¨‹åºå‘˜çš„ç½‘ç»œçŸ¥è¯†" target="_blank"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#383838;text-decoration:none"><span>é’ˆå¯¹æ¸¸æˆç¨‹åºå‘˜çš„ç½‘ç»œçŸ¥è¯†</span></span></a></span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ã€‹ç³»åˆ—æ•™ç¨‹çš„ç¬¬äºŒç¯‡æ–‡ç« ã€‚</span><span style="color: rgb(51, 51, 51);"> </span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åœ¨å‰é¢çš„æ–‡ç« ä¸­æˆ‘ä»¬è®¨è®ºäº†åœ¨ä¸åŒè®¡ç®—æœºä¹‹é—´å‘é€æ•°æ®çš„æ–¹æ³•ï¼Œå¹¶å†³å®šä½¿ç”¨</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è€Œé</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ä¼ è¾“æ§åˆ¶åè®®ï¼ˆ</span><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#333333">TCP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ã€‚æˆ‘ä»¬ä¹‹æ‰€ä»¥ä½¿ç”¨</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼Œæ˜¯å› ä¸ºå®ƒèƒ½å¤Ÿä½¿æ•°æ®åœ¨ä¸ç­‰å¾…é‡å‘åŒ…è€Œé€ æˆæ•°æ®èšé›†çš„æƒ…å†µä¸‹æŒ‰æ—¶è¢«é€è¾¾ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç°åœ¨æˆ‘å°†è¦å‘Šè¯‰å„ä½å¦‚ä½•ä½¿ç”¨</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å‘é€å’Œæ¥æ”¶æ•°æ®åŒ…ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä¼¯å…‹åˆ©å¥—æ¥å­—</span><span style="font-size:9.0pt;line-height:240%"> </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼ˆ</span><span>BSD socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼‰</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¯¹äºå¤§å¤šæ•°ç°ä»£çš„å¹³å°æ¥è¯´ä½ éƒ½å¯ä»¥æ‰¾åˆ°å»ºç«‹åœ¨ä¼¯å…‹åˆ©å¥—æ¥å­—ä¸Šçš„</span><span>sockets</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ã€‚ä¼¯å…‹åˆ©å¥—æ¥å­—ä¸»è¦é€šè¿‡</span><span style="font-family:&quot;Lucida Sans Unicode&quot;,&quot;sans-serif&quot;;color:#222222">â€œsocketâ€,â€œbindâ€, â€œsendtoâ€ and â€œrecvfr</span><span>omâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å‡ ä¸ªç®€å•å‡½æ•°è¿›è¡Œæ§åˆ¶ã€‚å¦‚æœä½ æ„¿æ„çš„è¯ä½ å½“ç„¶å¯ä»¥ç›´æ¥å¯¹è¿™å‡ ä¸ªå‡½æ•°è¿›è¡Œè°ƒç”¨ï¼Œä½†æ˜¯ç”±äºæ¯ä¸ªå¹³å°ä¹‹é—´æœ‰ç»†å¾®å·®åˆ«ï¼Œä¿æŒä»£ç å¹³å°çš„ç‹¬ç«‹æ€§å°†ä¼šå˜å¾—æœ‰äº›å›°éš¾ã€‚å› æ­¤ï¼Œå°½ç®¡æˆ‘å°†å…ˆç»™å„ä½ä»‹ç»ä¼¯å…‹åˆ©å¥—æ¥å­—çš„ç¤ºä¾‹ä»£ç ç”¨ä»¥è¯´æ˜å®ƒçš„åŸºæœ¬ä½¿ç”¨åŠŸèƒ½ï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¼šå¤§é‡çš„ç›´æ¥ä½¿ç”¨ä¼¯å…‹åˆ©å¥—æ¥å­—ã€‚æ‰€ä»¥å½“æˆ‘ä»¬æŒæ¡äº†æ‰€æœ‰åŸºç¡€</span><span>socket </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åŠŸèƒ½åï¼Œæˆ‘ä»¬å°†ä¼šæŠŠæ‰€æœ‰å†…å®¹æ±‡æ€»åˆ°ä¸€ä¸ªç³»åˆ—çš„è¯¾ä¸­ï¼Œä»¥ä¾¿ä½ å¯ä»¥è½»æ¾åœ°ç¼–å†™ä»£ç ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¹³å°çš„ç‰¹æ®Šæ€§</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">é¦–å…ˆ</span> <span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æˆ‘ä»¬å…ˆå»ºç«‹<span style="border:none windowtext 1.0pt;padding:0cm">ä¸€ä¸ªâ€œ</span></span><span style="border:none windowtext 1.0pt;padding:0cm">define</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€ç¨‹åºç”¨</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¥æµ‹è¯•æˆ‘ä»¬ç°æœ‰çš„å¹³å°æ˜¯ä»€ä¹ˆï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å‘ç°ä¸åŒå¹³å°é—´é—´å„ä¸ª</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">é‡Œçš„ç»†å¾®å·®åˆ«ã€‚</span></span></p><div><div id="highlighter_477809" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// platform detection</code></div><div class="line number2 index1 alt1"> </div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#define PLATFORM_WINDOWS  1</code></div><div class="line number4 index3 alt1"> </div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#define PLATFORM_MAC      2</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp preprocessor">#define PLATFORM_UNIX     3</code></div><div class="line number8 index7 alt1"> </div><div class="line number9 index8 alt2"><code class="cpp preprocessor">#if defined(_WIN32)</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp preprocessor">#define PLATFORM PLATFORM_WINDOWS</code></div><div class="line number12 index11 alt1"> </div><div class="line number13 index12 alt2"><code class="cpp preprocessor">#elif defined(<strong>APPLE</strong>)</code></div><div class="line number14 index13 alt1"> </div><div class="line number15 index14 alt2"><code class="cpp preprocessor">#define PLATFORM PLATFORM_MAC</code></div><div class="line number16 index15 alt1"> </div><div class="line number17 index16 alt2"><code class="cpp preprocessor">#else</code></div><div class="line number18 index17 alt1"> </div><div class="line number19 index18 alt2"><code class="cpp preprocessor">#define PLATFORM PLATFORM_UNIX</code></div><div class="line number20 index19 alt1"> </div><div class="line number21 index20 alt2"><code class="cpp preprocessor">#endif</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¥ä¸‹æ¥æˆ‘ä»¬ä¸º</span><span>sockets</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å†™å…¥é€‚å½“çš„æ ‡å¤´ï¼Œç”±äºå¤´æ–‡ä»¶å…·æœ‰å¹³å°çš„ç‰¹æ®Šæ€§æ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨â€œ</span><span>#define</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">â€æ¥æ ¹æ®ä¸åŒçš„å¹³å°å¼•ç”¨ä¸åŒçš„æ–‡ä»¶ã€‚</span></span></p><div><div id="highlighter_806491" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#if PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number2 index1 alt1"> </div><div class="line number3 index2 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#include &lt;winsock2.h&gt;</code></div><div class="line number4 index3 alt1"> </div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#elif PLATFORM == PLATFORM_MAC ||</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp spaces">      </code><code class="cpp plain">PLATFORM == PLATFORM_UNIX</code></div><div class="line number8 index7 alt1"> </div><div class="line number9 index8 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#include &lt;sys socket.h=â€â€&gt;</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#include &lt;netinet in.h=â€â€&gt;</code></div><div class="line number12 index11 alt1"> </div><div class="line number13 index12 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#include &lt;fcntl.h&gt;</code></div><div class="line number14 index13 alt1"> </div><div class="line number15 index14 alt2"><code class="cpp preprocessor">#endif&lt;/fcntl.h&gt;&lt;/netinet&gt;&lt;/sys&gt;&lt;/winsock2.h&gt;</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¦‚æœ</span><span>sockets</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ˜¯å»ºç«‹åœ¨</span><span>unix</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¹³å°ä¸Šï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ä»»ä½•å…¶ä»–å¤šä½™çš„è¿æ¥ï¼Œè‹¥å®ƒæ˜¯å»ºç«‹åœ¨</span><span>windows</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç³»ç»Ÿé‡Œï¼Œä¸ºäº†ç¡®ä¿</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ­£å¸¸ä½¿ç”¨æˆ‘ä»¬å°±éœ€è¦è¿æ¥åˆ°â€œ</span><span>winsock</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">â€åº“å†…ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><span style="font-size:medium;">ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„æŠ€å·§ï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜å·²æœ‰é¡¹ç›®æˆ–ç”Ÿæˆæ–‡ä»¶çš„å‰æä¸‹å®Œæˆä¸Šè¿°å·¥ä½œã€‚</span></span></p><div><div id="highlighter_251577" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#if PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number2 index1 alt1"> </div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#pragma comment( lib, â€œwsock32.libâ€ )</code></div><div class="line number4 index3 alt1"> </div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#endif</code></div></div></td></tr></table></div></div><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><br></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æˆ‘ä¹‹æ‰€ä»¥éå¸¸å–œæ¬¢è¿™ä¸ªå°æŠ€å·§æ˜¯å› ä¸ºæˆ‘å¤ªæ‡’äº†</span><span>~</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å½“ç„¶å•¦ï¼Œå¦‚æœä½ æ„¿æ„æ¯æ¬¡éƒ½è¿›è¡Œé¡¹ç›®é“¾æ¥æˆ–ç”Ÿæˆæ–‡ä»¶ä¹Ÿæœªå°ä¸å¯ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></p>$hhd$1&gt;<span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å±‚çš„åˆå§‹åŒ–</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¤§å¤šæ•°â€œ</span><span>unix-like</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">â€çš„å¹³å°</span><span> (</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åŒ…æ‹¬</span><span>macosx) </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ˜¯ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šçš„æ­¥éª¤å»åˆå§‹åŒ–</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å±‚çš„ã€‚ä½†æ˜¯</span><span>Windows</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">éœ€è¦è¿›è¡Œä¸€äº›ç‰¹æ®Šè®¾ç½®æ¥ç¡®ä¿ä½ çš„</span><span>sockets</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä»£ç æ­£å¸¸å·¥ä½œã€‚åœ¨ä½ ä½¿ç”¨å…¶ä»–ä»»ä½•</span><span>sockets</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åŠŸèƒ½å‰ä½ å¿…é¡»å…ˆè°ƒç”¨</span><span> â€œWSAStartupâ€ </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¥åˆå§‹åŒ–å®ƒä»¬ï¼Œåœ¨ä½ çš„ç¨‹åºæ®µç»“æŸæ—¶ä½ ä¹Ÿå¿…é¡»ä½¿ç”¨</span><span> â€œWSACleanupâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¥ç»“æŸã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><span style="font-size:medium;">ä¸‹é¢è®©æˆ‘ä»¬æ¥æ·»åŠ ä»¥ä¸Šä¸¤ä¸ªæ–°åŠŸèƒ½ï¼š</span></span></p><div><div id="highlighter_446190" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">bool</code> <code class="cpp plain">InitializeSockets()</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#if PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number4 index3 alt1"> </div><div class="line number5 index4 alt2"><code class="cpp spaces">    </code><code class="cpp plain">WSADATA WsaData;</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp plain">WSAStartup( MAKEWORD(2,2), &amp;WsaData ) == NO_ERROR;</code></div><div class="line number7 index6 alt2"> </div><div class="line number8 index7 alt1"><code class="cpp spaces">    </code><code class="cpp preprocessor">#else</code></div><div class="line number9 index8 alt2"> </div><div class="line number10 index9 alt1"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">true</code><code class="cpp plain">;</code></div><div class="line number11 index10 alt2"> </div><div class="line number12 index11 alt1"><code class="cpp spaces">    </code><code class="cpp preprocessor">#endif</code></div><div class="line number13 index12 alt2"><code class="cpp plain">}</code></div><div class="line number14 index13 alt1"> </div><div class="line number15 index14 alt2"> </div><div class="line number16 index15 alt1"> </div><div class="line number17 index16 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">ShutdownSockets()</code></div><div class="line number18 index17 alt1"><code class="cpp plain">{</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#if PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number20 index19 alt1"> </div><div class="line number21 index20 alt2"><code class="cpp spaces">    </code><code class="cpp plain">WSACleanup();</code></div><div class="line number22 index21 alt1"> </div><div class="line number23 index22 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#endif</code></div><div class="line number24 index23 alt1"><code class="cpp plain">}</code></div></div></td></tr></table></div></div><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><br></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªåˆå§‹åŒ–</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å±‚çš„æ–¹æ³•ã€‚å¯¹äºé‚£äº›ä¸éœ€è¦</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åˆå§‹åŒ–çš„å¹³å°æ¥è¯´è¿™äº›åŠŸèƒ½å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å»ºç«‹ä¸€ä¸ª</span><span>socket</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç°åœ¨æ˜¯æ—¶å€™æ¥å»ºç«‹ä¸€ä¸ªåŸºäº</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼‰çš„</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">äº†ï¼Œä¸‹é¢æ˜¯å®æ–½çš„æ–¹æ³•ï¼š</span></span></p><div><div id="highlighter_572686" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">handle = socket( AF_INET, SOCK_DGRAM,IPPROTO_UDP );</code></div><div class="line number2 index1 alt1"> </div><div class="line number3 index2 alt2"><code class="cpp keyword bold">if</code> <code class="cpp plain">( handle &lt;= 0 )</code></div><div class="line number4 index3 alt1"><code class="cpp plain">{</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">    </code><code class="cpp functions bold">printf</code><code class="cpp plain">( </code><code class="cpp string">â€œfailed to create socket\nâ€</code> <code class="cpp plain">);</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number8 index7 alt1"><code class="cpp plain">}</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼‰çš„</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¯¹åº”åˆ°ä¸€ä¸ªç«¯å£ä¸Šï¼ˆæ¯”å¦‚</span><span>30000</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è¿™ä¸ªç«¯å£ï¼‰ã€‚æ¯ä¸€ä¸ª</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">éƒ½å¿…é¡»å¯¹åº”åˆ°ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç«¯å£ä¸Šã€‚è¿™ä¹ˆåšçš„åŸå› æ˜¯ç«¯å£å·å†³å®šäº†æ¯ä¸ªæ•°æ®åŒ…å‘é€åˆ°çš„ä½ç½®ã€‚ä¸è¦ä½¿ç”¨</span><span>1024</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä»¥ä¸‹çš„ç«¯å£ï¼Œå› ä¸ºè¿™æ˜¯ä¸ºç³»ç»Ÿè°ƒç”¨æ‰€é¢„ç•™çš„ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå¦‚</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333;display:none">æœä½ ä¸åœ¨ä¹</span><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#333333;display:none">socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333;display:none">æŒ‡å®šåˆ°å“ªä¸ªç«¯å£ä¸Šï¼Œä½ å°±</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¯ä»¥è¾“å…¥â€œ</span><span>0</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">â€ï¼Œè¿™æ ·ç³»ç»Ÿå°†ä¼šè‡ªåŠ¨ä¸ºä½ é€‰æ‹©ä¸€ä¸ªé—²ç½®çš„ç«¯å£ã€‚</span></span></p><div><div id="highlighter_845519" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">sockaddr_in address;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">address.sin_family = AF_INET;</code></div><div class="line number3 index2 alt2"><code class="cpp plain">address.sin_addr.s_addr = INADDR_ANY;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">address.sin_port = htons( (unsigned </code><code class="cpp color1 bold">short</code><code class="cpp plain">) port );</code></div><div class="line number5 index4 alt2"> </div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp keyword bold">if</code> <code class="cpp plain">( bind( handle, (</code><code class="cpp keyword bold">const</code> <code class="cpp plain">sockaddr<em>) &amp;address, </em></code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(sockaddr_in) ) &lt; 0 )</code></div><div class="line number8 index7 alt1"><code class="cpp plain">{</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">    </code><code class="cpp functions bold">printf</code><code class="cpp plain">( </code><code class="cpp string">â€œfailed to bind socket\nâ€</code> <code class="cpp plain">);</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number12 index11 alt1"><code class="cpp plain">}</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è¿™æ ·æˆ‘ä»¬çš„</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å·²ç»å‡†å¤‡å°±ç»ªå¹¶å¯ä»¥å‘é€å’Œæ¥æ”¶åŒ…äº†ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">é‚£ä¹ˆä¸Šé¢æåˆ°çš„</span><span>â€œhtonsâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ˜¯èµ·ä»€ä¹ˆä½œç”¨</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333;display:none">å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½ï¼Œå®ƒå°†ä¸€ä¸ª</span><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#333333;display:none">16</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333;display:none">ä½æ•´æ•°çš„å€¼ç”±ä¸»æœºå­—èŠ‚åºåˆ—ï¼ˆå°ç«¯æˆ–å¤§ç«¯ï¼‰è½¬æ¢æˆç½‘ç»œå­—èŠ‚åºåˆ—ï¼ˆå¤§ç«¯ï¼‰ã€‚</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è¿™å°±è¦æ±‚ä½ åœ¨ä»»ä½•æ—¶å€™éƒ½ç›´æ¥åœ¨</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç»“æ„é‡Œè®¾ç½®æ•´æ•°æ•°å­—ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ä½ ä¼šçœ‹åˆ°</span><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#333333">â€œhtonsâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼ˆä¸»æœºåˆ°ç½‘ç»œçŸ­å­—èŠ‚ï¼‰åŠå…¶</span><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#333333">32</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ä½æ•´æ•°å¤§å°çš„è¡¨å…„å¦¹â€htonlâ€</span><span style="font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#333333"></span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼ˆä¸»æœºåˆ°ç½‘ç»œé•¿å­—èŠ‚ï¼‰è¿™åœ¨è¿™ç¯‡æ–‡ç« ä¸­è¢«å¤šæ¬¡ä½¿ç”¨ï¼Œä½ ç•™æ„äº†ä»¥åä½ åœ¨ä¸‹æ–‡ä¸­å†æ¬¡é‡åˆ°å°±ä¼šæ˜ç™½ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333"><br></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å°†</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è®¾ç½®ä¸ºéé˜»å¡å½¢å¼</span><span>            </span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span> </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">é»˜è®¤æƒ…å†µä¸‹ï¼Œ</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ˜¯è¢«è®¾ç½®åœ¨</span><span> â€œ</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">é˜»å¡æ¨¡å¼</span><span>â€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">çš„çŠ¶æ€ä¸‹ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨</span><span>â€œrecvfromâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åŠŸèƒ½è¯»ä¸€ä¸ªåŒ…ï¼Œåœ¨ä¸€ä¸ªæ•°æ®åŒ…è¢«è¯»å–å‰è¯¥å‡½æ•°å€¼å°†ä¸èƒ½è¢«è¿”å›ã€‚è¿™ä¸æˆ‘ä»¬çš„ç›®æ ‡å®Œå…¨ä¸ç¬¦ã€‚è§†é¢‘æ¸¸æˆæ˜¯æ‹Ÿæ€åœ¨</span><span>30</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æˆ–</span><span>60</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å¸§æ¯ç§’å®æ—¶çš„ç¨‹åºï¼Œä»–ä»¬ä¸èƒ½åªæ˜¯ååœ¨é‚£é‡Œç­‰å¾…æ•°æ®åŒ…çš„åˆ°è¾¾ï¼</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è§£å†³æ–¹æ¡ˆæ˜¯ä½ å°†</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è½¬æ¢æˆä»¥</span><span>â€œ</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">éé˜»å¡æ¨¡å¼</span><span>â€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åå†åˆ›å»ºä»–ä»¬ã€‚ä¸€æ—¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå½“æ²¡æœ‰åŒ…å¯ä¾›é˜…è¯»æ—¶ï¼Œ</span><span>â€œrecvfromâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å‡½æ•°å°±å¯ä»¥ç«‹<span style="border:none windowtext 1.0pt;padding:0cm">å³è¿”å›ï¼Œè¿”å›å€¼æ˜¾ç¤ºä½ åº”è¯¥ç¨åå†å°è¯•è¯»å–åŒ…ã€‚</span></span><span style="border:none windowtext 1.0pt;padding:0cm"> </span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä¸‹é¢æ˜¯å¦‚ä½•å°†</span><span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">è®¾ç½®ä¸ºéé˜»å¡æ¨¡å¼çš„æ–¹æ³•ï¼š</span></span></p><div><div id="highlighter_979158" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#if PLATFORM == PLATFORM_MAC || PLATFORM == PLATFORM_UNIX</code></div><div class="line number2 index1 alt1"> </div><div class="line number3 index2 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">nonBlocking = 1;</code></div><div class="line number4 index3 alt1"><code class="cpp keyword bold">if</code> <code class="cpp plain">( fcntl( handle, F_SETFL, O_NONBLOCK, nonBlocking ) == -1 )</code></div><div class="line number5 index4 alt2"><code class="cpp plain">{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">    </code><code class="cpp functions bold">printf</code><code class="cpp plain">( </code><code class="cpp string">â€œfailed to set non-blocking\nâ€</code> <code class="cpp plain">);</code></div><div class="line number7 index6 alt2"> </div><div class="line number8 index7 alt1"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp preprocessor">#elif PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number12 index11 alt1"><code class="cpp color1 bold">DWORD</code> <code class="cpp plain">nonBlocking = 1;</code></div><div class="line number13 index12 alt2"><code class="cpp keyword bold">if</code> <code class="cpp plain">( ioctlsocket( handle, FIONBIO, &amp;nonBlocking ) != 0 )</code></div><div class="line number14 index13 alt1"><code class="cpp plain">{</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">    </code><code class="cpp functions bold">printf</code><code class="cpp plain">( </code><code class="cpp string">â€œfailed to set non-blocking\nâ€</code> <code class="cpp plain">);</code></div><div class="line number16 index15 alt1"> </div><div class="line number17 index16 alt2"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number18 index17 alt1"><code class="cpp plain">}</code></div><div class="line number19 index18 alt2"> </div><div class="line number20 index19 alt1"><code class="cpp preprocessor">#endif</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä»ä¸Šé¢çš„ç¨‹åºæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ</span><span>Windows</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æœ¬èº«å¹¶ä¸æä¾›</span><span>â€œ</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¡†æ¶</span><span>â€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨</span><span>â€œioctlsocketâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åŠŸèƒ½æ¥å®ç°ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><br></span></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å‘é€æ•°æ®åŒ…</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ˜¯ä¸€ç§æ— è¿æ¥åè®®ï¼Œæ‰€ä»¥æ¯æ¬¡ä½ å‘é€ä¸€ä¸ªæ•°æ®åŒ…å‰éƒ½è¦æŒ‡å®šä¸€ä¸ªç›®çš„åœ°å€ã€‚ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å‘é€æ•°æ®åŒ…åˆ°ä»»æ„æ•°é‡çš„ä¸åŒçš„</span><span>IP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åœ°å€ï¼Œè€Œåœ¨ä½ </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ï¼‰</span> <span>socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">çš„å¦ä¸€ç«¯å¹¶æ²¡æœ‰è¿æ¥æŸä¸€å°è®¡ç®—æœºã€‚</span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸‹é¢æ˜¯å¦‚ä½•å‘é€ä¸€ä¸ªæ•°æ®åŒ…åˆ°ä¸€ä¸ªç‰¹å®šçš„åœ°å€æ–¹æ³•ï¼š</span></p><div><div id="highlighter_169965" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">int</code> <code class="cpp plain">sent_bytes = </code><code class="cpp plain">sendto( handle,</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">            </code><code class="cpp plain">(</code><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">char</code><code class="cpp plain">)packet_data,</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">            </code><code class="cpp plain">packet_size,</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">            </code><code class="cpp plain">0,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">            </code><code class="cpp plain">(sockaddr<em>)&amp;address,</em></code></div><div class="line number7 index6 alt2"><code class="cpp spaces">            </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">(sockaddr_in) );</code></div><div class="line number8 index7 alt1"> </div><div class="line number9 index8 alt2"><code class="cpp keyword bold">if</code> <code class="cpp plain">( sent_bytes != packet_size )</code></div><div class="line number10 index9 alt1"><code class="cpp plain">{</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">    </code><code class="cpp functions bold">printf</code><code class="cpp plain">( </code><code class="cpp string">â€œfailed to send packet\nâ€</code> <code class="cpp plain">);</code></div><div class="line number12 index11 alt1"> </div><div class="line number13 index12 alt2"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number14 index13 alt1"><code class="cpp plain">}</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼â€œ</span><span style="border:none windowtext 1.0pt;padding:0cm">sendtoâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">çš„è¿”å›å€¼åªæ˜¯è¡¨æ˜æ•°æ®åŒ…æ˜¯å¦è¢«æˆåŠŸåœ°ä»æœ¬åœ°è®¡ç®—æœºå‘é€ï¼Œå®ƒå¹¶ä¸èƒ½è¡¨æ˜ç›®æ ‡è®¡ç®—æœºæ˜¯å¦æˆåŠŸæ¥æ”¶åˆ°ä½ çš„æ•°æ®åŒ…ï¼ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span style="border:none windowtext 1.0pt;padding:0cm">UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ï¼‰æ²¡æœ‰åŠæ³•çŸ¥é“æ•°æ®åŒ…æ˜¯å¦èƒ½åˆ°è¾¾ç›®çš„åœ°ã€‚</span><span style="border:none windowtext 1.0pt;padding:0cm">             </span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€š<span style="border:none windowtext 1.0pt;padding:0cm">è¿‡</span></span><span style="border:none windowtext 1.0pt;padding:0cm">â€œsockaddr_inâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç»“æ„ä¸ºç›®çš„åœ°å€ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><span style="font-size:medium;">é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è®¾ç½®è¿™äº›ç»“æ„å‘¢ï¼Ÿ</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç°åœ¨è®©æˆ‘ä»¬ä»¥å‘é€åˆ°</span><span style="border:none windowtext 1.0pt;padding:0cm">207.45.186.98:30000 </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">è¿™ä¸ªåœ°å€ä¸ºä¾‹</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><span style="font-size:medium;">æˆ‘ä»¬ä»ä»¥ä¸‹è¿™ä¸ªç¨‹åºå¼€å§‹ï¼š</span></span></p><div><div id="highlighter_656029" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">a = 207;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">b = 45;</code></div><div class="line number3 index2 alt2"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">c = 186;</code></div><div class="line number4 index3 alt1"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">d = 98;</code></div><div class="line number5 index4 alt2"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">short</code> <code class="cpp plain">port = 30000;</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp plain">æˆ‘ä»¬è¿˜è¦åœ¨å½¢å¼ä¸Šè¿›è¡Œè®¾ç½®ä»è€Œç¬¦åˆâ€œsendtoâ€çš„è¦æ±‚ï¼š</code></div><div class="line number8 index7 alt1"><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">address = ( a &lt;&lt; 24 ) |</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">                       </code><code class="cpp plain">( b &lt;&lt; 16 ) |</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">                       </code><code class="cpp plain">( c &lt;&lt; 8  ) | d;</code></div><div class="line number11 index10 alt2"> </div><div class="line number12 index11 alt1"> </div><div class="line number13 index12 alt2"><code class="cpp plain">sockaddr_in addr;</code></div><div class="line number14 index13 alt1"><code class="cpp plain">addr.sin_family = AF_INET;</code></div><div class="line number15 index14 alt2"><code class="cpp plain">addr.sin_addr.s_addr = htonl( address );</code></div><div class="line number16 index15 alt1"><code class="cpp plain">addr.sin_port = htons( port );</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬é¦–å…ˆå°†</span><span style="border:none windowtext 1.0pt;padding:0cm">A</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ã€</span><span style="border:none windowtext 1.0pt;padding:0cm">B</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ã€</span><span style="border:none windowtext 1.0pt;padding:0cm">C</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ã€</span><span style="border:none windowtext 1.0pt;padding:0cm">D</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å€¼åœ¨èŒƒå›´[ 0, 255 ]å†…çš„å€¼</span><span style="border:none windowtext 1.0pt;padding:0cm"></span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">è½¬åŒ–ä¸ºä¸€ä¸ªå•ä¸€çš„æ— ç¬¦å·æ•´æ•°ï¼Œä»è€Œä½¿è¿™ä¸ªæ•´æ•°çš„æ¯ä¸ªå­—èŠ‚å¯¹åº”è¾“å…¥å€¼ã€‚ç„¶åä»¥æ•´æ•°åœ°å€å’Œç«¯å£æ¥åˆå§‹åŒ–ä¸€ä¸ª</span><span style="border:none windowtext 1.0pt;padding:0cm">â€œsockaddr_inâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç»“æ„ï¼Œè¿™æ ·å°±ç¡®ä¿ä½¿ç”¨â€œ</span><span style="border:none windowtext 1.0pt;padding:0cm">htonlâ€ </span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å’Œ</span><span style="border:none windowtext 1.0pt;padding:0cm">â€œhtons</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€æ¥å°†æ•´å‹åœ°å€å’Œç«¯å£å€¼ä»ä¸»æœºå­—èŠ‚åºåˆ—è½¬æ¢ä¸ºä¸ºç½‘ç»œå­—èŠ‚åºåˆ—ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šå¦‚æœä½ æƒ³ç»™è‡ªå·±å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œä¸éœ€è¦æŸ¥è¯¢è‡ªå·±æœºå™¨çš„</span><span style="border:none windowtext 1.0pt;padding:0cm">IP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">åœ°å€ï¼Œåœ¨å›é€åœ°å€</span><span style="border:none windowtext 1.0pt;padding:0cm">127.0.0.1</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸­æ•°æ®åŒ…å°±å°†è¢«å‘é€åˆ°ä½ çš„æœ¬åœ°æœºå™¨ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><br></span></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ¥æ”¶æ•°æ®åŒ…</span> <p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸€æ—¦ä½ å°†ä¸€ä¸ª</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å¥—æ¥å­—ç»‘å®šåˆ°ä¸€ä¸ªç«¯å£ï¼Œä»»ä½•å‘é€åˆ°æ‚¨</span><span style="border:none windowtext 1.0pt;padding:0cm">scoket IP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">åœ°å€å’Œç«¯å£çš„</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">æ•°æ®åŒ…éƒ½å°†æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œã€‚æ¥æ”¶æ•°æ®åŒ…çš„è¯, åªéœ€è¦å¾ªç¯è°ƒç”¨</span><span style="border:none windowtext 1.0pt;padding:0cm"> <span>â€œrecvfromâ€</span></span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å‡½æ•°ç›´åˆ°ä»–å¤±è´¥å¹¶è¿”å›â€EWOULDBLOCKâ€ï¼Œè¿™å°±æ„å‘³ç€é˜Ÿåˆ—é‡Œæœ‰æ²¡æœ‰ç•™ä¸‹å…¶ä»–çš„æ•°æ®åŒ…äº†ã€‚ç”±äº</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">æ˜¯æ— è¿æ¥æ€§çš„ï¼Œæ•°æ®åŒ…å¯ä»¥åˆ°è¾¾è®¸å¤šä¸åŒçš„è®¡ç®—æœºã€‚æ¯å½“ä½ æ”¶åˆ°ä¸€ä¸ªæ•°æ®åŒ…ï¼Œ</span><span style="border:none windowtext 1.0pt;padding:0cm">â€œrecvfromâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">éƒ½ä¼šç»™ä½ å‘é€è€…çš„</span><span style="border:none windowtext 1.0pt;padding:0cm">IP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">åœ°å€å’Œç«¯å£ä»¥ä¾¿ä½ çŸ¥é“è¿™æ˜¯æ¥è‡ªå“ªé‡Œçš„æ•°æ®åŒ…ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><span style="font-size:medium;">ä¸‹é¢æ˜¯å¦‚ä½•è¿›è¡Œå¾ªç¯æ¥æ”¶ä¼ å…¥çš„æ•°æ®åŒ…çš„æ–¹æ³•ï¼š</span></span></p><div><div id="highlighter_421199" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">while</code> <code class="cpp plain">( </code><code class="cpp keyword bold">true</code> <code class="cpp plain">)</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">packet_data[256];</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">max_packet_size = </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">( packet_data );</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#if PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp spaces">    </code><code class="cpp keyword bold">typedef</code> <code class="cpp color1 bold">int</code> <code class="cpp plain">socklen_t;</code></div><div class="line number8 index7 alt1"> </div><div class="line number9 index8 alt2"><code class="cpp spaces">    </code><code class="cpp preprocessor">#endif</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp spaces">    </code><code class="cpp plain">sockaddr_in from;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">    </code><code class="cpp plain">socklen_t fromLength = </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">( from );</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">    </code><code class="cpp color1 bold">int</code> <code class="cpp plain">bytes = recvfrom( socket,</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">        </code><code class="cpp plain">(</code><code class="cpp color1 bold">char</code><code class="cpp plain">)packet_data,</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">        </code><code class="cpp plain">max_packet_size,</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">         </code><code class="cpp plain">0,</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">        </code><code class="cpp plain">(sockaddr<em>)&amp;from,</em></code></div><div class="line number18 index17 alt1"><code class="cpp spaces">        </code><code class="cpp plain">&amp;fromLength );</code></div><div class="line number19 index18 alt2"> </div><div class="line number20 index19 alt1"><code class="cpp spaces">    </code><code class="cpp keyword bold">if</code> <code class="cpp plain">( bytes &lt;= 0 )</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">        </code><code class="cpp keyword bold">break</code><code class="cpp plain">; </code></div><div class="line number22 index21 alt1"> </div><div class="line number23 index22 alt2"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">from_address = ntohl( from.sin_addr.s_addr );</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">from_port = ntohs( from.sin_port );</code></div><div class="line number25 index24 alt2"> </div><div class="line number26 index25 alt1"><code class="cpp spaces">    </code><code class="cpp comments">// process received packet</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">    </code> </div><div class="line number28 index27 alt1"><code class="cpp plain">}</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">åœ¨é˜Ÿåˆ—ä¸­ï¼Œæ•°æ®åŒ…ä¸€æ—¦å¤§äºä½ æ¥æ”¶ç¼“å†²åŒºçš„èŒƒå›´ï¼Œä»–ä»¬éƒ½ä¼šè¢«ç³»ç»Ÿæ‚„æ‚„èˆå¼ƒã€‚å› æ­¤ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ª</span><span style="border:none windowtext 1.0pt;padding:0cm">256</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å­—èŠ‚çš„ç¼“å†²åŒºç”¨æ¥æ¥æ”¶æ•°æ®åŒ…ï¼Œæœ‰äººç»™ä½ ä¸€ä¸ªå‘é€</span><span style="border:none windowtext 1.0pt;padding:0cm">300</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å­—èŠ‚çš„æ•°æ®åŒ…ï¼Œ</span><span style="border:none windowtext 1.0pt;padding:0cm">300</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å­—èŠ‚çš„æ•°æ®åŒ…éƒ½å°†è¢«åˆ é™¤ã€‚æ‚¨å°†ä¸ä¼šæ¥æ”¶åˆ°</span><span style="border:none windowtext 1.0pt;padding:0cm">300</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å­—èŠ‚æ•°æ®åŒ…çš„å‰</span><span style="border:none windowtext 1.0pt;padding:0cm">256</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸ªå­—èŠ‚ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><span style="font-size:medium;">å› ä¸ºæ‚¨æ­£åœ¨ç¼–å†™è‡ªå·±çš„æ¸¸æˆç½‘ç»œåè®®ï¼Œä»¥ä¸Šè¿™äº›æ“ä½œè¿™æ˜¯æ²¡æœ‰ä»€ä¹ˆå½±å“çš„ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><span style="font-size:medium;">åœ¨å®è·µä¸­æ‚¨å°±è¦ç¡®ä¿æ‚¨çš„æ¥æ”¶ç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œä»¥æ¥æ”¶æœ€å¤§çš„æ•°æ®åŒ…ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm"><span style="font-size:medium;"><br></span></span></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">å…³é—­ä¸€ä¸ª</span><span>socket</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">åœ¨å¤§å¤šæ•°</span><span style="border:none windowtext 1.0pt;padding:0cm">Unix</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å¹³å°ï¼Œä¸€æ—¦ä½ å®Œæˆäº†è‡ªå·±æ‰€éœ€çš„ç¨‹åºåï¼Œåœ¨</span><span style="border:none windowtext 1.0pt;padding:0cm">socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">æ–‡ä»¶ä¸­åªè¦ä½¿ç”¨æ ‡å‡†çš„æ–‡ä»¶</span><span style="border:none windowtext 1.0pt;padding:0cm">â€œcloseâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å‡½æ•°æ¥æ¸…ç†å³å¯ã€‚ç„¶è€Œï¼Œåœ¨</span><span style="border:none windowtext 1.0pt;padding:0cm">Windows</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç³»ç»Ÿä¸­ä»¥ä¸Šæƒ…å½¢ä¼šæœ‰ç‚¹ä¸åŒï¼Œæˆ‘ä»¬è¦ç”¨</span><span style="border:none windowtext 1.0pt;padding:0cm">â€œclosesocketâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å‡½æ•°æ¥æ“ä½œï¼š</span></span></p><div><div id="highlighter_757088" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#if PLATFORM == PLATFORM_MAC ||  PLATFORM == PLATFORM_UNIX</code></div><div class="line number2 index1 alt1"> </div><div class="line number3 index2 alt2"><code class="cpp plain">close( socket );</code></div><div class="line number4 index3 alt1"> </div><div class="line number5 index4 alt2"><code class="cpp preprocessor">#elif PLATFORM == PLATFORM_WINDOWS</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp plain">closesocket( socket );</code></div><div class="line number8 index7 alt1"> </div><div class="line number9 index8 alt2"><code class="cpp preprocessor">#endif</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="border:none windowtext 1.0pt;padding:0cm"> </span></p>$hhd$1&gt;<span>Socket class</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰çš„åŸºæœ¬æ“ä½œï¼šåˆ›å»ºä¸€ä¸ª</span><span style="border:none windowtext 1.0pt;padding:0cm">socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ï¼Œå°†ä»–ç»‘å®šåˆ°ä¸€ä¸ªç«¯å£å¹¶è®¾ç½®ä¸ºéé˜»å¡ï¼Œå‘é€å’Œæ¥æ”¶æ•°æ®åŒ…ï¼Œæ¸…é™¤</span><span style="border:none windowtext 1.0pt;padding:0cm">socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä½†æ˜¯ä½ ä¼šå‘ç°ä»¥ä¸Šè¿™äº›æ“ä½œä¸­å¤šå¤šå°‘å°‘éƒ½æ˜¯ä¾èµ–äºå¹³å°çš„ï¼Œåœ¨æ¯ä¸€æ¬¡ä½ æƒ³æ‰§è¡Œ</span><span style="border:none windowtext 1.0pt;padding:0cm">socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">æ“ä½œæ—¶ï¼Œä½ ä¸å¾—ä¸è®°ä½â€œ</span><span style="border:none windowtext 1.0pt;padding:0cm"># ifdef</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€æŒ‡ä»¤å’Œé’ˆå¯¹ä¸åŒå¹³å°çš„å„ç§ç»†èŠ‚ï¼Œè¿™äº›ç¹ççš„æ“ä½œæ˜¯å¾ˆä»¤äººæŠ“ç‹‚çš„ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„</span><span style="border:none windowtext 1.0pt;padding:0cm">socket</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">åŠŸèƒ½å°è£…æˆä¸€ä¸ªâ€œ</span><span style="border:none windowtext 1.0pt;padding:0cm">socket class</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€˜â€™ã€‚å½“æˆ‘ä»¬åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ª</span><span style="border:none windowtext 1.0pt;padding:0cm">â€œAddress class</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€˜â€™ï¼Œè¿™æ ·ä½¿å®ƒæ›´å®¹æ˜“æŒ‡å®šäº’è”ç½‘åœ°å€ã€‚è¿™é¿å…äº†æˆ‘ä»¬æ¯æ¬¡å‘é€æˆ–æ¥æ”¶æ•°æ®åŒ…æ—¶è¿›è¡Œæ‰‹åŠ¨ç¼–ç æˆ–è§£ç </span><span style="border:none windowtext 1.0pt;padding:0cm">â€œsockaddr_inâ€</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ç»“æ„ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸‹é¢æ˜¯â€œ</span><span style="border:none windowtext 1.0pt;padding:0cm">socket class</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€˜â€™çš„ç¨‹åºï¼š</span></span></p><div><div id="highlighter_13343" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">class</code> <code class="cpp plain">Socket</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">public</code><code class="cpp plain">:</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">    </code><code class="cpp plain">Socket();</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">    </code><code class="cpp plain">~Socket();</code></div><div class="line number6 index5 alt1"> </div><div class="line number7 index6 alt2"><code class="cpp spaces">    </code><code class="cpp color1 bold">bool</code> <code class="cpp plain">Open( unsigned </code><code class="cpp color1 bold">short</code> <code class="cpp plain">port );</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">    </code><code class="cpp keyword bold">void</code> <code class="cpp plain">Close();</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">    </code><code class="cpp color1 bold">bool</code> <code class="cpp plain">IsOpen() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">    </code><code class="cpp color1 bold">bool</code> <code class="cpp plain">Send( </code><code class="cpp keyword bold">const</code> <code class="cpp plain">Address &amp; destination,</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">               </code><code class="cpp keyword bold">const</code> <code class="cpp keyword bold">void</code> <code class="cpp plain"> data,</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">               </code><code class="cpp color1 bold">int</code> <code class="cpp plain">size );</code></div><div class="line number13 index12 alt2"> </div><div class="line number14 index13 alt1"><code class="cpp spaces">    </code><code class="cpp color1 bold">int</code> <code class="cpp plain">Receive( Address &amp; sender,</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">                 </code><code class="cpp keyword bold">void</code> <code class="cpp plain">* data,</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">                 </code><code class="cpp color1 bold">int</code> <code class="cpp plain">size );</code></div><div class="line number17 index16 alt2"> </div><div class="line number18 index17 alt1"><code class="cpp keyword bold">private</code><code class="cpp plain">:</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">    </code><code class="cpp color1 bold">int</code> <code class="cpp plain">handle;</code></div><div class="line number20 index19 alt1"> </div><div class="line number21 index20 alt2"><code class="cpp plain">};</code></div></div></td></tr></table></div></div><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><br></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸‹é¢æ˜¯â€œ</span><span style="font-family:&quot;Lucida Sans Unicode&quot;,&quot;sans-serif&quot;;color:#222222">address class</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">â€çš„ç¨‹åºï¼š</span></span></p><div><div id="highlighter_501052" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">class</code> <code class="cpp plain">Address</code></div><div class="line number2 index1 alt1"><code class="cpp plain">{</code></div><div class="line number3 index2 alt2"><code class="cpp keyword bold">public</code><code class="cpp plain">:</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">    </code><code class="cpp plain">Address();</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">    </code><code class="cpp plain">Address( unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">a,</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">             </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">b,</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">             </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">c,</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">             </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">d,</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">             </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">short</code> <code class="cpp plain">port );</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp spaces">    </code><code class="cpp plain">Address( unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">address,</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">             </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">short</code> <code class="cpp plain">port );</code></div><div class="line number13 index12 alt2"> </div><div class="line number14 index13 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">GetAddress() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">GetA() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">GetB() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">GetC() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">GetD() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">short</code> <code class="cpp plain">GetPort() </code><code class="cpp keyword bold">const</code><code class="cpp plain">;</code></div><div class="line number20 index19 alt1"> </div><div class="line number21 index20 alt2"><code class="cpp keyword bold">private</code><code class="cpp plain">:</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">int</code> <code class="cpp plain">address;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">short</code> <code class="cpp plain">port;</code></div><div class="line number24 index23 alt1"> </div><div class="line number25 index24 alt2"><code class="cpp plain">};</code></div></div></td></tr></table></div></div><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">ä¸‹é¢æ˜¯è¿™äº›</span><span style="border:none windowtext 1.0pt;padding:0cm">class</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;border:none windowtext 1.0pt;padding:0cm">å¦‚ä½•æ¥æ”¶å’Œå‘é€æ•°æ®åŒ…çš„ç¨‹åºï¼š</span></p><div><div id="highlighter_565095" class="syntaxhighlighter  cpp"><div class="toolbar"><a class="toolbar_item command_help help">?</a></div><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">// create socket</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">int</code> <code class="cpp plain">port = 30000;</code></div><div class="line number3 index2 alt2"><code class="cpp plain">Socket socket;</code></div><div class="line number4 index3 alt1"><code class="cpp keyword bold">if</code> <code class="cpp plain">( !socket.Open( port ) )</code></div><div class="line number5 index4 alt2"><code class="cpp plain">{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">    </code><code class="cpp functions bold">printf</code><code class="cpp plain">( </code><code class="cpp string">â€œfailed to create socket!\nâ€</code> <code class="cpp plain">);</code></div><div class="line number7 index6 alt2"> </div><div class="line number8 index7 alt1"><code class="cpp spaces">    </code><code class="cpp keyword bold">return</code> <code class="cpp keyword bold">false</code><code class="cpp plain">;</code></div><div class="line number9 index8 alt2"><code class="cpp plain">}</code></div><div class="line number10 index9 alt1"> </div><div class="line number11 index10 alt2"><code class="cpp comments">// send a packet</code></div><div class="line number12 index11 alt1"><code class="cpp keyword bold">const</code> <code class="cpp color1 bold">char</code> <code class="cpp plain">data[] = </code><code class="cpp string">â€œhello world!â€</code><code class="cpp plain">;</code></div><div class="line number13 index12 alt2"><code class="cpp plain">socket.Send( Address(127,0,0,1,port), data, </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">( data ) );</code></div><div class="line number14 index13 alt1"> </div><div class="line number15 index14 alt2"> </div><div class="line number16 index15 alt1"><code class="cpp comments">// receive packets</code></div><div class="line number17 index16 alt2"><code class="cpp keyword bold">while</code> <code class="cpp plain">( </code><code class="cpp keyword bold">true</code> <code class="cpp plain">)</code></div><div class="line number18 index17 alt1"><code class="cpp plain">{</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">    </code><code class="cpp plain">Address sender;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">    </code><code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">buffer[256];</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">    </code><code class="cpp color1 bold">int</code> <code class="cpp plain">bytes_read =</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">        </code><code class="cpp plain">socket.Receive( sender,</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">                        </code><code class="cpp plain">buffer,</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">                        </code><code class="cpp keyword bold">sizeof</code><code class="cpp plain">( buffer ) );</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">    </code><code class="cpp keyword bold">if</code> <code class="cpp plain">( !bytes_read )</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">        </code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number27 index26 alt2"> </div><div class="line number28 index27 alt1"> </div><div class="line number29 index28 alt2"><code class="cpp spaces">    </code><code class="cpp comments">// process packet</code></div><div class="line number30 index29 alt1"> </div><div class="line number31 index30 alt2"><code class="cpp plain">}</code></div></div></td></tr></table></div></div><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><br></p>$hhd$1&gt;<span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç»“è®º</span><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ç§ä¸é™å¹³å°çš„æ–¹æ³•æ¥å‘é€å’Œæ¥æ”¶</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰çš„</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ•°æ®åŒ…ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼ˆ</span><span>UDP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333">ï¼‰</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æ˜¯æ— è¿æ¥æ€§çš„ï¼Œå› æ­¤æˆ‘ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ç¨‹åºï¼Œå®ƒå¯ä»¥ä»æ–‡æœ¬æ–‡ä»¶ä¸­è¯»å–</span><span>IP</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">åœ°å€ï¼Œå¹¶èƒ½å¤Ÿæ¯ç§’å‘è¿™äº›åœ°å€å‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚æ¯å½“è¿™ä¸ªç¨‹åºæ¥æ”¶åˆ°ä¸€ä¸ªæ•°æ®åŒ…æ—¶ï¼Œå®ƒå°±ä¼šå‘Šè¯‰ä½ å®ƒä»¬æ¥è‡ªå“ªä¸ªæœºå™¨ï¼Œä»¥åŠæ¥æ”¶åˆ°çš„æ•°æ®åŒ…çš„å¤§å°ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;"><span style="font-size:medium;">æ‚¨å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¾ç½®å®ƒï¼Œç„¶åä½ å°±æ‹¥æœ‰äº†ä¸€ç³»åˆ—åœ¨æœ¬åœ°æœºå™¨ä¸Šäº’ç›¸å‘é€æ•°æ®åŒ…çš„èŠ‚ç‚¹ã€‚è¿™æ ·ä½ å°±å¯ä»¥åˆ©ç”¨ä»¥ä¸‹ç¨‹åºé€šè¿‡ä¸åŒçš„ç«¯å£ï¼Œè¿›å…¥ä¸åŒçš„åº”ç”¨ç¨‹åºï¼š</span></span></p><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><em><span style="border:none"><span style="border:none"><span style="font-size:medium;">   &gt; Node30000</span></span></span></em></p><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><em><span style="border:none"><span style="border:none"><span style="font-size:medium;">   &gt; Node 30001</span></span></span></em></p><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><em><span style="border:none"><span style="border:none"><span style="font-size:medium;">   &gt; Node 30002</span></span></span></em></p><p class="MsoNormal" align="left" style="margin: 18pt 18.05pt; text-indent: 24pt;"><em><span style="border:none"><span style="border:none"><span style="font-size:medium;">   etcâ€¦</span></span></span></em></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç„¶åæ¯ä¸ªèŠ‚ç‚¹éƒ½å°†å°è¯•å‘é€æ•°æ®åŒ…åˆ°æ¯ä¸ªå…¶ä»–èŠ‚ç‚¹ï¼Œå®ƒçš„å·¥ä½œåŸç†å°±åƒä¸€ä¸ªå°å‹çš„â€œ</span><span>peer-to-peer</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">â€è®¾ç½®ã€‚</span></span></p><p class="MsoNormal" style="text-indent:24.0pt"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">æˆ‘æ˜¯åœ¨</span><span>MacOSX</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç³»ç»Ÿä¸­å¼€å‘çš„è¿™ä¸ªç¨‹åºï¼Œä½†æˆ‘æƒ³ä½ åº”è¯¥èƒ½å¤Ÿè½»æ¾åœ°åœ¨ä»»ä½•</span><span>Unix</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ç³»ç»Ÿæˆ–</span><span>Windows</span><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;">ä¸Šå¯¹ä»–è¿›è¡Œç¼–è¯‘ã€‚å¦‚æœä½ æœ‰ä»»ä½•åº”ç”¨åœ¨å…¶ä»–ä¸åŒæœºå™¨ä¸Šçš„å…¼å®¹æ€§è¡¥ä¸ï¼Œä¹Ÿéå¸¸æ¬¢è¿æ‚¨ä¸æˆ‘å–å¾—è”ç³»ã€‚</span></span></p><p class="MsoNormal" align="left" style="text-indent: 24pt;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#222222"><span style="font-size:medium;"><br></span></span></p><p class="MsoNormal" align="left" style="text-indent: 0cm; line-height: 18pt;"><span style="font-size:medium;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#222222">ã€ç‰ˆæƒå£°æ˜ã€‘</span><span style="font-family: å¾®è½¯é›…é»‘, sans-serif; color: rgb(51, 51, 51);"> </span></span></p><p class="MsoNormal" align="left" style="text-indent: 0cm;"><span style="font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#222222"><span style="font-size:medium;">åŸæ–‡ä½œè€…æœªåšæƒåˆ©å£°æ˜ï¼Œè§†ä¸ºå…±äº«çŸ¥è¯†äº§æƒè¿›å…¥å…¬å…±é¢†åŸŸï¼Œè‡ªåŠ¨è·å¾—æˆæƒã€‚</span></span><span style="font-size:9.0pt;font-family:&quot;å¾®è½¯é›…é»‘&quot;,&quot;sans-serif&quot;;color:#333333"> </span></p><p class="MsoNormal" align="left" style="text-indent: 24pt;"><span style="font-family:&quot;Lucida Sans Unicode&quot;,&quot;sans-serif&quot;;color:#222222"> </span></p></div>                    </div><br>                

<h1 id="æºç ä¸‹è½½"><a href="#æºç ä¸‹è½½" class="headerlink" title="æºç ä¸‹è½½"></a>æºç ä¸‹è½½</h1><p>å›  Gaffer On Games çš„æºç åŸä¸‹è½½åœ°å€å¤±æ•ˆ, æ‰€ä»¥ç‰¹åœ°è¡¥ä¸Š.</p>
<p><a href="https://github.com/no5ix/ReliableUDP" target="_blank" rel="noopener">è¯·ç‚¹å‡»</a></p>

      


      

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/TCP/" rel="tag"><i class="fa fa-tag"></i> TCP</a>
            
              <a href="/tags/GafferOnGames/" rel="tag"><i class="fa fa-tag"></i> GafferOnGames</a>
            
              <a href="/tags/UDP/" rel="tag"><i class="fa fa-tag"></i> UDP</a>
            
          </div>
        

        
        
        

        
          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/æ¸¸æˆç½‘ç»œå¼€å‘ä¸€ä¹‹TCPvsUDP/" rel="next" title="æ¸¸æˆç½‘ç»œå¼€å‘ä¸€ä¹‹TCPvsUDP">
                  <i class="fa fa-chevron-left"></i> 
                  <p class="post-nav-pre-next-title">
                    æ¸¸æˆç½‘ç»œå¼€å‘ä¸€ä¹‹TCPvsUDP
                  </p> 
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/virtual_connection_over_udp/" rel="prev" title="æ¸¸æˆç½‘ç»œå¼€å‘ä¸‰ä¹‹åŸºäºUDPçš„è™šæ‹Ÿè¿æ¥">
                <p class="post-nav-pre-next-title">
                    æ¸¸æˆç½‘ç»œå¼€å‘ä¸‰ä¹‹åŸºäºUDPçš„è™šæ‹Ÿè¿æ¥
                </p> 
                <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        

        
        
      </footer>
      
    </div>
    
    
    

    

    

    

  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  

  <aside id="sidebar" class="sidebar">

    
      
        <div id="sidebar-dimmer"></div>
      
    

    <div class="sidebar-inner">
    
      <div class="sidebar-toggle-inside motion-element">
        <div class="sidebar-toggle-line-wrap">
          <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
          <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
          <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
        </div>
      </div>

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a href="/" class="site-author-image" rel="start" style="border:none">
            <img class="site-author-image" itemprop="image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="/uploads/avatar.png" alt="Mike">
          </a>
          <p class="site-author-name" itemprop="name">Mike</p>
           
              <p class="site-description motion-element" itemprop="description">ğŸš™ ğŸš— ğŸ’¨ ğŸ’¨ If you want to create a blog like this, just follow my open-source project, "hexo-theme-neo", click the GitHub button below and check it out ^_^ . It is recommended to use Chrome, Safari, or Edge to read this blog since this blog was developed on Edge (Chromium kernel version) and tested on Safari.</p>
          
        </div>

        <nav class="site-state motion-element">

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">298</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">111</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

          <div class="site-state-item site-state-about">
            <a href="/about/">
              <span class="site-state-item-about fa fa-fw fa-user"></span>
              <span class="site-state-item-name">about</span>
            </a>
          </div>
          
        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/no5ix" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://open.spotify.com/user/313duq77ekebrfyak3xijqewzss4?si=e7653b829a9747bf" target="_blank" title="Spotify">
                  
                    <i class="fa fa-fw fa-spotify"></i>
                  
                    
                      Spotify
                    
                </a>
              </span>
            
          
          
          <!-- ç½‘æ˜“äº‘éŸ³ä¹ -->
            <!-- <div class="netease-cloud-music"> -->
              <!-- <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=280 height=110 src="//music.163.com/outchain/player?type=0&id=992743594&auto=0&height=90"></iframe> -->
            <!-- </div> -->
          <!-- ç½‘æ˜“äº‘éŸ³ä¹ -->

        </div>

        
        

        
        

        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#åŸæ–‡"><span class="nav-text">åŸæ–‡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#introduction"><span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bsd-sockets"><span class="nav-text">BSD sockets</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#platform-specifics"><span class="nav-text">Platform specifics</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#initializing-the-socket-layer"><span class="nav-text">Initializing the socket layer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#creating-a-socket"><span class="nav-text">Creating a socket</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#setting-the-socket-as-non-blocking"><span class="nav-text">Setting the socket as non-blocking</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sending-packets"><span class="nav-text">Sending packets</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#receiving-packets"><span class="nav-text">Receiving packets</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#destroying-a-socket"><span class="nav-text">Destroying a socket</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#socket-class"><span class="nav-text">Socket class</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#conclusion"><span class="nav-text">Conclusion</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#è¯‘æ–‡"><span class="nav-text">è¯‘æ–‡</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#æºç ä¸‹è½½"><span class="nav-text">æºç ä¸‹è½½</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mike</span>
</div>



        

        
      </div>
    </footer>

    <!--
    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      
        <span id="scrollpercent"><span>0</span>%</span>
      
    </div>
    -->

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>










  















  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/mediumzoom/medium-zoom.js?v=1.1.0"></script>





  




  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>


  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

    <script src="/js/src/local-search.js"></script>





  

  

  

  

  

  


  <script type="text/javascript" src="/lib/wobble_window/wobblewindow.js"> </script>
<script type="text/javascript" src="/js/src/custom.js"></script>
</body>
</html>






<script type="text/javascript" src="/js/src/headroom.js"></script>

<!-- ä»£ç å—å¤åˆ¶åŠŸèƒ½ -->
<script type="text/javascript" src="/js/src/code-highlight-modification.js"></script>

<!-- Flashcards Script -->
<script type="text/javascript" src="/js/src/flashcards.js"></script>
