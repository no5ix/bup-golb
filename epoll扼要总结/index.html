<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


  <meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">

<script>
    (function(){
        if(''){
            let localStoragePasswdKey = 'epollæ‰¼è¦æ€»ç»“' + '_last_passwd';
            let tryCnt = 0;
            function checkPassword(password) {
                password = password == null ? null : password.trim();
                if (password !== '') {
                    if (password != null) {
                        // å¦‚æœç”¨æˆ·ç‚¹å‡»äº†ç¡®è®¤è€Œä¸”å¯†ç é”™è¯¯çš„æ—¶å€™, å› ä¸ºå½“password == nullçš„æ—¶å€™è¯´æ˜ç”¨æˆ·ç‚¹äº†å–æ¶ˆ
                        alert('Error!');
                        if (++tryCnt < 3) {
                            password = prompt('Open Sesame');
                            checkPassword(password);
                            return;
                        }
                    }

                    // if (history.length > 1) {
                    //     alert('back!');
                    //     history.back();
                    // } else {
                        // alert('blankkkk!');
                    //     window.location.href = "about:blank";
                    // }
                    if (document.referrer) {
                        window.location.href = document.referrer;
                    } else {
                        window.location.href = "about:blank";; // fallback if no referrer
                    }

                } else {
                    localStorage.setItem(localStoragePasswdKey, password);
                }
            }

            var password_verify_on_local = false;
            const hostname = window.location.hostname;
            if (password_verify_on_local || (!(hostname === "localhost" || hostname === "127.0.0.1" || hostname === "::1" || hostname.startsWith("192")))) {
                const lspk = localStorage.getItem(localStoragePasswdKey) || "";
                if (lspk !== '') {
                    var password = prompt('Open Sesame');
                    checkPassword(password);
                }
            }
        }
    })();
</script>








<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">





















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Linux,noodle,">








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.2">






<meta name="description" content="epoll ç¼–ç¨‹æ¥å£epoll APIæ˜¯Linuxç³»ç»Ÿä¸“æœ‰çš„ï¼Œåœ¨2.6ç‰ˆä¸­æ–°å¢ã€‚ epoll APIçš„æ ¸å¿ƒæ•°æ®ç»“æ„ç§°ä½œepollå®ä¾‹ï¼Œå®ƒå’Œä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç›¸å…³è”ã€‚è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸æ˜¯ç”¨æ¥åšI/Oæ“ä½œçš„ï¼Œç›¸åï¼Œå®ƒæ˜¯å†…æ ¸æ•°æ®ç»“æ„çš„å¥æŸ„ï¼Œè¿™äº›å†…æ ¸æ•°æ®ç»“æ„å®ç°äº†ä¸¤ä¸ªç›®çš„ã€‚  è®°å½•äº†åœ¨è¿›ç¨‹ä¸­å£°æ˜è¿‡çš„æ„Ÿå…´è¶£çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-interest listï¼ˆå…´è¶£åˆ—è¡¨ï¼‰ã€‚ ç»´æŠ¤äº†å¤„äºI/Oå°±ç»ªæ€çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-r">
<meta name="keywords" content="Linux,noodle">
<meta property="og:type" content="article">
<meta property="og:title" content="epollæ‰¼è¦æ€»ç»“">
<meta property="og:url" content="https://hulinhong.com/epollæ‰¼è¦æ€»ç»“/index.html">
<meta property="og:site_name" content="ğŸš™">
<meta property="og:description" content="epoll ç¼–ç¨‹æ¥å£epoll APIæ˜¯Linuxç³»ç»Ÿä¸“æœ‰çš„ï¼Œåœ¨2.6ç‰ˆä¸­æ–°å¢ã€‚ epoll APIçš„æ ¸å¿ƒæ•°æ®ç»“æ„ç§°ä½œepollå®ä¾‹ï¼Œå®ƒå’Œä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç›¸å…³è”ã€‚è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸æ˜¯ç”¨æ¥åšI/Oæ“ä½œçš„ï¼Œç›¸åï¼Œå®ƒæ˜¯å†…æ ¸æ•°æ®ç»“æ„çš„å¥æŸ„ï¼Œè¿™äº›å†…æ ¸æ•°æ®ç»“æ„å®ç°äº†ä¸¤ä¸ªç›®çš„ã€‚  è®°å½•äº†åœ¨è¿›ç¨‹ä¸­å£°æ˜è¿‡çš„æ„Ÿå…´è¶£çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-interest listï¼ˆå…´è¶£åˆ—è¡¨ï¼‰ã€‚ ç»´æŠ¤äº†å¤„äºI/Oå°±ç»ªæ€çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-r">
<meta property="og:locale" content="en">
<meta property="og:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">
<meta property="og:updated_time" content="2025-12-17T18:31:29.647Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="epollæ‰¼è¦æ€»ç»“">
<meta name="twitter:description" content="epoll ç¼–ç¨‹æ¥å£epoll APIæ˜¯Linuxç³»ç»Ÿä¸“æœ‰çš„ï¼Œåœ¨2.6ç‰ˆä¸­æ–°å¢ã€‚ epoll APIçš„æ ¸å¿ƒæ•°æ®ç»“æ„ç§°ä½œepollå®ä¾‹ï¼Œå®ƒå’Œä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç›¸å…³è”ã€‚è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¸æ˜¯ç”¨æ¥åšI/Oæ“ä½œçš„ï¼Œç›¸åï¼Œå®ƒæ˜¯å†…æ ¸æ•°æ®ç»“æ„çš„å¥æŸ„ï¼Œè¿™äº›å†…æ ¸æ•°æ®ç»“æ„å®ç°äº†ä¸¤ä¸ªç›®çš„ã€‚  è®°å½•äº†åœ¨è¿›ç¨‹ä¸­å£°æ˜è¿‡çš„æ„Ÿå…´è¶£çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-interest listï¼ˆå…´è¶£åˆ—è¡¨ï¼‰ã€‚ ç»´æŠ¤äº†å¤„äºI/Oå°±ç»ªæ€çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-r">
<meta name="twitter:image" content="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":12,"scrollpercent":true,"onmobile":true,"dimmer":true,"body_content_height":0,"display_duration":150},
    local_search: {"enable":true,"trigger":"auto","top_n_per_article":1},
    fancybox: false,
    mediumzoom: true,
    darkmode_js: false,
    tabs: true,
    motion: {"enable":true,"async":false,"duration":188,"transition":{"header":"fadeIn","menu":"fadeIn","logo":"fadeIn","post_block_else":"fadeIn","post_header":"fadeIn","post_body":"fadeIn","coll_header":"fadeIn","footer":"fadeIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>








  <title>epollæ‰¼è¦æ€»ç»“ | ğŸš™</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ğŸš™</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">ğŸ’¨ ğŸ’¨ ğŸ’¨</p>
      
  </div>

  <div class="menu-item sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <div class="menu-item site-search">
    
  
  <div class="site-search-div">
    <button class="search-icon" id="search-button">
      <i class="fa fa-search"></i>
    </button>
    <input type="text" id="local-search-input" class="st-search-input">
    <i id="local-search-close">Ã—</i>
  </div>


<script type="text/javascript" id="local.search.active">
    {/* var inputArea       = document.querySelector("#local-search-input");
    inputArea.onclick   = function(){ getSearchFile(); this.focus(); }
    inputArea.onkeydown = function(){ if(event.keyCode == 13) return false } */}
</script>



  </div>
  <div id="local-search-result-pc" class="local-search-result-cls"></div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      

       
    </ul>
  

  
    
  
</nav>



 </div>
    </header>

    <div id="local-search-result-mobile" class="local-search-result-cls"></div>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://hulinhong.com/epollæ‰¼è¦æ€»ç»“/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mike">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ğŸš™">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">epollæ‰¼è¦æ€»ç»“</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-06-22T21:56:12+00:00">
                06-22-2015
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            <div class="post-tags">
              
                <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
              
                <a href="/tags/noodle/" rel="tag"><i class="fa fa-tag"></i> noodle</a>
              
            </div>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    




    
    
    
    <div class="post-body" itemprop="articleBody">
      
      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/top500_english_life_sentences/" rel="next" title="Top 500 English sentences for daily life">
                <i class="fa fa-chevron-left"></i> 
                <p class="post-nav-pre-next-title">
                  Top 500 English sentences for daily life
                </p> 
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/socketå¯è¯»å¯å†™æ¡ä»¶ä¸éé˜»å¡connectæˆ–acceptæµ…æ/" rel="prev" title="socketå¯è¯»å¯å†™æ¡ä»¶ä¸éé˜»å¡connectæˆ–acceptæµ…æ">
              <p class="post-nav-pre-next-title">
                  socketå¯è¯»å¯å†™æ¡ä»¶ä¸éé˜»å¡connectæˆ–acceptæµ…æ
              </p> 
              <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      

      
      

      
        <h1 id="epoll-ç¼–ç¨‹æ¥å£"><a href="#epoll-ç¼–ç¨‹æ¥å£" class="headerlink" title="epoll ç¼–ç¨‹æ¥å£"></a>epoll ç¼–ç¨‹æ¥å£</h1><p>epoll APIæ˜¯Linuxç³»ç»Ÿä¸“æœ‰çš„ï¼Œåœ¨2.6ç‰ˆä¸­æ–°å¢ã€‚</p>
<p>epoll APIçš„æ ¸å¿ƒæ•°æ®ç»“æ„ç§°ä½œepollå®ä¾‹ï¼Œå®ƒå’Œä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦ç›¸å…³è”ã€‚è¿™ä¸ªæ–‡ä»¶<br>æè¿°ç¬¦ä¸æ˜¯ç”¨æ¥åšI/Oæ“ä½œçš„ï¼Œç›¸åï¼Œå®ƒæ˜¯å†…æ ¸æ•°æ®ç»“æ„çš„å¥æŸ„ï¼Œè¿™äº›å†…æ ¸æ•°æ®ç»“æ„å®ç°äº†ä¸¤<br>ä¸ªç›®çš„ã€‚</p>
<ul>
<li>è®°å½•äº†åœ¨è¿›ç¨‹ä¸­å£°æ˜è¿‡çš„æ„Ÿå…´è¶£çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-<strong>interest listï¼ˆå…´è¶£åˆ—è¡¨ï¼‰</strong>ã€‚</li>
<li>ç»´æŠ¤äº†å¤„äºI/Oå°±ç»ªæ€çš„æ–‡ä»¶æè¿°ç¬¦åˆ—è¡¨-<strong>ready listï¼ˆå°±ç»ªåˆ—è¡¨ï¼‰</strong>ã€‚</li>
</ul>
<p>ready listä¸­çš„æˆå‘˜æ˜¯interest listçš„å­é›†ã€‚</p>
<p>å¯¹äºç”±epollæ£€æŸ¥çš„æ¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šä¸€ä¸ªä½æ©ç æ¥è¡¨ç¤ºæˆ‘ä»¬æ„Ÿå…´è¶£çš„äº‹<br>ä»¶ã€‚è¿™äº›ä½æ©ç åŒpoll()æ‰€ä½¿ç”¨çš„ä½æ©ç æœ‰ç€ç´§å¯†çš„å…³è”ã€‚</p>
<p><strong>. . .</strong><a id="more"></a></p>
<h2 id="epollæ¦‚è¦"><a href="#epollæ¦‚è¦" class="headerlink" title="epollæ¦‚è¦"></a>epollæ¦‚è¦</h2><p>éœ€è¦åŒ…å«epoll.hå¤´æ–‡ä»¶, å³ : <code>#include &lt;sys/epoll.h&gt;</code><br>epollåªæœ‰epoll_create, epoll_ctl, epoll_wait 3ä¸ªç³»ç»Ÿè°ƒç”¨ : </p>
<ul>
<li>ç³»ç»Ÿè°ƒç”¨<strong>epoll_create()</strong>åˆ›å»ºä¸€ä¸ªepollå®ä¾‹ï¼Œè¿”å›ä»£è¡¨è¯¥å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</li>
<li>ç³»ç»Ÿè°ƒç”¨<strong>epoll_ctl()</strong>æ“ä½œåŒepollå®ä¾‹ç›¸å…³è”çš„å…´è¶£åˆ—è¡¨ã€‚é€šè¿‡epoll_ctl()ï¼Œæˆ‘ä»¬å¯ä»¥å¢<br>åŠ æ–°çš„æè¿°ç¬¦åˆ°åˆ—è¡¨ä¸­ï¼Œæˆ–è€…å°†å·²æœ‰çš„æ–‡ä»¶æè¿°ç¬¦ä»è¯¥åˆ—è¡¨ä¸­ç§»é™¤ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ä»£è¡¨æ–‡ä»¶æè¿°<br>ç¬¦ä¸ƒäº‹ä»¶ç±»å‹çš„ä½æ©ç ã€‚</li>
<li>ç³»ç»Ÿè°ƒç”¨<strong>epoll_wait()</strong>è¿”å›ä¸epollå®ä¾‹ç›¸å…³è”çš„å°±ç»ªåˆ—è¡¨ä¸­çš„æˆå‘˜ã€‚</li>
</ul>
<h2 id="epoll-create"><a href="#epoll-create" class="headerlink" title="epoll_create"></a>epoll_create</h2><p><code>int epoll_create(int size);</code><br>Returns file descriptor on success, or -1 on error.</p>
<p>åˆ›å»ºä¸€ä¸ªepollçš„å¥æŸ„ã€‚è‡ªä»linux2.6.8ä¹‹åï¼Œsizeå‚æ•°æ˜¯è¢«å¿½ç•¥çš„ã€‚<br>å‡½æ•°è¿”å›ä»£è¡¨æ–°åˆ›å»ºçš„ epoll å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦(ä¸€èˆ¬ç”¨ epfdè¡¨ç¤º),<br> è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦åœ¨å…¶ä»–å‡ ä¸ª epoll ç³»ç»Ÿè°ƒç”¨ä¸­ç”¨æ¥è¡¨ç¤º epoll å®ä¾‹.<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“åˆ›å»ºå¥½epollå¥æŸ„åï¼Œå®ƒå°±æ˜¯ä¼šå ç”¨ä¸€ä¸ªfdå€¼ï¼Œåœ¨linuxä¸‹å¦‚æœæŸ¥çœ‹/proc/è¿›ç¨‹id/fd/ï¼Œæ˜¯èƒ½å¤Ÿçœ‹åˆ°è¿™ä¸ªfdçš„ï¼Œ<br>æ‰€ä»¥åœ¨ä½¿ç”¨å®Œepollåï¼Œå¿…é¡»è°ƒç”¨close()å…³é—­ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´fdè¢«è€—å°½ã€‚</p>
<h2 id="epoll-ctl"><a href="#epoll-ctl" class="headerlink" title="epoll_ctl"></a>epoll_ctl</h2><p><code>int epoll_ctl(int epfd, int op, int fd, struct epoll_event *ev);</code><br>Returns 0 on success, or -1 on error.</p>
<p>epollçš„äº‹ä»¶æ³¨å†Œå‡½æ•°ï¼Œå®ƒä¸åŒäºselect()æ˜¯åœ¨ç›‘å¬äº‹ä»¶æ—¶å‘Šè¯‰å†…æ ¸è¦ç›‘å¬ä»€ä¹ˆç±»å‹çš„äº‹ä»¶ï¼Œè€Œæ˜¯åœ¨è¿™é‡Œå…ˆæ³¨å†Œè¦ç›‘å¬çš„äº‹ä»¶ç±»å‹ã€‚</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯epoll_create()çš„è¿”å›å€¼, ä¹Ÿå°±æ˜¯æ–°åˆ›å»ºçš„ epoll å®ä¾‹çš„æ–‡ä»¶æè¿°ç¬¦ã€‚</li>
<li>ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŠ¨ä½œï¼Œç”¨ä¸‰ä¸ªå®æ¥è¡¨ç¤ºï¼š<ul>
<li>EPOLL_CTL_ADDï¼šæ³¨å†Œæ–°çš„fdåˆ°epfdä¸­çš„å…´è¶£åˆ—è¡¨ï¼›</li>
<li>EPOLL_CTL_MODï¼šä¿®æ”¹å·²ç»æ³¨å†Œçš„fdçš„è®¾å®šäº‹ä»¶ï¼›</li>
<li>EPOLL_CTL_DELï¼šä»epfdçš„å…´è¶£åˆ—è¡¨ä¸­åˆ é™¤ä¸€ä¸ªfdï¼›</li>
</ul>
</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡è¦ä¿®æ”¹å…´è¶£åˆ—è¡¨ä¸­çš„å“ªä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„è®¾å®šã€‚</li>
<li><p>ç¬¬å››ä¸ªå‚æ•°æ˜¯å‘Šè¯‰å†…æ ¸éœ€è¦ç›‘å¬ä»€ä¹ˆäº‹ï¼Œå‚æ•°evæ˜¯æŒ‡å‘ç»“æ„ä½“epoll_eventçš„æŒ‡é’ˆ,<br>  struct epoll_eventç»“æ„å¦‚ä¸‹ï¼š</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">epoll_event</span> &#123;</span>  </span><br><span class="line">    <span class="keyword">__uint32_t</span> events; <span class="comment">/* Epoll events */</span>  </span><br><span class="line">    <span class="keyword">epoll_data_t</span> data; <span class="comment">/* User data variable */</span>  </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>  ç»“æ„ä½“epoll_eventä¸­çš„dataå­—æ®µçš„ç±»å‹ä¸º:</p>
  <figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">union</span> epoll_data &#123;  </span><br><span class="line">    <span class="keyword">void</span> *ptr;   <span class="comment">/* Pointer to user-defined data */</span></span><br><span class="line">    <span class="keyword">int</span> fd;  </span><br><span class="line">    <span class="keyword">__uint32_t</span> u32;  </span><br><span class="line">    <span class="keyword">__uint64_t</span> u64;  </span><br><span class="line">&#125; <span class="keyword">epoll_data_t</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç»“æ„ä½“epoll_eventä¸­çš„eventså­—æ®µæ˜¯ä¸€ä¸ªä½æ©ç , ä»–æŒ‡å®šäº†æˆ‘ä»¬ä¸ºå¾…æ£€æŸ¥çš„æè¿°ç¬¦fdä¸Šæ‰€æ„Ÿå…´è¶£çš„äº‹ä»¶é›†åˆ.<br>å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ä¸ªå®çš„é›†åˆï¼š</p>
<ul>
<li>EPOLLIN ï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥è¯»ï¼ˆåŒ…æ‹¬å¯¹ç«¯SOCKETæ­£å¸¸å…³é—­ï¼‰ï¼›</li>
<li>EPOLLOUTï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å¯ä»¥å†™ï¼›</li>
<li>EPOLLPRIï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦æœ‰ç´§æ€¥çš„æ•°æ®å¯è¯»ï¼ˆè¿™é‡Œåº”è¯¥è¡¨ç¤ºæœ‰å¸¦å¤–æ•°æ®åˆ°æ¥ï¼‰ï¼›</li>
<li>EPOLLERRï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦å‘ç”Ÿé”™è¯¯ï¼›</li>
<li>EPOLLHUPï¼šè¡¨ç¤ºå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦è¢«æŒ‚æ–­ï¼›</li>
<li>EPOLLETï¼š å°†EPOLLè®¾ä¸ºè¾¹ç¼˜è§¦å‘(Edge Triggered)æ¨¡å¼ï¼Œè¿™æ˜¯ç›¸å¯¹äºæ°´å¹³è§¦å‘(Level Triggered)æ¥è¯´çš„ã€‚(åæ–‡ä¼šè¯´æ°´å¹³è§¦å‘å’Œè¾¹ç¼˜è§¦å‘çš„åŒºåˆ«)</li>
<li>EPOLLONESHOTï¼šåªç›‘å¬ä¸€æ¬¡äº‹ä»¶ï¼Œå½“ç›‘å¬å®Œè¿™æ¬¡äº‹ä»¶ä¹‹åï¼Œå¦‚æœè¿˜éœ€è¦ç»§ç»­ç›‘å¬è¿™ä¸ªsocketçš„è¯ï¼Œéœ€è¦å†æ¬¡æŠŠè¿™ä¸ªsocketåŠ å…¥åˆ°EPOLLé˜Ÿåˆ—é‡Œ</li>
</ul>
</li>
<li><p>data å­—æ®µæ˜¯ä¸€ä¸ªè”åˆä½“, å½“æè¿°ç¬¦ fd ç¨åæˆä¸ºå°±ç»ªæ€æ—¶, è”åˆä½“çš„æˆå‘˜å¯ç”¨æ¥æŒ‡å®šä¼ å›ç»™è°ƒç”¨è¿›ç¨‹çš„ä¿¡æ¯</p>
</li>
</ul>
</li>
</ul>
<h2 id="ä½¿ç”¨-epoll-create-å’Œ-epoll-ctl-çš„ä¾‹å­"><a href="#ä½¿ç”¨-epoll-create-å’Œ-epoll-ctl-çš„ä¾‹å­" class="headerlink" title="ä½¿ç”¨ epoll_create() å’Œ epoll_ctl()çš„ä¾‹å­"></a>ä½¿ç”¨ epoll_create() å’Œ epoll_ctl()çš„ä¾‹å­</h2><p>ä½¿ç”¨ epoll_create() å’Œ epoll_ctl()</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> epdf;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">epoll_event</span> <span class="title">ev</span>;</span></span><br><span class="line"></span><br><span class="line">epfd = epoll_create( <span class="number">5</span> );</span><br><span class="line"><span class="keyword">if</span> ( epfd == <span class="number">-1</span> )</span><br><span class="line">    errExit( <span class="string">"epoll_create"</span> );</span><br><span class="line"></span><br><span class="line">ev.data.fd = fd;</span><br><span class="line">ev.events = EPOLLIN;</span><br><span class="line"><span class="keyword">if</span> ( epoll_ctl( epofd, EPOLL_CTL_ADD, fd, ev ) == <span class="number">-1</span> )</span><br><span class="line">    errExit( <span class="string">"epoll_ctl"</span> );</span><br></pre></td></tr></table></figure>
<h2 id="epoll-wait"><a href="#epoll-wait" class="headerlink" title="epoll_wait"></a>epoll_wait</h2><p><code>int epoll_wait(int epfd, struct epoll_event * events, int maxevents, int timeout);</code><br>Returns number of ready file descriptors, 0 on timeout, or -1 on error.</p>
<p>epoll_waitæ”¶é›†åœ¨epollç›‘æ§çš„äº‹ä»¶ä¸­å·²ç»å‘é€çš„äº‹ä»¶ã€‚</p>
<ul>
<li>å‚æ•°eventsæ˜¯åˆ†é…å¥½çš„epoll_eventç»“æ„ä½“æ•°ç»„ï¼Œepollå°†ä¼šæŠŠå‘ç”Ÿçš„äº‹ä»¶èµ‹å€¼åˆ°eventsæ•°ç»„ä¸­ï¼ˆeventsä¸å¯ä»¥æ˜¯ç©ºæŒ‡é’ˆï¼Œå†…æ ¸åªè´Ÿè´£æŠŠæ•°æ®å¤åˆ¶åˆ°è¿™ä¸ªeventsæ•°ç»„ä¸­ï¼Œä¸ä¼šå»å¸®åŠ©æˆ‘ä»¬åœ¨ç”¨æˆ·æ€ä¸­åˆ†é…å†…å­˜ï¼‰ã€‚</li>
<li>maxeventså‘Šä¹‹å†…æ ¸è¿™ä¸ªeventsæœ‰å¤šå¤§ï¼Œè¿™ä¸ª maxeventsçš„å€¼ä¸èƒ½å¤§äºåˆ›å»ºepoll_create()æ—¶çš„sizeï¼Œ</li>
<li>å‚æ•°timeoutæ˜¯è¶…æ—¶æ—¶é—´, ç”¨æ¥ç¡®å®š epoll_wait() çš„é˜»å¡è¡Œä¸º, æœ‰å¦‚ä¸‹å‡ ç§ : <ul>
<li>å¦‚æœ timeout ç­‰äº -1, è°ƒç”¨å°†ä¸€ç›´é˜»å¡, ç›´åˆ°å…´è¶£åˆ—è¡¨ä¸­çš„æ–‡ä»¶æè¿°ç¬¦æœ‰äº‹ä»¶äº§ç”Ÿ, æˆ–è€…ç›´åˆ°æ•è·åˆ°ä¸€ä¸ªä¿¡å·ä¸ºæ­¢</li>
<li>å¦‚æœ timeout ç­‰äº 0, æ‰§è¡Œä¸€æ¬¡éé˜»å¡çš„æ£€æŸ¥, ç«‹å³è¿”å›, çœ‹å…´è¶£åˆ—è¡¨ä¸­çš„æ–‡ä»¶æè¿°ç¬¦ä¸Šäº§ç”Ÿäº†å“ªä¸ªäº‹ä»¶</li>
<li>å¦‚æœ timeout å¤§äº 0, è°ƒç”¨å°†é˜»å¡è‡³å¤š timeout æ¯«ç§’, çŸ¥é“æ–‡ä»¶æè¿°ç¬¦ä¸Šæœ‰äº‹ä»¶äº§ç”Ÿ, æˆ–è€…ç›´åˆ°æ•è·åˆ°ä¸€ä¸ªä¿¡å·ä¸ºæ­¢</li>
</ul>
</li>
</ul>
<h2 id="TLPIä¹¦ä¸Šçš„ä¾‹å­"><a href="#TLPIä¹¦ä¸Šçš„ä¾‹å­" class="headerlink" title="TLPIä¹¦ä¸Šçš„ä¾‹å­"></a>TLPIä¹¦ä¸Šçš„ä¾‹å­</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*************************************************************************\</span></span><br><span class="line"><span class="comment">*                  Copyright (C) Michael Kerrisk, 2017.                   *</span></span><br><span class="line"><span class="comment">*                                                                         *</span></span><br><span class="line"><span class="comment">* This program is free software. You may use, modify, and redistribute it *</span></span><br><span class="line"><span class="comment">* under the terms of the GNU General Public License as published by the   *</span></span><br><span class="line"><span class="comment">* Free Software Foundation, either version 3 or (at your option) any      *</span></span><br><span class="line"><span class="comment">* later version. This program is distributed without any warranty.  See   *</span></span><br><span class="line"><span class="comment">* the file COPYING.gpl-v3 for details.                                    *</span></span><br><span class="line"><span class="comment">\*************************************************************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Listing 63-5 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* epoll_input.c</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   Example of the use of the Linux epoll API.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   Usage: epoll_input file...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   This program opens all of the files named in its command-line arguments</span></span><br><span class="line"><span class="comment">   and monitors the resulting file descriptors for input events.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">   This program is Linux (2.6 and later) specific.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/epoll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"tlpi_hdr.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_BUF     1000        <span class="comment">/* Maximum bytes fetched by a single read() */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_EVENTS     5        <span class="comment">/* Maximum number of events to be returned from</span></span></span><br><span class="line"><span class="meta"><span class="comment">                                   a single epoll_wait() call */</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">main(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> epfd, ready, fd, s, j, numOpenFds;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">epoll_event</span> <span class="title">ev</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">epoll_event</span> <span class="title">evlist</span>[<span class="title">MAX_EVENTS</span>];</span></span><br><span class="line">    <span class="keyword">char</span> buf[MAX_BUF];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (argc &lt; <span class="number">2</span> || <span class="built_in">strcmp</span>(argv[<span class="number">1</span>], <span class="string">"--help"</span>) == <span class="number">0</span>)</span><br><span class="line">        usageErr(<span class="string">"%s file...\n"</span>, argv[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    epfd = epoll_create(argc - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (epfd == <span class="number">-1</span>)</span><br><span class="line">        errExit(<span class="string">"epoll_create"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Open each file on command line, and add it to the "interest</span></span><br><span class="line"><span class="comment">       list" for the epoll instance */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt; argc; j++) &#123;</span><br><span class="line">        fd = open(argv[j], O_RDONLY);</span><br><span class="line">        <span class="keyword">if</span> (fd == <span class="number">-1</span>)</span><br><span class="line">            errExit(<span class="string">"open"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Opened \"%s\" on fd %d\n"</span>, argv[j], fd);</span><br><span class="line"></span><br><span class="line">        ev.events = EPOLLIN;            <span class="comment">/* Only interested in input events */</span></span><br><span class="line">        ev.data.fd = fd;</span><br><span class="line">        <span class="keyword">if</span> (epoll_ctl(epfd, EPOLL_CTL_ADD, fd, &amp;ev) == <span class="number">-1</span>)</span><br><span class="line">            errExit(<span class="string">"epoll_ctl"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    numOpenFds = argc - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (numOpenFds &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Fetch up to MAX_EVENTS items from the ready list of the</span></span><br><span class="line"><span class="comment">           epoll instance */</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"About to epoll_wait()\n"</span>);</span><br><span class="line">        ready = epoll_wait(epfd, evlist, MAX_EVENTS, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span> (ready == <span class="number">-1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (errno == EINTR)</span><br><span class="line">                <span class="keyword">continue</span>;               <span class="comment">/* Restart if interrupted by signal */</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                errExit(<span class="string">"epoll_wait"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Ready: %d\n"</span>, ready);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* Deal with returned list of events */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; ready; j++) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"  fd=%d; events: %s%s%s\n"</span>, evlist[j].data.fd,</span><br><span class="line">                    (evlist[j].events &amp; EPOLLIN)  ? <span class="string">"EPOLLIN "</span>  : <span class="string">""</span>,</span><br><span class="line">                    (evlist[j].events &amp; EPOLLHUP) ? <span class="string">"EPOLLHUP "</span> : <span class="string">""</span>,</span><br><span class="line">                    (evlist[j].events &amp; EPOLLERR) ? <span class="string">"EPOLLERR "</span> : <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (evlist[j].events &amp; EPOLLIN) &#123;</span><br><span class="line">                s = read(evlist[j].data.fd, buf, MAX_BUF);</span><br><span class="line">                <span class="keyword">if</span> (s == <span class="number">-1</span>)</span><br><span class="line">                    errExit(<span class="string">"read"</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"    read %d bytes: %.*s\n"</span>, s, s, buf);</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (evlist[j].events &amp; (EPOLLHUP | EPOLLERR)) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">/* After the epoll_wait(), EPOLLIN and EPOLLHUP may both have</span></span><br><span class="line"><span class="comment">                   been set. But we'll only get here, and thus close the file</span></span><br><span class="line"><span class="comment">                   descriptor, if EPOLLIN was not set. This ensures that all</span></span><br><span class="line"><span class="comment">                   outstanding input (possibly more than MAX_BUF bytes) is</span></span><br><span class="line"><span class="comment">                   consumed (by further loop iterations) before the file</span></span><br><span class="line"><span class="comment">                   descriptor is closed. */</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"    closing fd %d\n"</span>, evlist[j].data.fd);</span><br><span class="line">                <span class="comment">// å…³é—­ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¼šè‡ªåŠ¨çš„å°†å…¶ä»æ‰€æœ‰çš„ epoll å®ä¾‹çš„å…´è¶£åˆ—è¡¨ä¸­ç§»é™¤</span></span><br><span class="line">                <span class="keyword">if</span> (close(evlist[j].data.fd) == <span class="number">-1</span>)</span><br><span class="line">                    errExit(<span class="string">"close"</span>);</span><br><span class="line">                numOpenFds--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"All file descriptors closed; bye\n"</span>);</span><br><span class="line">    <span class="built_in">exit</span>(EXIT_SUCCESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘"><a href="#æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘" class="headerlink" title="æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘"></a>æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘</h1><p>åœ¨æ·±å…¥è®¨è®ºå¤šç§å¯é€‰çš„æœºåˆ¶ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåŒºåˆ†ä¸¤ç§æ–‡ä»¶æè¿°ç¬¦å‡†å¤‡å°±ç»ªçš„é€šçŸ¥æ¨¡å¼ã€‚</p>
<ul>
<li><strong>æ°´å¹³è§¦å‘</strong>é€šçŸ¥(epollé»˜è®¤çš„é€šçŸ¥æ–¹å¼)ï¼šå¦‚æœæ–‡ä»¶æè¿°ç¬¦ä¸Šå¯ä»¥éé˜»å¡åœ°æ‰§è¡ŒI/Oç³»ç»Ÿè°ƒç”¨ï¼Œæ­¤æ—¶è®¤ä¸ºå®ƒå·²ç»<br>å°±ç»ªã€‚</li>
<li><strong>è¾¹ç¼˜è§¦å‘</strong>é€šçŸ¥ï¼šå¦‚æœæ–‡ä»¶æè¿°ç¬¦è‡ªä¸Šæ¬¡çŠ¶æ€æ£€æŸ¥ä»¥æ¥æœ‰äº†æ–°çš„I/Oæ´»åŠ¨ï¼ˆæ¯”å¦‚æ–°çš„è¾“<br>å…¥ï¼‰ï¼Œæ­¤æ—¶éœ€è¦è§¦å‘é€šçŸ¥ã€‚</li>
</ul>
<p>ä¸‹å›¾æ€»ç»“äº†I/Oå¤šè·¯å¤ç”¨ã€ä¿¡å·é©±åŠ¨I/Oä»¥åŠepollæ‰€é‡‡ç”¨çš„é€šçŸ¥æ¨¡å‹ã€‚epoll APIåŒå…¶<br>ä»–ä¸¤ç§I/Oæ¨¡å‹çš„åŒºåˆ«åœ¨äºå®ƒå¯¹æ°´å¹³è§¦å‘ï¼ˆé»˜è®¤ï¼‰å’Œè¾¹ç¼˜è§¦å‘éƒ½æ”¯æŒã€‚</p>
<img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="/epollæ‰¼è¦æ€»ç»“/epoll1.png" title="epoll">
<h2 id="æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘çš„åŒºåˆ«"><a href="#æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘çš„åŒºåˆ«" class="headerlink" title="æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘çš„åŒºåˆ«"></a>æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘çš„åŒºåˆ«</h2><p><strong>é»˜è®¤æƒ…å†µä¸‹ epoll æä¾›çš„æ˜¯æ°´å¹³è§¦å‘é€šçŸ¥</strong>.è¦ä½¿ç”¨è¾¹ç¼˜è§¦å‘é€šçŸ¥ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨epoll_ctl()æ—¶åœ¨evï¼eventså­—æ®µä¸­æŒ‡å®šEPOLLETæ ‡å¿—.</p>
<p>ä¾‹å¦‚ : </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">epoll_event</span> <span class="title">ev</span>;</span></span><br><span class="line">ev.data.fd = fd;</span><br><span class="line">ev.events = EPOLLIN | EPOLLET;</span><br><span class="line"><span class="keyword">if</span> (epoll_ctl(epfd, EPOLL_CTL_ADD, fd, ev) == <span class="number">-1</span>)</span><br><span class="line">    errExit(<span class="string">"epoll_ctl"</span>);</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜epollçš„æ°´å¹³è§¦å‘å’Œè¾¹ç¼˜è§¦å‘é€šçŸ¥ä¹‹é—´çš„åŒºåˆ«ã€‚<br>å‡è®¾æˆ‘ä»¬ä½¿ç”¨epollæ¥ç›‘è§†ä¸€ä¸ªå¥—æ¥å­—ä¸Šçš„è¾“å…¥ï¼ˆEPOLLINï¼‰ï¼Œæ¥ä¸‹æ¥ä¼šå‘ç”Ÿå¦‚ä¸‹çš„äº‹ä»¶ã€‚</p>
<p>1ï¼å¥—æ¥å­—ä¸Šæœ‰è¾“å…¥åˆ°æ¥ã€‚<br>2ï¼æˆ‘ä»¬è°ƒç”¨ä¸€æ¬¡epoll_wait()ã€‚æ— è®ºæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯æ°´å¹³è§¦å‘è¿˜æ˜¯è¾¹ç¼˜è§¦å‘é€šçŸ¥ï¼Œè¯¥è°ƒç”¨<br>éƒ½ä¼šå‘Šè¯‰æˆ‘ä»¬å¥—æ¥å­—å·²ç»å¤„äºå°±ç»ªæ€äº†ã€‚<br>3ï¼å†æ¬¡è°ƒç”¨epoll_wait()ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯æ°´å¹³è§¦å‘é€šçŸ¥ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªepoll_wait()è°ƒç”¨å°†å‘Šè¯‰æˆ‘ä»¬å¥—æ¥å­—å¤„äºå°±<br>ç»ªæ€ã€‚è€Œå¦‚æœæˆ‘ä»¬é‡‡ç”¨è¾¹ç¼˜è§¦å‘é€šçŸ¥ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªepoll_wait()è°ƒç”¨å°†é˜»å¡ï¼Œå› ä¸ºè‡ªä»ä¸Šä¸€æ¬¡<br>è°ƒç”¨epoll_wait()ä»¥æ¥å¹¶æ²¡æœ‰æ–°çš„è¾“å…¥åˆ°æ¥ã€‚</p>
<p>è¾¹ç¼˜è§¦å‘é€šçŸ¥é€šå¸¸å’Œéé˜»å¡çš„æ–‡ä»¶æè¿°ç¬¦ç»“åˆä½¿ç”¨ã€‚å› è€Œï¼Œé‡‡ç”¨epollçš„è¾¹ç¼˜è§¦å‘é€šçŸ¥æœºåˆ¶çš„ç¨‹åºåŸºæœ¬æ¡†æ¶å¦‚ä¸‹:</p>
<p>1ï¼è®©æ‰€æœ‰å¾…ç›‘è§†çš„æ–‡ä»¶æè¿°ç¬¦éƒ½æˆä¸ºéé˜»å¡çš„ã€‚<br>2ï¼é€šè¿‡epoll_ctl()æ„å»ºepollçš„å…´è¶£åˆ—è¡¨ã€‚<br>3ï¼é€šè¿‡å¦‚ä¸‹çš„å¾ªç¯å¤„ç†I/Oäº‹ä»¶ :<br>(a)é€šè¿‡epoll_wait()å–å¾—å¤„äºå°±ç»ªæ€çš„æè¿°ç¬¦åˆ—è¡¨ã€‚<br>(b)é’ˆå¯¹æ¯ä¸€ä¸ªå¤„äºå°±ç»ªæ€çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä¸æ–­è¿›è¡ŒI/Oå¤„ç†ç›´åˆ°ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨( ä¾‹å¦‚read()ã€write()ï¼Œrecv()ã€send()æˆ–accept() )è¿”å›EAGAINæˆ–EWOULDBLOCKé”™è¯¯ã€‚</p>
<h3 id="æ°´å¹³è§¦å‘éœ€è¦å¤„ç†çš„é—®é¢˜"><a href="#æ°´å¹³è§¦å‘éœ€è¦å¤„ç†çš„é—®é¢˜" class="headerlink" title="æ°´å¹³è§¦å‘éœ€è¦å¤„ç†çš„é—®é¢˜"></a>æ°´å¹³è§¦å‘éœ€è¦å¤„ç†çš„é—®é¢˜</h3><p>ä½¿ç”¨linux epollæ¨¡å‹ï¼Œæ°´å¹³è§¦å‘æ¨¡å¼ï¼ˆLevel-Triggeredï¼‰ï¼›å½“socketå¯å†™æ—¶ï¼Œä¼šä¸åœçš„è§¦å‘socketå¯å†™çš„äº‹ä»¶ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ</p>
<ul>
<li><p>ç¬¬ä¸€ç§æœ€æ™®é€šçš„æ–¹å¼ï¼š  </p>
<p>  å½“éœ€è¦å‘socketå†™æ•°æ®æ—¶ï¼Œå°†è¯¥socketåŠ å…¥åˆ°epollæ¨¡å‹ï¼ˆepoll_ctlï¼‰ï¼›ç­‰å¾…å¯å†™äº‹ä»¶ã€‚<br>  æ¥æ”¶åˆ°socketå¯å†™äº‹ä»¶åï¼Œè°ƒç”¨write()æˆ–send()å‘é€æ•°æ®ã€‚ã€‚ã€‚<br>  å½“æ•°æ®å…¨éƒ¨å†™å®Œåï¼Œ å°†socketæè¿°ç¬¦ç§»å‡ºepollæ¨¡å‹ã€‚</p>
<p>  è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯ï¼š  å³ä½¿å‘é€å¾ˆå°‘çš„æ•°æ®ï¼Œä¹Ÿè¦å°†socketåŠ å…¥ã€ç§»å‡ºepollæ¨¡å‹ã€‚æœ‰ä¸€å®šçš„æ“ä½œä»£ä»·ã€‚</p>
</li>
<li><p>ç¬¬äºŒç§æ–¹å¼ï¼Œï¼ˆæ˜¯æœ¬äººçš„æ”¹è¿›æ–¹æ¡ˆï¼Œ å«åšdirectly-writeï¼‰</p>
<p>  å‘socketå†™æ•°æ®æ—¶ï¼Œä¸å°†socketåŠ å…¥åˆ°epollæ¨¡å‹ï¼›è€Œæ˜¯ç›´æ¥è°ƒç”¨send()å‘é€ï¼›<br>  åªæœ‰å½“æˆ–send()è¿”å›é”™è¯¯ç EAGAINï¼ˆç³»ç»Ÿç¼“å­˜æ»¡ï¼‰ï¼Œæ‰å°†socketåŠ å…¥åˆ°epollæ¨¡å‹ï¼Œç­‰å¾…å¯å†™äº‹ä»¶å(è¡¨æ˜ç³»ç»Ÿç¼“å†²åŒºæœ‰ç©ºé—´å¯ä»¥å†™äº†)ï¼Œå†å‘é€æ•°æ®ã€‚<br>  å…¨éƒ¨æ•°æ®å‘é€å®Œæ¯•ï¼Œå†ç§»å‡ºepollæ¨¡å‹ã€‚</p>
<p>  è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼š   å½“ç”¨æˆ·æ•°æ®æ¯”è¾ƒå°‘æ—¶ï¼Œä¸éœ€è¦epoolçš„äº‹ä»¶å¤„ç†ã€‚<br>  åœ¨é«˜å‹åŠ›çš„æƒ…å†µä¸‹ï¼Œæ€§èƒ½æ€ä¹ˆæ ·å‘¢ï¼Ÿ<br>  å¯¹ä¸€æ¬¡æ€§ç›´æ¥å†™æˆåŠŸã€å¤±è´¥çš„æ¬¡æ•°è¿›è¡Œç»Ÿè®¡ã€‚å¦‚æœæˆåŠŸæ¬¡æ•°è¿œå¤§äºå¤±è´¥çš„æ¬¡æ•°ï¼Œ è¯´æ˜æ€§èƒ½è‰¯å¥½ã€‚ï¼ˆå¦‚æœå¤±è´¥æ¬¡æ•°è¿œå¤§äºæˆåŠŸçš„æ¬¡æ•°ï¼Œåˆ™å…³é—­è¿™ç§ç›´æ¥å†™çš„æ“ä½œï¼Œæ”¹ç”¨ç¬¬ä¸€ç§æ–¹æ¡ˆã€‚åŒæ—¶åœ¨æ—¥å¿—é‡Œè®°å½•è­¦å‘Šï¼‰<br>  åœ¨æˆ‘è‡ªå·±çš„åº”ç”¨ç³»ç»Ÿä¸­ï¼Œå®éªŒç»“æœæ•°æ®è¯æ˜è¯¥æ–¹æ¡ˆçš„æ€§èƒ½è‰¯å¥½ã€‚</p>
<p>  äº‹å®ä¸Šï¼Œç½‘ç»œæ•°æ®å¯åˆ†ä¸ºä¸¤ç§åˆ°è¾¾/å‘é€æƒ…å†µï¼š<br>  ä¸€æ˜¯åˆ†æ•£çš„æ•°æ®åŒ…ï¼Œ ä¾‹å¦‚æ¯é—´éš”40mså·¦å³ï¼Œå‘é€/æ¥æ”¶3-5ä¸ª MTUï¼ˆæˆ–æ›´å°ï¼Œè¿™æ ·å°±æ²¡è¶…è¿‡é»˜è®¤çš„8Kç³»ç»Ÿç¼“å­˜ï¼‰ã€‚<br>  äºŒæ˜¯è¿ç»­çš„æ•°æ®åŒ…ï¼Œ ä¾‹å¦‚æ¯é—´éš”1så·¦å³ï¼Œè¿ç»­å‘é€/æ¥æ”¶ 20ä¸ª MTUï¼ˆæˆ–æ›´å¤šï¼‰ã€‚</p>
</li>
</ul>
<ul>
<li><p>ç¬¬ä¸‰ç§æ–¹å¼ï¼š  ä½¿ç”¨Edge-Triggeredï¼ˆè¾¹æ²¿è§¦å‘ï¼‰ï¼Œè¿™æ ·socketæœ‰å¯å†™äº‹ä»¶ï¼Œåªä¼šè§¦å‘ä¸€æ¬¡ã€‚</p>
<p>  å¯ä»¥åœ¨åº”ç”¨å±‚åšå¥½æ ‡è®°ã€‚ä»¥é¿å…é¢‘ç¹çš„è°ƒç”¨ epoll_ctl( EPOLL_CTL_ADD, EPOLL_CTL_MOD)ã€‚  è¿™ç§æ–¹å¼æ˜¯epoll çš„ man æ‰‹å†Œé‡Œæ¨èçš„æ–¹å¼ï¼Œ æ€§èƒ½æœ€é«˜ã€‚ä½†å¦‚æœå¤„ç†ä¸å½“å®¹æ˜“å‡ºé”™ï¼Œäº‹ä»¶é©±åŠ¨åœæ­¢ã€‚</p>
</li>
</ul>
<h1 id="epollä¸select-pollçš„åŒºåˆ«"><a href="#epollä¸select-pollçš„åŒºåˆ«" class="headerlink" title="epollä¸select/pollçš„åŒºåˆ«"></a>epollä¸select/pollçš„åŒºåˆ«</h1><p>selectå‡½æ•°ï¼Œå¿…é¡»å¾—æ¸…æ¥šselectè·Ÿlinuxç‰¹æœ‰çš„epollçš„åŒºåˆ«ï¼Œ æœ‰ä¸‰ç‚¹(éå†…æ ‘)ï¼š</p>
<ul>
<li>éå† ï¼š æ¯æ¬¡è°ƒç”¨selectéƒ½éœ€è¦åœ¨å†…æ ¸éå†ä¼ é€’è¿›æ¥çš„æ‰€æœ‰fdï¼Œè¿™ä¸ªå¼€é”€åœ¨fdå¾ˆå¤šæ—¶ä¹Ÿå¾ˆå¤§ï¼›å½“æˆ‘ä»¬æ‰§è¡Œepoll_ctlæ—¶ï¼Œé™¤äº†æŠŠsocketæ”¾åˆ°epollæ–‡ä»¶ç³»ç»Ÿé‡Œfileå¯¹è±¡å¯¹åº”çš„çº¢é»‘æ ‘ä¸Šä¹‹å¤–ï¼Œè¿˜ä¼šç»™å†…æ ¸ä¸­æ–­å¤„ç†ç¨‹åºæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå‘Šè¯‰å†…æ ¸ï¼Œå¦‚æœè¿™ä¸ªå¥æŸ„çš„ä¸­æ–­åˆ°äº†ï¼Œå°±æŠŠå®ƒæ”¾åˆ°å‡†å¤‡å°±ç»ªlisté“¾è¡¨é‡Œã€‚æ‰€ä»¥ï¼Œå½“ä¸€ä¸ªsocketä¸Šæœ‰æ•°æ®åˆ°äº†ï¼Œå†…æ ¸åœ¨æŠŠç½‘å¡ä¸Šçš„æ•°æ®copyåˆ°å†…æ ¸ä¸­åå°±æ¥æŠŠsocketæ’å…¥åˆ°å‡†å¤‡å°±ç»ªé“¾è¡¨é‡Œäº†ã€‚epoll_waitçš„å·¥ä½œå®é™…ä¸Šå°±æ˜¯åœ¨è¿™ä¸ªå°±ç»ªé“¾è¡¨ä¸­æŸ¥çœ‹æœ‰æ²¡æœ‰å°±ç»ªçš„fd, æ¯æ¬¡åªéœ€è¦ç®€å•çš„ä»åˆ—è¡¨é‡Œå–å‡ºå°±è¡Œäº†</li>
<li>å†…å­˜æ‹·è´ ï¼š selectï¼Œpollæ¯æ¬¡è°ƒç”¨éƒ½è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€å¾€å†…æ ¸æ€æ‹·è´ä¸€æ¬¡; epollçš„è§£å†³æ–¹æ¡ˆåœ¨epoll_ctlå‡½æ•°ä¸­ã€‚æ¯æ¬¡æ³¨å†Œæ–°çš„äº‹ä»¶åˆ°epollå¥æŸ„ä¸­æ—¶ï¼ˆåœ¨epoll_ctlä¸­æŒ‡å®šEPOLL_CTL_ADDï¼‰ï¼Œä¼šæŠŠæ‰€æœ‰çš„fdæ‹·è´è¿›å†…æ ¸ï¼Œè€Œä¸æ˜¯åœ¨epoll_waitçš„æ—¶å€™é‡å¤æ‹·è´ã€‚epollä¿è¯äº†æ¯ä¸ªfdåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­åªä¼šæ‹·è´ä¸€æ¬¡</li>
<li>æ•°é‡é™åˆ¶ ï¼š selecté»˜è®¤åªæ”¯æŒ1024ä¸ªï¼›epollå¹¶æ²¡æœ‰æœ€å¤§æ•°ç›®é™åˆ¶</li>
</ul>
<p>æ€»ç»“ï¼š</p>
<p>ï¼ˆ1ï¼‰selectï¼Œpollå®ç°éœ€è¦è‡ªå·±ä¸æ–­è½®è¯¢æ‰€æœ‰fdé›†åˆï¼Œç›´åˆ°è®¾å¤‡å°±ç»ªï¼ŒæœŸé—´å¯èƒ½è¦ç¡çœ å’Œå”¤é†’å¤šæ¬¡äº¤æ›¿ã€‚è€Œepollå…¶å®ä¹Ÿéœ€è¦è°ƒç”¨epoll_waitä¸æ–­è½®è¯¢å°±ç»ªé“¾è¡¨ï¼ŒæœŸé—´ä¹Ÿå¯èƒ½å¤šæ¬¡ç¡çœ å’Œå”¤é†’äº¤æ›¿ï¼Œä½†æ˜¯å®ƒæ˜¯è®¾å¤‡å°±ç»ªæ—¶ï¼Œè°ƒç”¨å›è°ƒå‡½æ•°ï¼ŒæŠŠå°±ç»ªfdæ”¾å…¥å°±ç»ªé“¾è¡¨ä¸­ï¼Œå¹¶å”¤é†’åœ¨epoll_waitä¸­è¿›å…¥ç¡çœ çš„è¿›ç¨‹ã€‚è™½ç„¶éƒ½è¦ç¡çœ å’Œäº¤æ›¿ï¼Œä½†æ˜¯selectå’Œpollåœ¨â€œé†’ç€â€çš„æ—¶å€™è¦éå†æ•´ä¸ªfdé›†åˆï¼Œè€Œepollåœ¨â€œé†’ç€â€çš„æ—¶å€™åªè¦åˆ¤æ–­ä¸€ä¸‹å°±ç»ªé“¾è¡¨æ˜¯å¦ä¸ºç©ºå°±è¡Œäº†ï¼Œè¿™èŠ‚çœäº†å¤§é‡çš„CPUæ—¶é—´ã€‚è¿™å°±æ˜¯å›è°ƒæœºåˆ¶å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚</p>
<p>ï¼ˆ2ï¼‰selectï¼Œpollæ¯æ¬¡è°ƒç”¨éƒ½è¦æŠŠfdé›†åˆä»ç”¨æˆ·æ€å¾€å†…æ ¸æ€æ‹·è´ä¸€æ¬¡ï¼Œå¹¶ä¸”è¦æŠŠcurrentå¾€è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ä¸­æŒ‚ä¸€æ¬¡ï¼Œè€Œepollåªè¦ä¸€æ¬¡æ‹·è´ï¼Œè€Œä¸”æŠŠcurrentå¾€ç­‰å¾…é˜Ÿåˆ—ä¸ŠæŒ‚ä¹ŸåªæŒ‚ä¸€æ¬¡ï¼ˆåœ¨epoll_waitçš„å¼€å§‹ï¼Œæ³¨æ„è¿™é‡Œçš„ç­‰å¾…é˜Ÿåˆ—å¹¶ä¸æ˜¯è®¾å¤‡ç­‰å¾…é˜Ÿåˆ—ï¼Œåªæ˜¯ä¸€ä¸ªepollå†…éƒ¨å®šä¹‰çš„ç­‰å¾…é˜Ÿåˆ—ï¼‰ã€‚è¿™ä¹Ÿèƒ½èŠ‚çœä¸å°‘çš„å¼€é”€ã€‚</p>
<h1 id="å¸¸è§çš„epollç¼–ç¨‹æ¨¡å‹"><a href="#å¸¸è§çš„epollç¼–ç¨‹æ¨¡å‹" class="headerlink" title="å¸¸è§çš„epollç¼–ç¨‹æ¨¡å‹"></a>å¸¸è§çš„epollç¼–ç¨‹æ¨¡å‹</h1><p>è§æœ¬åšå®¢çš„:</p>
<ul>
<li>å…³äºæœåŠ¡å™¨æ¨¡å‹æ€»ç»“è¯·è½¬ <a href="/server_model_summary/" title="æ­¤æ–‡">æ­¤æ–‡</a></li>
<li>å…³äºreactoræ¨¡å‹æ€»ç»“è¯·è½¬ <a href="/reactor_intro/" title="æ­¤æ–‡">æ­¤æ–‡</a></li>
</ul>

      


      

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
            
              <a href="/tags/noodle/" rel="tag"><i class="fa fa-tag"></i> noodle</a>
            
          </div>
        

        
        
        

        
          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/top500_english_life_sentences/" rel="next" title="Top 500 English sentences for daily life">
                  <i class="fa fa-chevron-left"></i> 
                  <p class="post-nav-pre-next-title">
                    Top 500 English sentences for daily life
                  </p> 
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/socketå¯è¯»å¯å†™æ¡ä»¶ä¸éé˜»å¡connectæˆ–acceptæµ…æ/" rel="prev" title="socketå¯è¯»å¯å†™æ¡ä»¶ä¸éé˜»å¡connectæˆ–acceptæµ…æ">
                <p class="post-nav-pre-next-title">
                    socketå¯è¯»å¯å†™æ¡ä»¶ä¸éé˜»å¡connectæˆ–acceptæµ…æ
                </p> 
                <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        

        
        
      </footer>
      
    </div>
    
    
    

    

    

    

  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  

  <aside id="sidebar" class="sidebar">

    
      
        <div id="sidebar-dimmer"></div>
      
    

    <div class="sidebar-inner">
    
      <div class="sidebar-toggle-inside motion-element">
        <div class="sidebar-toggle-line-wrap">
          <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
          <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
          <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
        </div>
      </div>

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <a href="/" class="site-author-image" rel="start" style="border:none">
            <img class="site-author-image" itemprop="image" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA4MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0zNSAyNUg0NVYzNUgzNVYyNVoiIGZpbGw9IiNEREREREQiLz4KPC9zdmc+" data-src="/uploads/avatar.png" alt="Mike">
          </a>
          <p class="site-author-name" itemprop="name">Mike</p>
           
              <p class="site-description motion-element" itemprop="description">ğŸš™ ğŸš— ğŸ’¨ ğŸ’¨ If you want to create a blog like this, just follow my open-source project, "hexo-theme-neo", click the GitHub button below and check it out ^_^ . It is recommended to use Chrome, Safari, or Edge to read this blog since this blog was developed on Edge (Chromium kernel version) and tested on Safari.</p>
          
        </div>

        <nav class="site-state motion-element">

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">298</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">111</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

          <div class="site-state-item site-state-about">
            <a href="/about/">
              <span class="site-state-item-about fa fa-fw fa-user"></span>
              <span class="site-state-item-name">about</span>
            </a>
          </div>
          
        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/no5ix" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://open.spotify.com/user/313duq77ekebrfyak3xijqewzss4?si=e7653b829a9747bf" target="_blank" title="Spotify">
                  
                    <i class="fa fa-fw fa-spotify"></i>
                  
                    
                      Spotify
                    
                </a>
              </span>
            
          
          
          <!-- ç½‘æ˜“äº‘éŸ³ä¹ -->
            <!-- <div class="netease-cloud-music"> -->
              <!-- <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=280 height=110 src="//music.163.com/outchain/player?type=0&id=992743594&auto=0&height=90"></iframe> -->
            <!-- </div> -->
          <!-- ç½‘æ˜“äº‘éŸ³ä¹ -->

        </div>

        
        

        
        

        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#epoll-ç¼–ç¨‹æ¥å£"><span class="nav-text">epoll ç¼–ç¨‹æ¥å£</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#epollæ¦‚è¦"><span class="nav-text">epollæ¦‚è¦</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#epoll-create"><span class="nav-text">epoll_create</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#epoll-ctl"><span class="nav-text">epoll_ctl</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä½¿ç”¨-epoll-create-å’Œ-epoll-ctl-çš„ä¾‹å­"><span class="nav-text">ä½¿ç”¨ epoll_create() å’Œ epoll_ctl()çš„ä¾‹å­</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#epoll-wait"><span class="nav-text">epoll_wait</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TLPIä¹¦ä¸Šçš„ä¾‹å­"><span class="nav-text">TLPIä¹¦ä¸Šçš„ä¾‹å­</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘"><span class="nav-text">æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘çš„åŒºåˆ«"><span class="nav-text">æ°´å¹³è§¦å‘ä¸è¾¹ç¼˜è§¦å‘çš„åŒºåˆ«</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ°´å¹³è§¦å‘éœ€è¦å¤„ç†çš„é—®é¢˜"><span class="nav-text">æ°´å¹³è§¦å‘éœ€è¦å¤„ç†çš„é—®é¢˜</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#epollä¸select-pollçš„åŒºåˆ«"><span class="nav-text">epollä¸select/pollçš„åŒºåˆ«</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å¸¸è§çš„epollç¼–ç¨‹æ¨¡å‹"><span class="nav-text">å¸¸è§çš„epollç¼–ç¨‹æ¨¡å‹</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy;  2013 - 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mike</span>
</div>



        

        
      </div>
    </footer>

    <!--
    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      
        <span id="scrollpercent"><span>0</span>%</span>
      
    </div>
    -->

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>










  















  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/mediumzoom/medium-zoom.js?v=1.1.0"></script>





  




  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>


  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

    <script src="/js/src/local-search.js"></script>





  

  

  

  

  

  


  <script type="text/javascript" src="/lib/wobble_window/wobblewindow.js"> </script>
<script type="text/javascript" src="/js/src/custom.js"></script>
</body>
</html>






<script type="text/javascript" src="/js/src/headroom.js"></script>

<!-- ä»£ç å—å¤åˆ¶åŠŸèƒ½ -->
<script type="text/javascript" src="/js/src/code-highlight-modification.js"></script>

<!-- Flashcards Script -->
<script type="text/javascript" src="/js/src/flashcards.js"></script>
